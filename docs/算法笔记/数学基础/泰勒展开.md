# 泰勒展开（Taylor Expansion）

## 常用函数的麦克劳林展开式及其证明

以下给出常见函数的麦克劳林展开式（佩亚诺余项形式），并给出证明思路。假设 $x \to 0$。

$$
e^x = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \cdots + \frac{x^n}{n!} + o(x^n).
$$
$$
\sin x = x - \frac{x^3}{3!} + \frac{x^5}{5!} - \cdots + (-1)^{m-1} \frac{x^{2m-1}}{(2m-1)!} + o(x^{2m}).
$$
$$
\cos x = 1 - \frac{x^2}{2!} + \frac{x^4}{4!} - \cdots + (-1)^m \frac{x^{2m}}{(2m)!} + o(x^{2m+1}).
$$
$$
\ln(1+x) = x - \frac{x^2}{2} + \frac{x^3}{3} - \cdots + (-1)^{n-1} \frac{x^n}{n} + o(x^n), \quad x > -1.
$$
$$
(1+x)^\alpha = 1 + \alpha x + \frac{\alpha(\alpha-1)}{2!}x^2 + \cdots + \frac{\alpha(\alpha-1)\cdots(\alpha-n+1)}{n!}x^n + o(x^n).
$$
$$
\frac{1}{1-x} = 1 + x + x^2 + \cdots + x^n + o(x^n), \quad |x| < 1.
$$
$$
\arctan x = x - \frac{x^3}{3} + \frac{x^5}{5} - \cdots + (-1)^{n-1} \frac{x^{2n-1}}{2n-1} + o(x^{2n}), \quad |x| \le 1.
$$
$$
\tan x = x + \frac{x^3}{3} + \frac{2x^5}{15} + \frac{17x^7}{315} + \cdots + o(x^{2n+1}).
$$
$$
\arcsin x = x + \frac{1}{6}x^3 + \frac{3}{40}x^5 + \frac{5}{112}x^7 + \cdots + o(x^{2n+1}).
$$
$$
\ln(1-x) = -x - \frac{x^2}{2} - \frac{x^3}{3} - \cdots - \frac{x^n}{n} + o(x^n), \quad |x| < 1.
$$

$$
a^x = e^{x \ln a} = 1 + x \ln a + \frac{(x \ln a)^2}{2!} + \cdots + \frac{(x \ln a)^n}{n!} + o(x^n).
$$

## 一般式

---

**带佩亚诺余项（Peano remainder）的泰勒公式**

若函数 $f(x)$ 在点 $x_0$ 处具有 $n$ 阶导数，则存在 $x_0$ 的一个邻域，对于该邻域内的任意 $x$，有
$$
f(x) = f(x_0) + \frac{f'(x_0)}{1!}(x - x_0) + \frac{f''(x_0)}{2!}(x - x_0)^2 + \cdots + \frac{f^{(n)}(x_0)}{n!}(x - x_0)^n + R_n(x),
$$
其中余项 $R_n(x) = o((x - x_0)^n)$，即当 $x \to x_0$ 时，$R_n(x)$ 是 $(x - x_0)^n$ 的高阶无穷小。

---

**带拉格朗日余项**（Lagrange remainder）的泰勒公式

若函数 $f(x)$ 在包含 $x_0$ 的某个开区间 $(a, b)$ 内具有 $n+1$ 阶导数，则对任意 $x \in (a, b)$，有
$$
f(x) = f(x_0) + \frac{f'(x_0)}{1!}(x - x_0) + \frac{f''(x_0)}{2!}(x - x_0)^2 + \cdots + \frac{f^{(n)}(x_0)}{n!}(x - x_0)^n + R_n(x),
$$
其中余项 $R_n(x) = \frac{f^{(n+1)}(\xi)}{(n+1)!}(x - x_0)^{n+1}$，这里 $\xi$ 是介于 $x_0$ 与 $x$ 之间的某个值。

---

**麦克劳林公式**（Maclaurin formula）

当 $x_0 = 0$ 时，泰勒公式称为麦克劳林公式：

- 佩亚诺余项形式：
  $$
  f(x) = f(0) + \frac{f'(0)}{1!}x + \frac{f''(0)}{2!}x^2 + \cdots + \frac{f^{(n)}(0)}{n!}x^n + o(x^n).
  $$

- 拉格朗日余项形式：
  $$
  f(x) = f(0) + \frac{f'(0)}{1!}x + \frac{f''(0)}{2!}x^2 + \cdots + \frac{f^{(n)}(0)}{n!}x^n + \frac{f^{(n+1)}(\theta x)}{(n+1)!}x^{n+1}, \quad 0 < \theta < 1.
  $$

## 泰勒公式的证明

---

**带拉格朗日余项的泰勒公式证明**

**思路**：利用柯西中值定理。

令
$$
F(t) = f(x) - \left[ f(t) + f'(t)(x-t) + \frac{f''(t)}{2!}(x-t)^2 + \cdots + \frac{f^{(n)}(t)}{n!}(x-t)^n \right],
$$

$$
G(t) = (x-t)^{n+1}.
$$

易见 $F(x)=0$，$G(x)=0$。在区间 $[x_0, x]$（或 $[x, x_0]$）上应用柯西中值定理：
$$
\frac{F(x) - F(x_0)}{G(x) - G(x_0)} = \frac{F'(\xi)}{G'(\xi)}, \quad \xi \in (x_0, x).
$$

计算得
$$
F'(t) = -\left[ f'(t) + \left( f''(t)(x-t) - f'(t) \right) + \left( \frac{f'''(t)}{2!}(x-t)^2 - \frac{f''(t)}{1!}(x-t) \right) + \cdots + \left( \frac{f^{(n+1)}(t)}{n!}(x-t)^n - \frac{f^{(n)}(t)}{(n-1)!}(x-t)^{n-1} \right) \right].
$$

观察可知，除了最后一项外，其他项相互抵消，因此
$$
F'(t) = -\frac{f^{(n+1)}(t)}{n!}(x-t)^n.
$$

而 $G'(t) = -(n+1)(x-t)^n$。代入得
$$
\frac{F(x_0)}{G(x_0)} = \frac{F'(\xi)}{G'(\xi)} = \frac{-\frac{f^{(n+1)}(\xi)}{n!}(x-\xi)^n}{-(n+1)(x-\xi)^n} = \frac{f^{(n+1)}(\xi)}{(n+1)!}.
$$

因此，
$$
F(x_0) = \frac{f^{(n+1)}(\xi)}{(n+1)!} G(x_0) = \frac{f^{(n+1)}(\xi)}{(n+1)!} (x - x_0)^{n+1}.
$$

由 $F(x_0)$ 的定义即得
$$
f(x) = \sum_{k=0}^{n} \frac{f^{(k)}(x_0)}{k!}(x - x_0)^k + \frac{f^{(n+1)}(\xi)}{(n+1)!}(x - x_0)^{n+1}.
$$

---

**带佩亚诺余项的泰勒公式证明**

**思路**：利用洛必达法则。

要证 $R_n(x) = f(x) - \sum_{k=0}^{n} \frac{f^{(k)}(x_0)}{k!}(x - x_0)^k = o((x-x_0)^n)$，即证
$$
\lim_{x \to x_0} \frac{R_n(x)}{(x-x_0)^n} = 0.
$$

由于 $f$ 在 $x_0$ 处有 $n$ 阶导数，可知 $R_n(x)$ 在 $x_0$ 处至少 $n$ 阶可导，且容易验证 $R_n(x_0)=R_n'(x_0)=\cdots=R_n^{(n)}(x_0)=0$。连续使用 $n-1$ 次洛必达法则，有
$$
\lim_{x \to x_0} \frac{R_n(x)}{(x-x_0)^n} = \lim_{x \to x_0} \frac{R_n'(x)}{n(x-x_0)^{n-1}} = \cdots = \lim_{x \to x_0} \frac{R_n^{(n-1)}(x)}{n!(x-x_0)}.
$$

由导数定义，
$$
\lim_{x \to x_0} \frac{R_n^{(n-1)}(x)}{n!(x-x_0)} = \frac{1}{n!} \lim_{x \to x_0} \frac{R_n^{(n-1)}(x) - R_n^{(n-1)}(x_0)}{x - x_0} = \frac{1}{n!} R_n^{(n)}(x_0) = 0.
$$

因此，$R_n(x) = o((x-x_0)^n)$。