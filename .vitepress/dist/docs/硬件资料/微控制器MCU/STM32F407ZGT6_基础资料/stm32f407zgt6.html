<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>stm32f407zgt6 | 小黄同学的在线笔记</title>
    <meta name="description" content="FOR IDEA">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/XIAOHUANG_BLOG/assets/style.BoM17vs2.css" as="style">
    <link rel="preload stylesheet" href="/XIAOHUANG_BLOG/vp-icons.css" as="style">
    
    <script type="module" src="/XIAOHUANG_BLOG/assets/app.fAfeyAzL.js"></script>
    <link rel="preload" href="/XIAOHUANG_BLOG/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/XIAOHUANG_BLOG/assets/chunks/theme.DjzOfxOR.js">
    <link rel="modulepreload" href="/XIAOHUANG_BLOG/assets/chunks/framework.PZCYvDoh.js">
    <link rel="modulepreload" href="/XIAOHUANG_BLOG/assets/docs_硬件资料_微控制器MCU_STM32F407ZGT6_基础资料_stm32f407zgt6.md.CZIz3rhy.lean.js">
    <link rel="icon" href="/XIAOHUANG_BLOG/icons/网站/笔记本.svg">
    <style>
      /* 标题自动编号 */
      .vp-doc h2 {
        counter-increment: h2;
        counter-reset: h3;
      }
      
      .vp-doc h2:before {
        content: counter(h2) ". ";
        font-weight: bold;
      }
      
      .vp-doc h3 {
        counter-increment: h3;
        counter-reset: h4;
      }
      
      .vp-doc h3:before {
        content: counter(h2) "." counter(h3) ". ";
        font-weight: bold;
      }
      
      .vp-doc h4 {
        counter-increment: h4;
       
        counter-reset: h5;
      }
      
      .vp-doc h4:before {
        content: counter(h2) "." counter(h3) "." counter(h4) ". ";
        font-weight: bold;
      }
      
      .vp-doc h5 {
        counter-increment: h5;
        counter-reset: h6;
      }
      
      .vp-doc h5:before {
        content: counter(h2) "." counter(h3) "." counter(h4) "." counter(h5) ". ";
        font-weight: bold;
      }
      
      .vp-doc h6 {
        counter-increment: h6;
      }
      
      .vp-doc h6:before {
        content: counter(h2) "." counter(h3) "." counter(h4) "." counter(h5) "." counter(h6) ". ";
        font-weight: bold;
      }
      
      /* 重置一级标题的计数器 */
      .vp-doc {
        counter-reset: h2;
      }
    </style>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"dark",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-d8b57b2d><!--[--><!--]--><!--[--><span tabindex="-1" data-v-fcbfc0e0></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-fcbfc0e0>Skip to content</a><!--]--><!----><header class="VPNav" data-v-d8b57b2d data-v-7ad780c2><div class="VPNavBar" data-v-7ad780c2 data-v-9fd4d1dd><div class="wrapper" data-v-9fd4d1dd><div class="container" data-v-9fd4d1dd><div class="title" data-v-9fd4d1dd><div class="VPNavBarTitle" data-v-9fd4d1dd data-v-9f43907a><a class="title" href="/XIAOHUANG_BLOG/" data-v-9f43907a><!--[--><!--]--><!--[--><img class="VPImage logo" src="/XIAOHUANG_BLOG/icons/网站/笔记本.png" alt data-v-ab19afbb><!--]--><span data-v-9f43907a>小黄同学的在线笔记</span><!--[--><!--]--></a></div></div><div class="content" data-v-9fd4d1dd><div class="content-body" data-v-9fd4d1dd><!--[--><!--]--><div class="VPNavBarSearch search" data-v-9fd4d1dd><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索文档"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">搜索文档</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-9fd4d1dd data-v-afb2845e><span id="main-nav-aria-label" class="visually-hidden" data-v-afb2845e> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/XIAOHUANG_BLOG/" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>首页</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/XIAOHUANG_BLOG/xiaohuang_mdwork/%E5%89%8D%E7%AB%AF%E5%AF%BC%E8%88%AA/%E5%89%8D%E7%AB%AF%E5%AF%BC%E8%88%AA%E7%9B%AE%E5%BD%95.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>前端导航</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-afb2845e data-v-bfe7971f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-bfe7971f><span class="text" data-v-bfe7971f><!----><span data-v-bfe7971f>功能网站</span><span class="vpi-chevron-down text-icon" data-v-bfe7971f></span></span></button><div class="menu" data-v-bfe7971f><div class="VPMenu" data-v-bfe7971f data-v-20ed86d6><div class="items" data-v-20ed86d6><!--[--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-7eeeb2dc><a class="VPLink link vp-external-link-icon" href="https://cdkm.com/cn/svg-to-ico" target="_blank" rel="noreferrer" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>svg转icon</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-7eeeb2dc><a class="VPLink link vp-external-link-icon" href="https://www.iconfont.cn/" target="_blank" rel="noreferrer" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>阿里icon库</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-7eeeb2dc><a class="VPLink link vp-external-link-icon" href="https://www.deepseek.com/" target="_blank" rel="noreferrer" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Deepseek</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-7eeeb2dc><a class="VPLink link vp-external-link-icon" href="https://www.tongyi.com/" target="_blank" rel="noreferrer" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>通义千问</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-7eeeb2dc><a class="VPLink link vp-external-link-icon" href="https://pixabay.com/zh/" target="_blank" rel="noreferrer" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>高保真图</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-7eeeb2dc><a class="VPLink link vp-external-link-icon" href="https://docs.bugdesigner.cn/README.html#%E9%83%A8%E7%BD%B2%E6%AD%A5%E9%AA%A4" target="_blank" rel="noreferrer" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>建站速通</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-afb2845e data-v-bfe7971f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-bfe7971f><span class="text" data-v-bfe7971f><!----><span data-v-bfe7971f>快速软件</span><span class="vpi-chevron-down text-icon" data-v-bfe7971f></span></span></button><div class="menu" data-v-bfe7971f><div class="VPMenu" data-v-bfe7971f data-v-20ed86d6><div class="items" data-v-20ed86d6><!--[--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-7eeeb2dc><a class="VPLink link" href="/XIAOHUANG_BLOG/xiaohuang_mdwork/%E5%BF%AB%E9%80%9F%E8%BD%AF%E4%BB%B6/md%E6%96%87%E6%A1%A3%E6%8F%90%E5%8F%96%E5%B7%A5%E5%85%B7/Markdown%E6%96%87%E6%9C%AC%E8%87%AA%E5%8A%A8%E6%8F%90%E5%8F%96%E8%BD%AF%E4%BB%B6.html" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Markdown快速导出工具</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-afb2845e data-v-bfe7971f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-bfe7971f><span class="text" data-v-bfe7971f><!----><span data-v-bfe7971f>语法笔记</span><span class="vpi-chevron-down text-icon" data-v-bfe7971f></span></span></button><div class="menu" data-v-bfe7971f><div class="VPMenu" data-v-bfe7971f data-v-20ed86d6><div class="items" data-v-20ed86d6><!--[--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-7eeeb2dc><a class="VPLink link" href="/XIAOHUANG_BLOG/xiaohuang_mdwork/%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/Python%E4%BB%A3%E7%A0%81%E8%AF%AD%E6%B3%95.html" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Python</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/XIAOHUANG_BLOG/xiaohuang_mdwork/%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0%E4%B8%BB%E9%A1%B5%E7%9B%AE%E5%BD%95.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>算法笔记</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-9fd4d1dd data-v-3f90c1a5><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="true" data-v-3f90c1a5 data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-9fd4d1dd data-v-ef6192dc data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="mailto:2727678986@qq.com" aria-label="发送邮件" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg></a><a class="VPSocialLink no-icon" href="https://github.com/xiaohuangstudent" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://space.bilibili.com/3493126956124793?spm_id_from=333.788.0.0" aria-label target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><svg t="1751117659737" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1503" width="64" height="64"><path d="M729.32864 373.94944c-9.79456-5.94432-19.06176-6.784-19.14368-6.784l-1.06496-0.0512c-57.20064-3.8656-121.1648-5.83168-190.12608-5.83168l-13.98784 0.00512c-68.95616 0-132.92544 1.96096-190.12096 5.83168l-1.06496 0.0512c-0.08192 0-9.34912 0.83968-19.14368 6.784-15.04768 9.12896-24.27392 25.94816-27.4176 49.9712-10.07104 76.91264-4.38272 173.64992 0.18944 251.392 2.93888 49.96608 33.408 62.45888 85.04832 67.1488 10.78272 0.98816 69.08928 5.86752 159.50848 5.89312v-0.00512c90.4192-0.02048 148.72576-4.90496 159.5136-5.888 51.64032-4.68992 82.10944-17.18272 85.0432-67.1488 4.57728-77.74208 10.26048-174.47936 0.18944-251.392-3.1488-24.02816-12.37504-40.84736-27.42272-49.97632z m-390.9888 172.71808a23.64928 23.64928 0 0 1-31.68768-10.84416 23.68 23.68 0 0 1 10.84416-31.68768c2.03776-1.00352 50.69312-24.72448 110.5408-43.06432a23.68 23.68 0 1 1 13.88032 45.29152c-56.2944 17.24928-103.11168 40.07424-103.5776 40.30464z m268.89728 35.88608c-0.44032 2.23232-11.26912 54.64064-50.93888 54.64064-21.44256 0-36.10112-14.04928-44.98432-26.77248-8.69376 12.70784-22.80448 26.77248-42.65472 26.77248-35.5328 0-50.13504-48.26624-51.68128-53.77024a11.3664 11.3664 0 0 1 21.87776-6.1696c2.74944 9.6512 14.1312 37.20192 29.7984 37.20192 16.37376 0 28.89216-23.64416 31.98464-31.92832a11.37152 11.37152 0 0 1 10.6496-7.38816h0.06144c4.76672 0.03072 9.0112 3.02592 10.62912 7.50592 0.10752 0.28672 11.96544 31.81568 34.31424 31.81568 20.864 0 28.56448-35.95264 28.64128-36.32128a11.34592 11.34592 0 0 1 13.35808-8.93952 11.36128 11.36128 0 0 1 8.94464 13.35296z m110.11584-46.73536a23.68 23.68 0 0 1-31.68256 10.84416c-0.47104-0.2304-47.47264-23.1168-103.57248-40.30976a23.69024 23.69024 0 0 1-15.70816-29.58336 23.66976 23.66976 0 0 1 29.57824-15.70304c59.84768 18.33984 108.49792 42.0608 110.55104 43.06432a23.68 23.68 0 0 1 10.83392 31.68768z" fill="#F16C8D" p-id="1504"></path><path d="M849.92 51.2H174.08c-67.8656 0-122.88 55.0144-122.88 122.88v675.84c0 67.87072 55.0144 122.88 122.88 122.88h675.84c67.87072 0 122.88-55.00928 122.88-122.88V174.08c0-67.86048-55.00928-122.88-122.88-122.88z m-36.60288 627.45088c-2.62656 44.57984-21.82144 78.63296-55.51616 98.48832-25.68192 15.13472-54.17472 19.48672-81.13664 21.9392-32.45568 2.94912-92.71808 6.09792-164.66432 6.1184-71.94112-0.02048-132.20864-3.16416-164.66432-6.1184-26.96192-2.45248-55.45472-6.80448-81.13152-21.9392-33.69472-19.85536-52.8896-53.90336-55.51104-98.4832-4.70528-80.13312-10.5728-179.85536 0.19456-262.10816C221.5424 335.16544 280.99072 311.57248 311.5008 310.37952a2482.64192 2482.64192 0 0 1 81.42336-4.08576c-7.53664-8.53504-19.88096-23.3216-28.81536-38.11328-13.73696-22.73792 8.52992-41.68704 8.52992-41.68704s23.68-20.36736 44.52864 5.21216c15.69792 19.26656 38.37952 55.99744 48.61952 72.95488l53.20704-0.21504c13.2608 0 26.33216 0.07168 39.2192 0.21504 10.24-16.95744 32.9216-53.6832 48.61952-72.95488 20.84352-25.57952 44.52864-5.21216 44.52864-5.21216s22.26176 18.94912 8.5248 41.68704c-8.9344 14.79168-21.27872 29.57824-28.81536 38.11328 28.35968 0.97792 55.56224 2.33984 81.42336 4.08064 30.5152 1.19808 89.9584 24.79104 100.61312 106.17344 10.7776 82.24768 4.9152 181.96992 0.20992 262.10304z" fill="#F16C8D" p-id="1505"></path></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-9fd4d1dd data-v-f953d92f data-v-bfe7971f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-bfe7971f><span class="vpi-more-horizontal icon" data-v-bfe7971f></span></button><div class="menu" data-v-bfe7971f><div class="VPMenu" data-v-bfe7971f data-v-20ed86d6><!----><!--[--><!--[--><!----><div class="group" data-v-f953d92f><div class="item appearance" data-v-f953d92f><p class="label" data-v-f953d92f>Appearance</p><div class="appearance-action" data-v-f953d92f><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="true" data-v-f953d92f data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-f953d92f><div class="item social-links" data-v-f953d92f><div class="VPSocialLinks social-links-list" data-v-f953d92f data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="mailto:2727678986@qq.com" aria-label="发送邮件" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg></a><a class="VPSocialLink no-icon" href="https://github.com/xiaohuangstudent" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://space.bilibili.com/3493126956124793?spm_id_from=333.788.0.0" aria-label target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><svg t="1751117659737" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1503" width="64" height="64"><path d="M729.32864 373.94944c-9.79456-5.94432-19.06176-6.784-19.14368-6.784l-1.06496-0.0512c-57.20064-3.8656-121.1648-5.83168-190.12608-5.83168l-13.98784 0.00512c-68.95616 0-132.92544 1.96096-190.12096 5.83168l-1.06496 0.0512c-0.08192 0-9.34912 0.83968-19.14368 6.784-15.04768 9.12896-24.27392 25.94816-27.4176 49.9712-10.07104 76.91264-4.38272 173.64992 0.18944 251.392 2.93888 49.96608 33.408 62.45888 85.04832 67.1488 10.78272 0.98816 69.08928 5.86752 159.50848 5.89312v-0.00512c90.4192-0.02048 148.72576-4.90496 159.5136-5.888 51.64032-4.68992 82.10944-17.18272 85.0432-67.1488 4.57728-77.74208 10.26048-174.47936 0.18944-251.392-3.1488-24.02816-12.37504-40.84736-27.42272-49.97632z m-390.9888 172.71808a23.64928 23.64928 0 0 1-31.68768-10.84416 23.68 23.68 0 0 1 10.84416-31.68768c2.03776-1.00352 50.69312-24.72448 110.5408-43.06432a23.68 23.68 0 1 1 13.88032 45.29152c-56.2944 17.24928-103.11168 40.07424-103.5776 40.30464z m268.89728 35.88608c-0.44032 2.23232-11.26912 54.64064-50.93888 54.64064-21.44256 0-36.10112-14.04928-44.98432-26.77248-8.69376 12.70784-22.80448 26.77248-42.65472 26.77248-35.5328 0-50.13504-48.26624-51.68128-53.77024a11.3664 11.3664 0 0 1 21.87776-6.1696c2.74944 9.6512 14.1312 37.20192 29.7984 37.20192 16.37376 0 28.89216-23.64416 31.98464-31.92832a11.37152 11.37152 0 0 1 10.6496-7.38816h0.06144c4.76672 0.03072 9.0112 3.02592 10.62912 7.50592 0.10752 0.28672 11.96544 31.81568 34.31424 31.81568 20.864 0 28.56448-35.95264 28.64128-36.32128a11.34592 11.34592 0 0 1 13.35808-8.93952 11.36128 11.36128 0 0 1 8.94464 13.35296z m110.11584-46.73536a23.68 23.68 0 0 1-31.68256 10.84416c-0.47104-0.2304-47.47264-23.1168-103.57248-40.30976a23.69024 23.69024 0 0 1-15.70816-29.58336 23.66976 23.66976 0 0 1 29.57824-15.70304c59.84768 18.33984 108.49792 42.0608 110.55104 43.06432a23.68 23.68 0 0 1 10.83392 31.68768z" fill="#F16C8D" p-id="1504"></path><path d="M849.92 51.2H174.08c-67.8656 0-122.88 55.0144-122.88 122.88v675.84c0 67.87072 55.0144 122.88 122.88 122.88h675.84c67.87072 0 122.88-55.00928 122.88-122.88V174.08c0-67.86048-55.00928-122.88-122.88-122.88z m-36.60288 627.45088c-2.62656 44.57984-21.82144 78.63296-55.51616 98.48832-25.68192 15.13472-54.17472 19.48672-81.13664 21.9392-32.45568 2.94912-92.71808 6.09792-164.66432 6.1184-71.94112-0.02048-132.20864-3.16416-164.66432-6.1184-26.96192-2.45248-55.45472-6.80448-81.13152-21.9392-33.69472-19.85536-52.8896-53.90336-55.51104-98.4832-4.70528-80.13312-10.5728-179.85536 0.19456-262.10816C221.5424 335.16544 280.99072 311.57248 311.5008 310.37952a2482.64192 2482.64192 0 0 1 81.42336-4.08576c-7.53664-8.53504-19.88096-23.3216-28.81536-38.11328-13.73696-22.73792 8.52992-41.68704 8.52992-41.68704s23.68-20.36736 44.52864 5.21216c15.69792 19.26656 38.37952 55.99744 48.61952 72.95488l53.20704-0.21504c13.2608 0 26.33216 0.07168 39.2192 0.21504 10.24-16.95744 32.9216-53.6832 48.61952-72.95488 20.84352-25.57952 44.52864-5.21216 44.52864-5.21216s22.26176 18.94912 8.5248 41.68704c-8.9344 14.79168-21.27872 29.57824-28.81536 38.11328 28.35968 0.97792 55.56224 2.33984 81.42336 4.08064 30.5152 1.19808 89.9584 24.79104 100.61312 106.17344 10.7776 82.24768 4.9152 181.96992 0.20992 262.10304z" fill="#F16C8D" p-id="1505"></path></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-9fd4d1dd data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><div class="divider" data-v-9fd4d1dd><div class="divider-line" data-v-9fd4d1dd></div></div></div><!----></header><div class="VPLocalNav empty fixed" data-v-d8b57b2d data-v-2488c25a><div class="container" data-v-2488c25a><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-2488c25a data-v-6b867909><button data-v-6b867909>Return to top</button><!----></div></div></div><!----><div class="VPContent" id="VPContent" data-v-d8b57b2d data-v-9a6c75ad><div class="VPDoc has-aside" data-v-9a6c75ad data-v-e6f2a212><!--[--><!--]--><div class="container" data-v-e6f2a212><div class="left-aside aside" data-v-e6f2a212><div class="aside-curtain" data-v-e6f2a212></div><div class="aside-container" data-v-e6f2a212><div class="aside-content" data-v-e6f2a212><div class="VPDocAside" data-v-e6f2a212 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-cb998dce data-v-f610f197><div class="content" data-v-f610f197><div class="outline-marker" data-v-f610f197></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-f610f197>目录</div><ul class="VPDocOutlineItem root" data-v-f610f197 data-v-53c99d69><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e6f2a212><div class="content-container" data-v-e6f2a212><!--[--><!--]--><main class="main" data-v-e6f2a212><div style="position:relative;" class="vp-doc _XIAOHUANG_BLOG_docs_%E7%A1%AC%E4%BB%B6%E8%B5%84%E6%96%99_%E5%BE%AE%E6%8E%A7%E5%88%B6%E5%99%A8MCU_STM32F407ZGT6_%E5%9F%BA%E7%A1%80%E8%B5%84%E6%96%99_stm32f407zgt6" data-v-e6f2a212><div><h1 id="stm32f407zgt6" tabindex="-1">stm32f407zgt6 <a class="header-anchor" href="#stm32f407zgt6" aria-label="Permalink to &quot;stm32f407zgt6&quot;">​</a></h1><h2 id="参考资料" tabindex="-1">参考资料 <a class="header-anchor" href="#参考资料" aria-label="Permalink to &quot;参考资料&quot;">​</a></h2><p>datasheet: <a href="./stm32f407zgt6_localdata/datasheet_1.pdf">datasheet.pdf</a></p><p>stlink网站：<a href="https://www.st.com.cn/zh/development-tools/stsw-link009.html?cache=nocache#get-software" target="_blank" rel="noreferrer">STSW-LINK009 - ST-LINK、ST-LINK/V2、ST-LINK/V2-1、TLINK-V3 USB驱动程序，已签名适用于Windows7、Windows8、Windows10系统 - 意法半导体STMicroelectronics</a></p><p>stlink驱动：<a href="https://blog.csdn.net/qq_52102933/article/details/126830904" target="_blank" rel="noreferrer">ST-Link驱动的下载、安装、配置，以及ST-Link固件的升级_stlink驱动-CSDN博客</a></p><p>淘宝板原理图： <a href="./stm32f407zgt6_localdata/STM32F407ZGT6_1.pdf">STM32F407ZGT6.pdf</a></p><h2 id="cubeide" tabindex="-1">CubeIDE <a class="header-anchor" href="#cubeide" aria-label="Permalink to &quot;CubeIDE&quot;">​</a></h2><p>下载：<a href="https://www.st.com/en/development-tools/stm32cubemx.html?dl=%2BAIW6gn4cLce4TdNGUUXOQ%3D%3D%2CDCcWeMOKF3lQiG4ObK6BLVuylIfSegfK2c8wnfeddGOIeNpcUYil9oOgrTvJ5e1rVRo3pHmp1UzB7iqiq3yYHqtPBjQStN0p5EjTzRAJb8fDbbV%2BHnp3Z2RA0VpSuPn%2BspdiRKCiOObNGAcf70%2FCM16oY1%2FTmELJDcXsNTzNOUyqoHoMQtU4MbN18VeHAKDJbxpuwBqQ77jy2XvEniUkGROnPixk3kpVPe7zrE5IS7ZmZHiumiZATQ6DcGSXXBj8QBLBosPZpUGGoL6AcEsO6s6uI2ZQnvwXxdTOGHHq71265sudf2G3cY2SIo1AonV69wWfasZ%2F0D1jvFjw%2BJVD%2FhvFXtP%2BUzwmdJwxRPnGj5GvdclKPUDTPRIzyw5oJlzA&amp;mkt_tok=ODU2LVBWUC03MTUAAAGXOu2kRx3QrsAz0nhSuVEsh3S0MtGFsH_8qFYq9NEOuiDbFgCn3oKG5z189W10YAqmzVgc8OTU_m37Qn7jq6xiIFDG57w4gjZR_lzYJp8TyQ" target="_blank" rel="noreferrer">STM32CubeMX - STM32Cube initialization code generator - STMicroelectronics</a></p><p>代码补全： alt+/</p><p>串口下载代码：<a href="https://blog.csdn.net/chenhuanqiangnihao/article/details/127223633" target="_blank" rel="noreferrer">Stm32 cube IDE生成代码 +烧写下载elf文件和 Stm32 cube Programmer 下载elf、hex、bin文件_stm32kill那三个编译按钮分别对应什么-CSDN博客</a></p><h2 id="报错解决" tabindex="-1">报错解决 <a class="header-anchor" href="#报错解决" aria-label="Permalink to &quot;报错解决&quot;">​</a></h2><blockquote><p>Error in initializing ST-LINK device.</p><p>Reason: Target not halted.</p><p>参考：<a href="https://blog.csdn.net/geniusChinaHN/article/details/141532916?spm=1001.2014.3001.5501" target="_blank" rel="noreferrer">Error message from debugger back end: Error finishing flash operation-CSDN博客</a></p><p>1、BOOT连接高电平，然后再上电（顺序不能反）</p><p>2、STM32 ST-LINK Utility进行CONNECT</p><p>3、擦除整块</p><img src="/XIAOHUANG_BLOG/assets/image-20250726161254190_1.HhMHFxsh.png" alt="image-20250726161254190" style="zoom:50%;"><p>4、BOOT连GND重新烧</p></blockquote><h2 id="代码配置" tabindex="-1">代码配置 <a class="header-anchor" href="#代码配置" aria-label="Permalink to &quot;代码配置&quot;">​</a></h2><p>新建项目参考：<a href="https://blog.csdn.net/qq_36669063/article/details/131218225" target="_blank" rel="noreferrer">Keil4/keil5如何新建C51/STM32工程项目（手把手教细节）_keil4怎么建立工程-CSDN博客</a></p><p>新建完成后从空模板中拷贝以下文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CORE：STM32最核心部分，用于存放给STM32单片机初始化的核心文件</span></span>
<span class="line"><span></span></span>
<span class="line"><span>FWLib：里面还含有src和inc两个文件夹，但是作用是存放stm32单片机的所有函数方法，这些函数方法来自于你提前准备好的stm32标准库源文件包。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>SYSTEM：用于存放你自己写的函数方法，而且一般是功能性的函数方法（你可以不用这个文件夹，自己写的函数方法放在User文件夹里，这都是自由的）</span></span>
<span class="line"><span></span></span>
<span class="line"><span>User：用于存放主函数main.c、其他自定义函数方法</span></span></code></pre></div><p>修改迁移项目名称：<a href="https://blog.csdn.net/xiaoxilang/article/details/80448488" target="_blank" rel="noreferrer">基本操作之-keil5在原有工程上修改工程名_keil改文件名-CSDN博客</a></p><h3 id="基本用法" tabindex="-1">基本用法 <a class="header-anchor" href="#基本用法" aria-label="Permalink to &quot;基本用法&quot;">​</a></h3><p>定义字符数组</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>char message[]=&quot;Hello World&quot;;</span></span></code></pre></div><h2 id="cubeide-1" tabindex="-1">CubeIDE <a class="header-anchor" href="#cubeide-1" aria-label="Permalink to &quot;CubeIDE&quot;">​</a></h2><h3 id="openocd远程烧录器" tabindex="-1">OpenOCD远程烧录器 <a class="header-anchor" href="#openocd远程烧录器" aria-label="Permalink to &quot;OpenOCD远程烧录器&quot;">​</a></h3><p><a href="https://blog.csdn.net/m0_37717813/article/details/130210769?ops_request_misc=%7B%22request%5Fid%22%3A%22265ab42c8b3fb4ea6639c07459141cec%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=265ab42c8b3fb4ea6639c07459141cec&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~ElasticSearch~search_v2-2-130210769-null-null.142%5Ev102%5Epc_search_result_base3&amp;utm_term=STM32IDE%E6%97%A0%E7%BA%BFDAP%E8%B0%83%E8%AF%95&amp;spm=1018.2226.3001.4187" target="_blank" rel="noreferrer">基于 OpenOCD 的 STM32CubeIDE 开发烧录调试环境搭建-DAPLINK_openocd daplink-CSDN博客</a></p><img src="/XIAOHUANG_BLOG/assets/image-20250422193635827_1.Dh9I1nCk.png" alt="image-20250422193635827" style="zoom:67%;"><p>压缩包路径： <a href="./stm32f407zgt6_localdata/远程烧录DAP.html">远程烧录DAP</a></p><p>dap下载路径：</p><p>gcc下载路径：<a href="https://gnutoolchains.com/arm-eabi/" target="_blank" rel="noreferrer">Prebuilt GNU toolchain for ARM</a></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>文件名：DAP-Linkl-stm32H7.bat</span></span>
<span class="line"><span>openocd -f interface/cmsis-dap.cfg -f target/stm32h7x.cfg</span></span></code></pre></div><p>环境变量配置</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>E:\Apps_diskE\OpenOCD\OpenOCD-20240916-0.12.0\bin</span></span></code></pre></div><blockquote><p>报错解决</p><p>[高版本CubeIDE下使用DAP-LINK教程_cubeide daplink-CSDN博客](<a href="https://blog.csdn.net/lone5moon/article/details/124940297?ops_request_misc=%7B%22request%5Fid%22%3A%2273a5742835aa033bc27b71099d40bb03%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=73a5742835aa033bc27b71099d40bb03&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-124940297-null-null.142%5Ev102%5Epc_search_result_base3&amp;utm_term=cubeide%E6%8A%A5%E9%94%99Could" target="_blank" rel="noreferrer">https://blog.csdn.net/lone5moon/article/details/124940297?ops_request_misc={&quot;request_id&quot;%3A&quot;73a5742835aa033bc27b71099d40bb03&quot;%2C&quot;scm&quot;%3A&quot;20140713.130102334..&quot;}&amp;request_id=73a5742835aa033bc27b71099d40bb03&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-124940297-null-null.142^v102^pc_search_result_base3&amp;utm_term=cubeide报错Could</a> not verify ST device&amp;spm=1018.2226.3001.4187)</p><img src="/XIAOHUANG_BLOG/assets/image-20250430211547207_1.B_fbfPn-.png" alt="image-20250430211547207" style="zoom:33%;"><img src="/XIAOHUANG_BLOG/assets/image-20250430211606043_1.BupofCgG.png" alt="image-20250430211606043" style="zoom:33%;"><img src="/XIAOHUANG_BLOG/assets/image-20250430211621660_1.D6au85e9.png" alt="image-20250430211621660" style="zoom:33%;"></blockquote><h3 id="cubeide新建配置" tabindex="-1">cubeide新建配置 <a class="header-anchor" href="#cubeide新建配置" aria-label="Permalink to &quot;cubeide新建配置&quot;">​</a></h3><p>JLink设置：<a href="https://blog.csdn.net/Hober_Mallow/article/details/111872401" target="_blank" rel="noreferrer">在STM32 CubeIDE中配置为J-Link调试的步骤_cubeide jlink-CSDN博客</a></p><img src="/XIAOHUANG_BLOG/assets/image-20250117181907497_1.CoFUhO7M.png" alt="image-20250117181907497" style="zoom:50%;"><p>为每个外设生成.c .h</p><img src="/XIAOHUANG_BLOG/assets/image-20241210190223043_1.CY6HW5F7.png" alt="image-20241210190223043" style="zoom:50%;"><p>新建.c .h即可建自己的</p><p>sys中的debug要设置成Serial Wire</p><img src="/XIAOHUANG_BLOG/assets/image-20250219200050793_1.DU_UU2mZ.png" alt="image-20250219200050793" style="zoom:67%;"><p>rcc中设置为首字母为CCR的</p><img src="/XIAOHUANG_BLOG/assets/image-20250219200136874_1.Buw554-v.png" alt="image-20250219200136874" style="zoom:67%;"><h3 id="变量实时显示设置" tabindex="-1">变量实时显示设置 <a class="header-anchor" href="#变量实时显示设置" aria-label="Permalink to &quot;变量实时显示设置&quot;">​</a></h3><img src="/XIAOHUANG_BLOG/assets/image-20250319222318062_1.ZzmN5MII.png" alt="image-20250319222318062" style="zoom:67%;"><img src="/XIAOHUANG_BLOG/assets/image-20250319222243478_1.DCBcc4ol.png" alt="image-20250319222243478" style="zoom:50%;"><h3 id="include内容" tabindex="-1">#include内容 <a class="header-anchor" href="#include内容" aria-label="Permalink to &quot;#include内容&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#include &lt;stdio.h&gt;</span></span>
<span class="line"><span>#include &quot;stm32f4xx_hal.h&quot;</span></span>
<span class="line"><span>#include &lt;string.h&gt;</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#include &quot;main.h&quot;</span></span>
<span class="line"><span>#include &quot;tim.h&quot;</span></span>
<span class="line"><span>#include &quot;usart.h&quot;</span></span>
<span class="line"><span>#include &quot;gpio.h&quot;</span></span></code></pre></div><h2 id="时钟树配置clock-configuration" tabindex="-1">时钟树配置Clock Configuration <a class="header-anchor" href="#时钟树配置clock-configuration" aria-label="Permalink to &quot;时钟树配置Clock Configuration&quot;">​</a></h2><h3 id="h7系列" tabindex="-1">H7系列 <a class="header-anchor" href="#h7系列" aria-label="Permalink to &quot;H7系列&quot;">​</a></h3><img src="/XIAOHUANG_BLOG/assets/image-20250320113343933_1.D9lXsk0p.png" alt="image-20250320113343933" style="zoom:50%;"><h2 id="gpio" tabindex="-1">GPIO <a class="header-anchor" href="#gpio" aria-label="Permalink to &quot;GPIO&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>MX_GPIO_Init();  //这句话系统帮我们设置了gpio</span></span></code></pre></div><p>exp1:按键按下读取按键电平，设置led引脚高低电平</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>  while (1)</span></span>
<span class="line"><span>  {</span></span>
<span class="line"><span>//	 读取pin脚的电平HAL_GPIO_ReadPin(keys1_GPIO_Port, keys1_Pin);</span></span>
<span class="line"><span>	  if(HAL_GPIO_ReadPin(keys1_GPIO_Port, keys1_Pin)==GPIO_PIN_RESET){</span></span>
<span class="line"><span>//		  设置输出gpio的值HAL_GPIO_WritePin(led2_GPIO_Port, led2_Pin,GPIO_PIN_RESET);</span></span>
<span class="line"><span>		  HAL_GPIO_WritePin(led2_GPIO_Port, led2_Pin,GPIO_PIN_RESET);//出低</span></span>
<span class="line"><span>	  }else{</span></span>
<span class="line"><span>		  HAL_GPIO_WritePin(led2_GPIO_Port, led2_Pin,GPIO_PIN_SET);</span></span>
<span class="line"><span>	  }</span></span>
<span class="line"><span>    /* USER CODE END WHILE */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /* USER CODE BEGIN 3 */</span></span>
<span class="line"><span>  }</span></span></code></pre></div><p>exp2:按键按下，GPIO反转，带软件消抖</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>  while (1)</span></span>
<span class="line"><span>  {</span></span>
<span class="line"><span>	  if (HAL_GPIO_ReadPin(keys1_GPIO_Port, keys1_Pin) == GPIO_PIN_RESET) {</span></span>
<span class="line"><span>	      HAL_Delay(25); // 延时50ms，去抖动</span></span>
<span class="line"><span>	      if (HAL_GPIO_ReadPin(keys1_GPIO_Port, keys1_Pin) == GPIO_PIN_RESET) {</span></span>
<span class="line"><span>	          HAL_GPIO_TogglePin(led2_GPIO_Port, led2_Pin);</span></span>
<span class="line"><span>	      }</span></span>
<span class="line"><span>	  }</span></span>
<span class="line"><span>    /* USER CODE END WHILE */</span></span>
<span class="line"><span>    /* USER CODE BEGIN 3 */</span></span>
<span class="line"><span>  }</span></span></code></pre></div><h2 id="中断" tabindex="-1">中断 <a class="header-anchor" href="#中断" aria-label="Permalink to &quot;中断&quot;">​</a></h2><h3 id="按键中断" tabindex="-1">按键中断 <a class="header-anchor" href="#按键中断" aria-label="Permalink to &quot;按键中断&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>MX_USART3_UART_Init();  //这句话系统帮我们设置了串口</span></span></code></pre></div><p>exp1:按键中断实现led反转，且中断组判断中断引脚</p><p>pin要设置成中断，gpio中要配置电阻，nvic中要使用对应的中断，然后在stm32f4xx_it.c中找到对应的中断服务程序写入函数</p><blockquote><p>如果中断中存在延时函数，systick的优先级要高于中断优先级</p></blockquote><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>void EXTI15_10_IRQHandler(void)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  /* USER CODE BEGIN EXTI15_10_IRQn 0 */</span></span>
<span class="line"><span>	// 检查引脚10是否触发中断,GPIO_PIN_10可以写成keys3_ir_Pin</span></span>
<span class="line"><span>	if (__HAL_GPIO_EXTI_GET_IT(GPIO_PIN_10) != RESET) {</span></span>
<span class="line"><span>	   // 处理来自引脚10的中断</span></span>
<span class="line"><span>	   __HAL_GPIO_EXTI_CLEAR_IT(GPIO_PIN_10);   //或者HAL_GPIO_EXTI_IRQHandler(keys3_ir_Pin);</span></span>
<span class="line"><span>	   //反转led1</span></span>
<span class="line"><span>	   HAL_GPIO_TogglePin(led1_GPIO_Port, led1_Pin);</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>  /* USER CODE END EXTI15_10_IRQn 0 */</span></span>
<span class="line"><span>}</span></span></code></pre></div><ul><li>中断重写集合</li></ul><img src="/XIAOHUANG_BLOG/assets/image-20250204151757558_1.BKFFme0P.png" alt="image-20250204151757558" style="zoom:50%;"><h3 id="多个端口中断" tabindex="-1">多个端口中断 <a class="header-anchor" href="#多个端口中断" aria-label="Permalink to &quot;多个端口中断&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>void HAL_GPIO_EXTI_Callback(uint16_t GPIO_Pin)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>    if(GPIO_Pin == GPIO_PIN_0)</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        if(__HAL_GPIO_EXTI_GET_IT(GPIO_PIN_0) != RESET)</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            if(GPIOA-&gt;IDR &amp; GPIO_PIN_0)</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                // PA0触发的中断</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>            else if(GPIOB-&gt;IDR &amp; GPIO_PIN_0)</span></span>
<span class="line"><span>            {</span></span>
<span class="line"><span>                // PB0触发的中断</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>            __HAL_GPIO_EXTI_CLEAR_IT(GPIO_PIN_0);</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span></code></pre></div><h3 id="回调方式中断" tabindex="-1">回调方式中断 <a class="header-anchor" href="#回调方式中断" aria-label="Permalink to &quot;回调方式中断&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>void HAL_GPIO_EXTI_Callback(uint16_t GPIO_Pin)//实现一下回调函数</span></span>
<span class="line"><span> {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   if(GPIO_Pin == GPIO_PIN_10){</span></span>
<span class="line"><span>	   key1_function();</span></span>
<span class="line"><span>//       __HAL_GPIO_EXTI_CLEAR_IT(GPIO_PIN_10);</span></span>
<span class="line"><span>   }</span></span>
<span class="line"><span> }</span></span></code></pre></div><h3 id="编码器gpio中断" tabindex="-1">编码器GPIO中断 <a class="header-anchor" href="#编码器gpio中断" aria-label="Permalink to &quot;编码器GPIO中断&quot;">​</a></h3><h2 id="定时器" tabindex="-1">定时器 <a class="header-anchor" href="#定时器" aria-label="Permalink to &quot;定时器&quot;">​</a></h2><h3 id="定时器中断" tabindex="-1">定时器中断 <a class="header-anchor" href="#定时器中断" aria-label="Permalink to &quot;定时器中断&quot;">​</a></h3><p>参考：<a href="https://blog.csdn.net/weixin_62567907/article/details/142782885?ops_request_misc=%7B%22request%5Fid%22%3A%224dc3adfd1eacb56d49b7adf8c9767bd4%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=4dc3adfd1eacb56d49b7adf8c9767bd4&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-142782885-null-null.142%5Ev101%5Epc_search_result_base3&amp;utm_term=cubeide%E4%B8%B2%E5%8F%A3&amp;spm=1018.2226.3001.4187" target="_blank" rel="noreferrer">STM32-CubeIDE用串口通讯_stm32cubeide 串口-CSDN博客</a></p><p>定时器中断，在中断中通过串口发送格式化输出的数据，每0.2s发送一次，则</p><!----><p>定时器中断周期</p><!----><!----><p>定时器配置</p><p><img src="/XIAOHUANG_BLOG/assets/image-20250203132203254_1.CSmEZV8U.png" alt="image-20250203132203254" loading="lazy"></p><p>中断配置</p><p><img src="/XIAOHUANG_BLOG/assets/image-20250203132326112_1.Bc_vJlBp.png" alt="image-20250203132326112" loading="lazy"></p><p>中断服务程序</p><p>中断开启</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>//开启定时器中断TIM3，用于串口发送数据</span></span>
<span class="line"><span>	HAL_TIM_Base_Start_IT(&amp;htim3);</span></span></code></pre></div><h4 id="weak重写" tabindex="-1">__weak重写 <a class="header-anchor" href="#weak重写" aria-label="Permalink to &quot;__weak重写&quot;">​</a></h4><ul><li>定时器中断定时溢出的回调函数</li></ul><img src="/XIAOHUANG_BLOG/assets/image-20250204022446149_1.B2e9CZW9.png" alt="image-20250204022446149" style="zoom:67%;"><p>中的</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>HAL_TIM_PeriodElapsedCallback(htim);</span></span></code></pre></div><p>定义也在</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>__weak void HAL_TIM_PeriodElapsedCallback(TIM_HandleTypeDef *htim)</span></span></code></pre></div><img src="/XIAOHUANG_BLOG/assets/image-20250204022843901_1.CtaFDRhH.png" alt="image-20250204022843901" style="zoom:50%;"><p>在主程序中重写</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>char message[100];</span></span>
<span class="line"><span>void HAL_TIM_PeriodElapsedCallback(TIM_HandleTypeDef *htim){  //定时器中断</span></span>
<span class="line"><span> if(htim==&amp;htim3){</span></span>
<span class="line"><span>	 //串口发送数据,格式化输出</span></span>
<span class="line"><span>	 sprintf(message,&quot;Hello World2!&quot;);</span></span>
<span class="line"><span>	 HAL_UART_Transmit(&amp;huart1, (uint8_t*)message, strlen(message), 100);</span></span>
<span class="line"><span> }</span></span>
<span class="line"><span>}</span></span></code></pre></div><h2 id="pwm" tabindex="-1">PWM <a class="header-anchor" href="#pwm" aria-label="Permalink to &quot;PWM&quot;">​</a></h2><p>exp1:实现呼吸灯</p><p>时钟树设置和下面一样，参数设置如下</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/* USER CODE BEGIN 2 */</span></span>
<span class="line"><span>  //开启pwm</span></span>
<span class="line"><span>  HAL_TIM_PWM_Start(&amp;htim10, TIM_CHANNEL_1);</span></span>
<span class="line"><span>  /* USER CODE END 2 */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  /* Infinite loop */</span></span>
<span class="line"><span>  /* USER CODE BEGIN WHILE */</span></span>
<span class="line"><span>  while(1){</span></span>
<span class="line"><span>	  for(int i=0;i&lt;100;i++){</span></span>
<span class="line"><span>		  //设置自动比较寄存器的值</span></span>
<span class="line"><span>		  __HAL_TIM_SET_COMPARE(&amp;htim10,TIM_CHANNEL_1,i);</span></span>
<span class="line"><span>		  HAL_Delay(10);</span></span>
<span class="line"><span>	  }</span></span>
<span class="line"><span>	  for(int i=99;i&gt;=0;i--){</span></span>
<span class="line"><span>	  		  //设置自动比较寄存器的值</span></span>
<span class="line"><span>	  		  __HAL_TIM_SET_COMPARE(&amp;htim10,TIM_CHANNEL_1,i);</span></span>
<span class="line"><span>	  		  HAL_Delay(1);</span></span>
<span class="line"><span>	  	  }</span></span>
<span class="line"><span>    /* USER CODE END WHILE */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /* USER CODE BEGIN 3 */</span></span>
<span class="line"><span>  }</span></span></code></pre></div><p>exp2：输出如下pwm波,并控制电机转动</p><!----><p>在时钟树中设置主频，配置TIM引脚，RCC选择</p><img src="/XIAOHUANG_BLOG/assets/image-20241210212153724_1.lWsB7biO.png" alt="image-20241210212153724" style="zoom:67%;"><p>时钟树选择 HCLK为72</p><img src="/XIAOHUANG_BLOG/assets/image-20241210212235174_1.CKoh1EL9.png" alt="image-20241210212235174" style="zoom:50%;"><p>主要公式</p><!----><img src="/XIAOHUANG_BLOG/assets/image-20241210201157377_1.BhNtaiUp.png" alt="image-20241210201157377" style="zoom:50%;"><p>新建文件如下</p><p><img src="data:image/png;base64,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" alt="image-20241210230314163" loading="lazy"></p><p>servomotor.h</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/*</span></span>
<span class="line"><span> * servomotor.h</span></span>
<span class="line"><span> *</span></span>
<span class="line"><span> *  Created on: Dec 10, 2024</span></span>
<span class="line"><span> *      Author: 27276</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#ifndef SRC_SERVOMOTOR_SERVOMOTOR_H_</span></span>
<span class="line"><span>#define SRC_SERVOMOTOR_SERVOMOTOR_H_</span></span>
<span class="line"><span></span></span>
<span class="line"><span>void setangle_bottonservo(float theta);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#endif /* SRC_SERVOMOTOR_SERVOMOTOR_H_ */</span></span></code></pre></div><p>servomotor.c</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#include &quot;servomotor.h&quot;</span></span>
<span class="line"><span>#include &quot;tim.h&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//根据角度旋转设置比较计数器的值</span></span>
<span class="line"><span>//假设已经启动了，arr+1=20000；psc+1=72</span></span>
<span class="line"><span>//底座的控制线是PC7_TIM3_CH2</span></span>
<span class="line"><span>void setangle_bottonservo(float theta){</span></span>
<span class="line"><span>//	pmin=0.025;</span></span>
<span class="line"><span>//	rhomax=0.125;</span></span>
<span class="line"><span>	int cur=theta/180*(0.1)*20000+20000*0.025;</span></span>
<span class="line"><span>	__HAL_TIM_SET_COMPARE(&amp;htim3,TIM_CHANNEL_2,cur);</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>已知psc+1=72,arr+1=20000</p><!----><p>main.c</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span> MX_TIM10_Init();</span></span>
<span class="line"><span>  MX_TIM8_Init();</span></span>
<span class="line"><span>  MX_TIM3_Init();</span></span>
<span class="line"><span>  MX_ADC1_Init();</span></span>
<span class="line"><span>  /* USER CODE BEGIN 2 */</span></span>
<span class="line"><span>  //开启pwm</span></span>
<span class="line"><span>  HAL_TIM_PWM_Start(&amp;htim10, TIM_CHANNEL_1);</span></span>
<span class="line"><span>  HAL_TIM_PWM_Start(&amp;htim3, TIM_CHANNEL_2);//pwm底座adc启动</span></span>
<span class="line"><span>  /* USER CODE END 2 */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  /* Infinite loop */</span></span>
<span class="line"><span>  /* USER CODE BEGIN WHILE */</span></span>
<span class="line"><span>  setangle_bottonservo(90.0);</span></span>
<span class="line"><span>  while(1){</span></span>
<span class="line"><span>	  setangle_bottonservo(0.0);</span></span>
<span class="line"><span>	  HAL_Delay(1000);</span></span>
<span class="line"><span>	  setangle_bottonservo(90.0);</span></span>
<span class="line"><span>	  HAL_Delay(1000);</span></span>
<span class="line"><span>	  setangle_bottonservo(180.0);</span></span>
<span class="line"><span>	  HAL_Delay(1000);</span></span>
<span class="line"><span>    /* USER CODE END WHILE */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /* USER CODE BEGIN 3 */</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  /* USER CODE END 3 */</span></span></code></pre></div><ul><li>对于舵机</li></ul><p>(x-0)/180=(x-0.5)/(2.5-0.5)</p><h2 id="adc" tabindex="-1">ADC <a class="header-anchor" href="#adc" aria-label="Permalink to &quot;ADC&quot;">​</a></h2><p>主要参考：[HAL库配置ADC+DMA_stm32cubemx adc-CSDN博客](<a href="https://blog.csdn.net/m0_61973119/article/details/143055637?ops_request_misc=%7B%22request%5Fid%22%3A%22918a31c0bfc77b65e381ec081472f90b%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=918a31c0bfc77b65e381ec081472f90b&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-143055637-null-null.142%5Ev102%5Epc_search_result_base3&amp;utm_term=" target="_blank" rel="noreferrer">https://blog.csdn.net/m0_61973119/article/details/143055637?ops_request_misc={&quot;request_id&quot;%3A&quot;918a31c0bfc77b65e381ec081472f90b&quot;%2C&quot;scm&quot;%3A&quot;20140713.130102334..&quot;}&amp;request_id=918a31c0bfc77b65e381ec081472f90b&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-143055637-null-null.142^v102^pc_search_result_base3&amp;utm_term=</a> HAL stm32 adc&amp;spm=1018.2226.3001.4187)</p><p>校准（不太用得到）：<a href="https://blog.csdn.net/weixin_42328389/article/details/129518720" target="_blank" rel="noreferrer">STM32L0 ADC使用HAL库关于校准问题的说明_mcu adc校准-CSDN博客</a></p><h3 id="单通道adc" tabindex="-1">单通道ADC <a class="header-anchor" href="#单通道adc" aria-label="Permalink to &quot;单通道ADC&quot;">​</a></h3><p>使用的是adc_in</p><p>exp1</p><p>注意：16位的是665535</p><img src="/XIAOHUANG_BLOG/assets/image-20250324001404241_1.Bw9RECsi.png" alt="image-20250324001404241" style="zoom:80%;"><p>校准</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>HAL_ADCEx_Calibration_Start();</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>int value=0;</span></span>
<span class="line"><span>float voltage=0.0;</span></span>
<span class="line"><span>int main(void)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>while (1)</span></span>
<span class="line"><span>  {</span></span>
<span class="line"><span>	  HAL_ADC_Start(&amp;hadc1);</span></span>
<span class="line"><span>	  HAL_ADC_PollForConversion(&amp;hadc1, 20);</span></span>
<span class="line"><span>	  value=HAL_ADC_GetValue(&amp;hadc1);</span></span>
<span class="line"><span>	  voltage=(value/65536.0)*3.3;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>	  HAL_Delay(100);</span></span>
<span class="line"><span>    /* USER CODE END WHILE */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /* USER CODE BEGIN 3 */</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>如果要配置成连续转换模式</p><img src="/XIAOHUANG_BLOG/assets/image-20250527214455136_1.BO83HjSy.png" alt="image-20250527214455136" style="zoom:50%;"><h3 id="单通道轮询实现多通道-不好" tabindex="-1">单通道轮询实现多通道（不好） <a class="header-anchor" href="#单通道轮询实现多通道-不好" aria-label="Permalink to &quot;单通道轮询实现多通道（不好）&quot;">​</a></h3><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">uint32_t</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ADC_Get_Average</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">uint32_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> Channel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">uint8_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> times</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	ADC_ChannelConfTypeDef sConfig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//通道初始化</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	uint32_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> value_sum</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	sConfig.Channel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Channel;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	sConfig.SamplingTime </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ADC3_SAMPLETIME_2CYCLES_5;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">		//采用周期239.5周期</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	sConfig.Rank </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	sConfig.SingleDiff </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ADC_SINGLE_ENDED;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	sConfig.OffsetNumber </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ADC_OFFSET_NONE;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	sConfig.Offset </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	sConfig.OffsetSign </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ADC3_OFFSET_SIGN_NEGATIVE;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HAL_ADC_ConfigChannel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hadc3, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sConfig) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> HAL_OK)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">times;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		HAL_ADC_Start</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hadc3);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">								//启动转换</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		HAL_ADC_PollForConversion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hadc3,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">				//等待转化结束</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		value_sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HAL_ADC_GetValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hadc3);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">				//求和</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		HAL_ADC_Stop</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hadc3);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">								//停止转换</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> value_sum</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">times;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">									//返回平均值</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>使用</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>	  current_adc1_value[0]=ADC_Get_Average(ADC_CHANNEL_1,30);</span></span>
<span class="line"><span>	  current_adc1_value[1]=ADC_Get_Average(ADC_CHANNEL_4,30);</span></span>
<span class="line"><span>	  current_adc1_value[2]=ADC_Get_Average(ADC_CHANNEL_3,30);</span></span>
<span class="line"><span>	  current_adc1_value[3]=ADC_Get_Average(ADC_CHANNEL_2,30);</span></span></code></pre></div><h3 id="多通道dma模式" tabindex="-1">多通道DMA模式 <a class="header-anchor" href="#多通道dma模式" aria-label="Permalink to &quot;多通道DMA模式&quot;">​</a></h3><h4 id="单次扫描模式-存储在数组中" tabindex="-1">单次扫描模式（存储在数组中） <a class="header-anchor" href="#单次扫描模式-存储在数组中" aria-label="Permalink to &quot;单次扫描模式（存储在数组中）&quot;">​</a></h4><h4 id="连续扫描模式-存储在数组中" tabindex="-1">连续扫描模式（存储在数组中） <a class="header-anchor" href="#连续扫描模式-存储在数组中" aria-label="Permalink to &quot;连续扫描模式（存储在数组中）&quot;">​</a></h4><img src="/XIAOHUANG_BLOG/assets/image-20250527223133904_1.D2xwblOw.png" alt="image-20250527223133904" style="zoom:67%;"><p>DMA的channel要设置成DMA Stream</p><img src="/XIAOHUANG_BLOG/assets/image-20250530133420721_1.eT2wKznp.png" alt="image-20250530133420721" style="zoom:80%;"><p>字设置如同（默认）</p><img src="/XIAOHUANG_BLOG/assets/image-20250527222613924_1.D4yFaK8o.png" alt="image-20250527222613924" style="zoom:50%;"><p>连续模式DMA需要设置成Circular</p><img src="/XIAOHUANG_BLOG/assets/image-20250527223354174_1.BljjYetT.png" alt="image-20250527223354174" style="zoom:50%;"><p>DMA触发程序</p><img src="/XIAOHUANG_BLOG/assets/image-20250527225216284_1.CC7HzqM5.png" alt="image-20250527225216284" style="zoom:80%;"><p>转换完成中断回调函数</p><img src="/XIAOHUANG_BLOG/assets/image-20250527222955387_1.w1Qn0ol6.png" alt="image-20250527222955387" style="zoom:67%;"><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span></span></span></code></pre></div><h2 id="串口" tabindex="-1">串口 <a class="header-anchor" href="#串口" aria-label="Permalink to &quot;串口&quot;">​</a></h2><p>串口调试助手： <a href="./stm32f407zgt6_localdata/%E4%B8%B2%E5%8F%A3%E8%B0%83%E8%AF%95%E5%B7%A5%E5%85%B7_1.exe">串口调试工具.exe</a></p><p>在线串口调试助手：<a href="https://serial.keysking.com/" target="_blank" rel="noreferrer">波特律动 串口助手</a></p><p>注意淘宝买的和那个usb转ttl是tx-tx,rx-rx</p><h3 id="空闲中断" tabindex="-1">空闲中断 <a class="header-anchor" href="#空闲中断" aria-label="Permalink to &quot;空闲中断&quot;">​</a></h3><p>HAL_UART_Transmit的使用sizeof</p><p>参考:<a href="https://blog.csdn.net/Londoge/article/details/139610106?ops_request_misc=%7B%22request%5Fid%22%3A%225b6a2bb2e6fa15f83b0b28346e217aa8%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=5b6a2bb2e6fa15f83b0b28346e217aa8&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-4-139610106-null-null.142%5Ev102%5Epc_search_result_base2&amp;utm_term=stm32cubemx%E4%B8%B2%E5%8F%A3%E7%A9%BA%E9%97%B2%E4%B8%AD%E6%96%AD&amp;spm=1018.2226.3001.4187" target="_blank" rel="noreferrer">STM32 HAL CubeMX 串口IDLE接收空闲中断 不使用DMA_cubemx 串口空闲中断-CSDN博客</a></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#include &quot;stdio.h&quot;</span></span>
<span class="line"><span>#include &quot;string.h&quot;</span></span></code></pre></div><p>初始化</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>  HAL_UARTEx_ReceiveToIdle_IT(&amp;huart1, my_uart1_redatas, RemaxLen);</span></span>
<span class="line"><span>  HAL_UARTEx_ReceiveToIdle_IT(&amp;huart2, my_uart2_redatas, RemaxLen);</span></span>
<span class="line"><span>  HAL_UARTEx_ReceiveToIdle_IT(&amp;huart3, my_uart3_redatas, RemaxLen);</span></span></code></pre></div><p>主循环</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span> while (1)</span></span>
<span class="line"><span>  {</span></span>
<span class="line"><span>    /* USER CODE END WHILE */</span></span>
<span class="line"><span>	  //空闲中断溢出</span></span>
<span class="line"><span>	  if(my_uart1_rxflag == 1)</span></span>
<span class="line"><span>	  {</span></span>
<span class="line"><span>		  my_uart1_rxflag = 0;</span></span>
<span class="line"><span>//		  HAL_UART_Transmit(&amp;huart1, my_uart1_redatas, my_uart1_indx, 0xff);</span></span>
<span class="line"><span>		  HAL_UART_Transmit(&amp;huart3, my_uart1_redatas, my_uart1_indx, 0xff);</span></span>
<span class="line"><span>		  memset(my_uart1_redatas, 0 ,RemaxLen);</span></span>
<span class="line"><span>	  }</span></span>
<span class="line"><span>	  if(my_uart2_rxflag == 1)</span></span>
<span class="line"><span>	  {</span></span>
<span class="line"><span>		  my_uart2_rxflag = 0;</span></span>
<span class="line"><span>		  HAL_UART_Transmit(&amp;huart2, my_uart2_redatas, my_uart2_indx, 0xff);</span></span>
<span class="line"><span>		  memset(my_uart2_redatas, 0 ,RemaxLen);</span></span>
<span class="line"><span>	  }</span></span>
<span class="line"><span>	  if(my_uart3_rxflag == 1)</span></span>
<span class="line"><span>	  {</span></span>
<span class="line"><span>		  my_uart3_rxflag = 0;</span></span>
<span class="line"><span>//		  HAL_UART_Transmit(&amp;huart3, my_uart3_redatas, my_uart3_indx, 0xff);</span></span>
<span class="line"><span>		  HAL_UART_Transmit(&amp;huart1, my_uart3_redatas, my_uart3_indx, 0xff);</span></span>
<span class="line"><span>		  memset(my_uart3_redatas, 0 ,RemaxLen);</span></span>
<span class="line"><span>	  }</span></span></code></pre></div><p>全局函数</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/* Private function prototypes -----------------------------------------------*/</span></span>
<span class="line"><span>void SystemClock_Config(void);</span></span>
<span class="line"><span>/* USER CODE BEGIN PFP */</span></span>
<span class="line"><span>void HAL_UARTEx_RxEventCallback(UART_HandleTypeDef *huart, uint16_t Size);</span></span>
<span class="line"><span>/* USER CODE END PFP */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/* Private user code ---------------------------------------------------------*/</span></span>
<span class="line"><span>/* USER CODE BEGIN 0 */</span></span>
<span class="line"><span>#define AIWB2TYPE 0</span><span> //0表示接收端，和上位机直连</span></span>
<span class="line"><span>#define RemaxLen 200</span><span> //0表示接收端，和上位机直连</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//串口空闲中断接收</span></span>
<span class="line"><span>uint8_t my_uart1_redatas[RemaxLen];</span></span>
<span class="line"><span>unsigned int my_uart1_indx;</span></span>
<span class="line"><span>unsigned char my_uart1_rxflag;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>uint8_t my_uart2_redatas[RemaxLen];</span></span>
<span class="line"><span>unsigned int my_uart2_indx;</span></span>
<span class="line"><span>unsigned char my_uart2_rxflag;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>uint8_t my_uart3_redatas[RemaxLen];</span></span>
<span class="line"><span>unsigned int my_uart3_indx;</span></span>
<span class="line"><span>unsigned char my_uart3_rxflag;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>void HAL_UARTEx_RxEventCallback(UART_HandleTypeDef *huart, uint16_t Size)  //接收回调函数，用于处理空闲中断以及重新开启中断</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	if(huart == &amp;huart1){</span></span>
<span class="line"><span>		my_uart1_indx = Size;</span></span>
<span class="line"><span>		HAL_UARTEx_ReceiveToIdle_IT(huart, my_uart1_redatas, RemaxLen);</span></span>
<span class="line"><span>		my_uart1_rxflag = 1;</span></span>
<span class="line"><span>	}else if(huart == &amp;huart2){</span></span>
<span class="line"><span>		my_uart2_indx = Size;</span></span>
<span class="line"><span>		HAL_UARTEx_ReceiveToIdle_IT(huart, my_uart2_redatas, RemaxLen);</span></span>
<span class="line"><span>		my_uart2_rxflag = 1;</span></span>
<span class="line"><span>	}else if(huart == &amp;huart3){</span></span>
<span class="line"><span>		my_uart3_indx = Size;</span></span>
<span class="line"><span>		HAL_UARTEx_ReceiveToIdle_IT(huart, my_uart3_redatas, RemaxLen);</span></span>
<span class="line"><span>		my_uart3_rxflag = 1;</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>/* USER CODE END 0 */</span></span></code></pre></div><p>完整main：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/* USER CODE BEGIN Header */</span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span>  ******************************************************************************</span></span>
<span class="line"><span>  * @file           : main.c</span></span>
<span class="line"><span>  * @brief          : Main program body</span></span>
<span class="line"><span>  ******************************************************************************</span></span>
<span class="line"><span>  * @attention</span></span>
<span class="line"><span>  *</span></span>
<span class="line"><span>  * Copyright (c) 2025 STMicroelectronics.</span></span>
<span class="line"><span>  * All rights reserved.</span></span>
<span class="line"><span>  *</span></span>
<span class="line"><span>  * This software is licensed under terms that can be found in the LICENSE file</span></span>
<span class="line"><span>  * in the root directory of this software component.</span></span>
<span class="line"><span>  * If no LICENSE file comes with this software, it is provided AS-IS.</span></span>
<span class="line"><span>  *</span></span>
<span class="line"><span>  ******************************************************************************</span></span>
<span class="line"><span>  */</span></span>
<span class="line"><span>/* USER CODE END Header */</span></span>
<span class="line"><span>/* Includes ------------------------------------------------------------------*/</span></span>
<span class="line"><span>#include &quot;main.h&quot;</span></span>
<span class="line"><span>#include &quot;usart.h&quot;</span></span>
<span class="line"><span>#include &quot;gpio.h&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/* Private includes ----------------------------------------------------------*/</span></span>
<span class="line"><span>/* USER CODE BEGIN Includes */</span></span>
<span class="line"><span>#include &quot;stdio.h&quot;</span></span>
<span class="line"><span>#include &quot;string.h&quot;</span></span>
<span class="line"><span>/* USER CODE END Includes */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/* Private typedef -----------------------------------------------------------*/</span></span>
<span class="line"><span>/* USER CODE BEGIN PTD */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/* USER CODE END PTD */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/* Private define ------------------------------------------------------------*/</span></span>
<span class="line"><span>/* USER CODE BEGIN PD */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/* USER CODE END PD */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/* Private macro -------------------------------------------------------------*/</span></span>
<span class="line"><span>/* USER CODE BEGIN PM */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/* USER CODE END PM */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/* Private variables ---------------------------------------------------------*/</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/* USER CODE BEGIN PV */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/* USER CODE END PV */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/* Private function prototypes -----------------------------------------------*/</span></span>
<span class="line"><span>void SystemClock_Config(void);</span></span>
<span class="line"><span>/* USER CODE BEGIN PFP */</span></span>
<span class="line"><span>void HAL_UARTEx_RxEventCallback(UART_HandleTypeDef *huart, uint16_t Size);</span></span>
<span class="line"><span>/* USER CODE END PFP */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/* Private user code ---------------------------------------------------------*/</span></span>
<span class="line"><span>/* USER CODE BEGIN 0 */</span></span>
<span class="line"><span>#define AIWB2TYPE 0</span><span> //0表示接收端，和上位机直连</span></span>
<span class="line"><span>#define RemaxLen 200</span><span> //0表示接收端，和上位机直连</span></span>
<span class="line"><span>////串口收到数据回调</span></span>
<span class="line"><span>////uart1用于连接typeA和mcu</span></span>
<span class="line"><span>////uart2用于连接飞控和mcu</span></span>
<span class="line"><span>////uart3用于连接aiwb2和mcu</span></span>
<span class="line"><span>//uint8_t my_uart1_redata[128]=0;</span></span>
<span class="line"><span>//uint8_t my_uart2_redata[128]=0;</span></span>
<span class="line"><span>//uint8_t my_uart3_redata[128]=0;</span></span>
<span class="line"><span>//void HAL_UART_RxCpltCallback(UART_HandleTypeDef *huart) {</span></span>
<span class="line"><span>//	if(AIWB2TYPE==0){</span><span>  //接收端设备 只使用uart3、uart1</span></span>
<span class="line"><span>//		/*</span></span>
<span class="line"><span>//		 * 1、Aiwb2（uart3 Receive）传给mcu的数据原封不动地传给typeA（uart1 Transmit），让上位机可以看到</span></span>
<span class="line"><span>//		 * 2、typeA（uart1 Receive）传给mcu的数据原封不动的传给aiwb2（uart3 Transmit）, 让aiwb2能接收到</span></span>
<span class="line"><span>//		 */</span></span>
<span class="line"><span>//		if(huart == &amp;huart1) {</span><span>	//判断串口号</span></span>
<span class="line"><span>//			HAL_UART_Transmit_IT(&amp;huart1,&amp;my_uart1_redata,1);//把接收到的数据通过串口发送</span></span>
<span class="line"><span>//			HAL_UART_Transmit_IT(&amp;huart3,&amp;my_uart1_redata,1);//把接收到的数据通过串口发送</span></span>
<span class="line"><span>//			HAL_UART_Receive_IT(&amp;huart1,&amp;my_uart1_redata,1);</span><span> //再次开启一次中断</span></span>
<span class="line"><span>//		}</span></span>
<span class="line"><span>//		if(huart == &amp;huart3) {</span><span>	//aiwb2</span></span>
<span class="line"><span>//			HAL_UART_Transmit_IT(&amp;huart1,&amp;my_uart3_redata,1);//把接收到的数据通过串口发送</span></span>
<span class="line"><span>//			HAL_UART_Receive_IT(&amp;huart3,&amp;my_uart3_redata,1);</span><span> //再次开启一次中断</span></span>
<span class="line"><span>//		}</span></span>
<span class="line"><span>//	}else if(AIWB2TYPE==1){</span><span>   //发送端设备</span></span>
<span class="line"><span>//</span></span>
<span class="line"><span>//	}</span></span>
<span class="line"><span>//</span></span>
<span class="line"><span>//}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//串口空闲中断接收</span></span>
<span class="line"><span>uint8_t my_uart1_redatas[RemaxLen];</span></span>
<span class="line"><span>unsigned int my_uart1_indx;</span></span>
<span class="line"><span>unsigned char my_uart1_rxflag;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>uint8_t my_uart2_redatas[RemaxLen];</span></span>
<span class="line"><span>unsigned int my_uart2_indx;</span></span>
<span class="line"><span>unsigned char my_uart2_rxflag;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>uint8_t my_uart3_redatas[RemaxLen];</span></span>
<span class="line"><span>unsigned int my_uart3_indx;</span></span>
<span class="line"><span>unsigned char my_uart3_rxflag;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>void HAL_UARTEx_RxEventCallback(UART_HandleTypeDef *huart, uint16_t Size)  //接收回调函数，用于处理空闲中断以及重新开启中断</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	if(huart == &amp;huart1){</span></span>
<span class="line"><span>		my_uart1_indx = Size;</span></span>
<span class="line"><span>		HAL_UARTEx_ReceiveToIdle_IT(huart, my_uart1_redatas, RemaxLen);</span></span>
<span class="line"><span>		my_uart1_rxflag = 1;</span></span>
<span class="line"><span>	}else if(huart == &amp;huart2){</span></span>
<span class="line"><span>		my_uart2_indx = Size;</span></span>
<span class="line"><span>		HAL_UARTEx_ReceiveToIdle_IT(huart, my_uart2_redatas, RemaxLen);</span></span>
<span class="line"><span>		my_uart2_rxflag = 1;</span></span>
<span class="line"><span>	}else if(huart == &amp;huart3){</span></span>
<span class="line"><span>		my_uart3_indx = Size;</span></span>
<span class="line"><span>		HAL_UARTEx_ReceiveToIdle_IT(huart, my_uart3_redatas, RemaxLen);</span></span>
<span class="line"><span>		my_uart3_rxflag = 1;</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>/* USER CODE END 0 */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span>  * @brief  The application entry point.</span></span>
<span class="line"><span>  * @retval int</span></span>
<span class="line"><span>  */</span></span>
<span class="line"><span>int main(void)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  /* USER CODE BEGIN 1 */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  /* USER CODE END 1 */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  /* MCU Configuration--------------------------------------------------------*/</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  /* Reset of all peripherals, Initializes the Flash interface and the Systick. */</span></span>
<span class="line"><span>  HAL_Init();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  /* USER CODE BEGIN Init */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  /* USER CODE END Init */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  /* Configure the system clock */</span></span>
<span class="line"><span>  SystemClock_Config();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  /* USER CODE BEGIN SysInit */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  /* USER CODE END SysInit */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  /* Initialize all configured peripherals */</span></span>
<span class="line"><span>  MX_GPIO_Init();</span></span>
<span class="line"><span>  MX_USART1_UART_Init();</span></span>
<span class="line"><span>  MX_USART2_UART_Init();</span></span>
<span class="line"><span>  MX_USART3_UART_Init();</span></span>
<span class="line"><span>  /* USER CODE BEGIN 2 */</span></span>
<span class="line"><span>  //开启uart1-3的接收中断</span></span>
<span class="line"><span>//    HAL_UART_Receive_IT(&amp;huart1,&amp;my_uart1_redata,1);</span><span> //再次开启一次中断</span></span>
<span class="line"><span>//</span></span>
<span class="line"><span>//    HAL_UART_Receive_IT(&amp;huart3,&amp;my_uart3_redata,1);</span><span> //再次开启一次中断</span></span>
<span class="line"><span>  HAL_UARTEx_ReceiveToIdle_IT(&amp;huart1, my_uart1_redatas, RemaxLen);</span></span>
<span class="line"><span>  HAL_UARTEx_ReceiveToIdle_IT(&amp;huart2, my_uart2_redatas, RemaxLen);</span></span>
<span class="line"><span>  HAL_UARTEx_ReceiveToIdle_IT(&amp;huart3, my_uart3_redatas, RemaxLen);</span></span>
<span class="line"><span>  /* USER CODE END 2 */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  /* Infinite loop */</span></span>
<span class="line"><span>  /* USER CODE BEGIN WHILE */</span></span>
<span class="line"><span>  while (1)</span></span>
<span class="line"><span>  {</span></span>
<span class="line"><span>    /* USER CODE END WHILE */</span></span>
<span class="line"><span>	  //空闲中断溢出</span></span>
<span class="line"><span>	  if(my_uart1_rxflag == 1)</span></span>
<span class="line"><span>	  {</span></span>
<span class="line"><span>		  my_uart1_rxflag = 0;</span></span>
<span class="line"><span>//		  HAL_UART_Transmit(&amp;huart1, my_uart1_redatas, my_uart1_indx, 0xff);</span></span>
<span class="line"><span>		  HAL_UART_Transmit(&amp;huart3, my_uart1_redatas, my_uart1_indx, 0xff);</span></span>
<span class="line"><span>		  memset(my_uart1_redatas, 0 ,RemaxLen);</span></span>
<span class="line"><span>	  }</span></span>
<span class="line"><span>	  if(my_uart2_rxflag == 1)</span></span>
<span class="line"><span>	  {</span></span>
<span class="line"><span>		  my_uart2_rxflag = 0;</span></span>
<span class="line"><span>		  HAL_UART_Transmit(&amp;huart2, my_uart2_redatas, my_uart2_indx, 0xff);</span></span>
<span class="line"><span>		  memset(my_uart2_redatas, 0 ,RemaxLen);</span></span>
<span class="line"><span>	  }</span></span>
<span class="line"><span>	  if(my_uart3_rxflag == 1)</span></span>
<span class="line"><span>	  {</span></span>
<span class="line"><span>		  my_uart3_rxflag = 0;</span></span>
<span class="line"><span>//		  HAL_UART_Transmit(&amp;huart3, my_uart3_redatas, my_uart3_indx, 0xff);</span></span>
<span class="line"><span>		  HAL_UART_Transmit(&amp;huart1, my_uart3_redatas, my_uart3_indx, 0xff);</span></span>
<span class="line"><span>		  memset(my_uart3_redatas, 0 ,RemaxLen);</span></span>
<span class="line"><span>	  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /* USER CODE BEGIN 3 */</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  /* USER CODE END 3 */</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span>  * @brief System Clock Configuration</span></span>
<span class="line"><span>  * @retval None</span></span>
<span class="line"><span>  */</span></span>
<span class="line"><span>void SystemClock_Config(void)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  RCC_OscInitTypeDef RCC_OscInitStruct = {0};</span></span>
<span class="line"><span>  RCC_ClkInitTypeDef RCC_ClkInitStruct = {0};</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  /** Initializes the RCC Oscillators according to the specified parameters</span></span>
<span class="line"><span>  * in the RCC_OscInitTypeDef structure.</span></span>
<span class="line"><span>  */</span></span>
<span class="line"><span>  RCC_OscInitStruct.OscillatorType = RCC_OSCILLATORTYPE_HSE;</span></span>
<span class="line"><span>  RCC_OscInitStruct.HSEState = RCC_HSE_ON;</span></span>
<span class="line"><span>  RCC_OscInitStruct.HSEPredivValue = RCC_HSE_PREDIV_DIV1;</span></span>
<span class="line"><span>  RCC_OscInitStruct.HSIState = RCC_HSI_ON;</span></span>
<span class="line"><span>  RCC_OscInitStruct.PLL.PLLState = RCC_PLL_ON;</span></span>
<span class="line"><span>  RCC_OscInitStruct.PLL.PLLSource = RCC_PLLSOURCE_HSE;</span></span>
<span class="line"><span>  RCC_OscInitStruct.PLL.PLLMUL = RCC_PLL_MUL9;</span></span>
<span class="line"><span>  if (HAL_RCC_OscConfig(&amp;RCC_OscInitStruct) != HAL_OK)</span></span>
<span class="line"><span>  {</span></span>
<span class="line"><span>    Error_Handler();</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  /** Initializes the CPU, AHB and APB buses clocks</span></span>
<span class="line"><span>  */</span></span>
<span class="line"><span>  RCC_ClkInitStruct.ClockType = RCC_CLOCKTYPE_HCLK|RCC_CLOCKTYPE_SYSCLK</span></span>
<span class="line"><span>                              |RCC_CLOCKTYPE_PCLK1|RCC_CLOCKTYPE_PCLK2;</span></span>
<span class="line"><span>  RCC_ClkInitStruct.SYSCLKSource = RCC_SYSCLKSOURCE_PLLCLK;</span></span>
<span class="line"><span>  RCC_ClkInitStruct.AHBCLKDivider = RCC_SYSCLK_DIV1;</span></span>
<span class="line"><span>  RCC_ClkInitStruct.APB1CLKDivider = RCC_HCLK_DIV2;</span></span>
<span class="line"><span>  RCC_ClkInitStruct.APB2CLKDivider = RCC_HCLK_DIV1;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  if (HAL_RCC_ClockConfig(&amp;RCC_ClkInitStruct, FLASH_LATENCY_2) != HAL_OK)</span></span>
<span class="line"><span>  {</span></span>
<span class="line"><span>    Error_Handler();</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/* USER CODE BEGIN 4 */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/* USER CODE END 4 */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span>  * @brief  This function is executed in case of error occurrence.</span></span>
<span class="line"><span>  * @retval None</span></span>
<span class="line"><span>  */</span></span>
<span class="line"><span>void Error_Handler(void)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  /* USER CODE BEGIN Error_Handler_Debug */</span></span>
<span class="line"><span>  /* User can add his own implementation to report the HAL error return state */</span></span>
<span class="line"><span>  __disable_irq();</span></span>
<span class="line"><span>  while (1)</span></span>
<span class="line"><span>  {</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  /* USER CODE END Error_Handler_Debug */</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>#ifdef USE_FULL_ASSERT</span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span>  * @brief  Reports the name of the source file and the source line number</span></span>
<span class="line"><span>  *         where the assert_param error has occurred.</span></span>
<span class="line"><span>  * @param  file: pointer to the source file name</span></span>
<span class="line"><span>  * @param  line: assert_param error line source number</span></span>
<span class="line"><span>  * @retval None</span></span>
<span class="line"><span>  */</span></span>
<span class="line"><span>void assert_failed(uint8_t *file, uint32_t line)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  /* USER CODE BEGIN 6 */</span></span>
<span class="line"><span>  /* User can add his own implementation to report the file name and line number,</span></span>
<span class="line"><span>     ex: printf(&quot;Wrong parameters value: file %s on line %d\r\n&quot;, file, line) */</span></span>
<span class="line"><span>  /* USER CODE END 6 */</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>#endif /* USE_FULL_ASSERT */</span></span></code></pre></div><h3 id="字符串格式化" tabindex="-1">字符串格式化 <a class="header-anchor" href="#字符串格式化" aria-label="Permalink to &quot;字符串格式化&quot;">​</a></h3><p>导包</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#include &lt;stdio.h&gt;</span></span>
<span class="line"><span>#include &lt;string.h&gt;</span></span></code></pre></div><h4 id="sscanf字符串格式化提取" tabindex="-1">sscanf字符串格式化提取 <a class="header-anchor" href="#sscanf字符串格式化提取" aria-label="Permalink to &quot;sscanf字符串格式化提取&quot;">​</a></h4><ul><li>从给定的字符串中提取 @后面的字符串和=后面的浮点数，忽略$之后的所有内容</li></ul><p>非函数版</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#include &lt;stdio.h&gt;</span></span>
<span class="line"><span>#include &lt;string.h&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>int main() {</span></span>
<span class="line"><span>    char input[] = &quot;@nihao=1.2345$111&quot;;</span></span>
<span class="line"><span>    char str[100];</span></span>
<span class="line"><span>    float num;</span></span>
<span class="line"><span>    //</span></span>
<span class="line"><span>    // 使用 sscanf 来提取 @后面的字符串和=后面的浮点数</span></span>
<span class="line"><span>    if (sscanf(input, &quot;@%[^=]=%f$&quot;, str, &amp;num) == 2) {</span></span>
<span class="line"><span>        // %[^=]表示读取&#39;=&#39;之前的所有字符作为字符串</span></span>
<span class="line"><span>        // %f表示读取浮点数</span></span>
<span class="line"><span>        printf(&quot;字符串: %s\n&quot;, str);</span></span>
<span class="line"><span>        printf(&quot;浮点数: %f\n&quot;, num);</span></span>
<span class="line"><span>    } else {</span></span>
<span class="line"><span>        printf(&quot;解析失败\n&quot;);</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    return 0;</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>函数版</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#include &lt;stdio.h&gt;</span></span>
<span class="line"><span>#include &lt;string.h&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 函数：从给定的字符串中提取 @后面的字符串和=后面的浮点数</span></span>
<span class="line"><span>int extract_string_and_float(const char *input, char *str, float *num) {</span></span>
<span class="line"><span>    // 使用 sscanf 来提取 @后面的字符串和=后面的浮点数</span></span>
<span class="line"><span>    return sscanf(input, &quot;@%[^=]=%f$&quot;, str, num);</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>int main() {</span></span>
<span class="line"><span>    char input[] = &quot;@nihao=1.2345$111&quot;;  // 输入字符串</span></span>
<span class="line"><span>    char str[100];  // 用于保存提取的字符串</span></span>
<span class="line"><span>    float num;  // 用于保存提取的浮点数</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    // 调用提取函数</span></span>
<span class="line"><span>    if (extract_string_and_float(input, str, &amp;num) == 2) {</span></span>
<span class="line"><span>        // 如果解析成功</span></span>
<span class="line"><span>        printf(&quot;字符串: %s\n&quot;, str);</span></span>
<span class="line"><span>        printf(&quot;浮点数: %f\n&quot;, num);</span></span>
<span class="line"><span>    } else {</span></span>
<span class="line"><span>        // 如果解析失败</span></span>
<span class="line"><span>        printf(&quot;解析失败\n&quot;);</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>    return 0;</span></span>
<span class="line"><span>}</span></span></code></pre></div><h4 id="格式化输出" tabindex="-1">格式化输出 <a class="header-anchor" href="#格式化输出" aria-label="Permalink to &quot;格式化输出&quot;">​</a></h4><ul><li>char,int,float</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#include &lt;stdio.h&gt;</span></span>
<span class="line"><span>#include &lt;string.h&gt;</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>int a = 123;</span></span>
<span class="line"><span>    float b = 3.14159;</span></span>
<span class="line"><span>    char c = &#39;X&#39;;</span></span>
<span class="line"><span>    char str[] = &quot;Hello, World!&quot;;</span></span>
<span class="line"><span>    // 定义一个足够大的字符数组来保存格式化后的字符串</span></span>
<span class="line"><span>    char output[100];</span></span>
<span class="line"><span>    // 使用sprintf将格式化结果存储到output数组</span></span>
<span class="line"><span>    sprintf(output, &quot;Integer: %d\nFloat: %.2f\nCharacter: %c\nString: %s\n&quot;, a, b, c, str);</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>sprintf(message,&quot;temp2=%d&quot;,temp2);</span></span>
<span class="line"><span>HAL_UART_Transmit(&amp;huart1, (uint8_t*)message, strlen(message),100);</span></span></code></pre></div><ul><li>short (%d)</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>// 获取E1计数值并打印为整数</span></span>
<span class="line"><span>sprintf(message, &quot;SPEED:%d&quot;, Get_SPEED_E1());  // 使用 %d 格式符打印整数</span></span>
<span class="line"><span>HAL_UART_Transmit(&amp;huart1, (uint8_t*)message, strlen(message), 100);</span></span></code></pre></div><h4 id="格式化输入" tabindex="-1">格式化输入 <a class="header-anchor" href="#格式化输入" aria-label="Permalink to &quot;格式化输入&quot;">​</a></h4><h4 id="报错" tabindex="-1">报错 <a class="header-anchor" href="#报错" aria-label="Permalink to &quot;报错&quot;">​</a></h4><h5 id="浮点数报错" tabindex="-1">浮点数报错 <a class="header-anchor" href="#浮点数报错" aria-label="Permalink to &quot;浮点数报错&quot;">​</a></h5><blockquote><p>The float formatting support is not enabled, check your MCU Settings from &quot;Project Properties &gt; C/C++ Build &gt; Settings &gt; Tool Settings&quot;, or add manually &quot;-u _scanf_float&quot; in linker flags.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>打开STM32CubeIDE，并导航到你的项目。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>在项目资源管理器中选择你的项目，右键单击并选择&quot;Properties&quot;（属性）。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>在弹出的对话框中，选择&quot;C/C++ Build&quot;（C/C++构建）。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>展开&quot;C/C++ Build&quot;并选择&quot;Settings&quot;（设置）。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>在左侧的列表中选择&quot;Tool Settings&quot;（工具设置）。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>在右侧的选项卡中选择&quot;MCU Settings&quot;（MCU设置）。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>勾选Use float with printf from newlib-nano (-u printf float)。</span></span></code></pre></div><img src="/XIAOHUANG_BLOG/assets/image-20250204151253803_1.CZj3DSRU.png" alt="image-20250204151253803" style="zoom:50%;"><img src="/XIAOHUANG_BLOG/assets/image-20250204151221613_1.CJUGr8w1.png" alt="image-20250204151221613" style="zoom:33%;"></blockquote><h5 id="重定义" tabindex="-1">重定义 <a class="header-anchor" href="#重定义" aria-label="Permalink to &quot;重定义&quot;">​</a></h5><p>extern的使用</p><blockquote><p>在头文件 it_redefine.h 中，speed 变量被声明为 extern，但是它同时也被初始化为 0.0f。在 C 中，extern 用于声明外部变量，表示该变量在其他地方定义，不能同时初始化它。你需要在头文件中只声明 extern float speed;，并在源文件中定义并初始化它。</p><p>解决方法：</p><p>在 it_redefine.h 中，删除初始化部分，仅声明 extern float speed; // 只声明，不初始化 在一个源文件（比如 main.c 或 it_redefine.c）中，定义并初始化 speed： float speed = 0.0f; // 在源文件中定义并初始化</p></blockquote><p>变量既要在.h中带extern声明，也要在.c中再实现</p><blockquote><p>关于 rx_buffer 的未定义引用错误 编译器提示找不到 rx_buffer 变量的定义。根据你的错误，rx_buffer 被在 it_redefine.h 和 main.c 中使用，但是没有定义。你需要确保 rx_buffer 是在一个源文件中定义的，而在头文件中声明为 extern。</p><p>解决方法：在 it_redefine.h 中声明 extern：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>extern char rx_buffer[BUFFER_SIZE];  // 声明 rx_buffer 为外部变量</span></span></code></pre></div><p>在某个源文件（例如 main.c 或 it_redefine.c）中定义它：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>char rx_buffer[BUFFER_SIZE];  // 在源文件中定义 rx_buffer</span></span></code></pre></div></blockquote><h3 id="usart" tabindex="-1">USART <a class="header-anchor" href="#usart" aria-label="Permalink to &quot;USART&quot;">​</a></h3><p>单片机课程中使用的是USART3,技术手册是USART3(PB10/11 和 PC10/11)</p><p>选择connectivity后就会自动选中对应的引脚</p><img src="/XIAOHUANG_BLOG/assets/image-20241210010928914_1.CLPoDR8m.png" alt="image-20241210010928914" style="zoom:50%;"><h4 id="串口阻塞" tabindex="-1">串口阻塞 <a class="header-anchor" href="#串口阻塞" aria-label="Permalink to &quot;串口阻塞&quot;">​</a></h4><p>使用strlen()时要</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#include &lt;string.h&gt;</span></span></code></pre></div><p>学校的学习板中要在usart中选取cts/rts，有点问题要改</p><p>最大超时时间</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>HAL_MAX_DELAY</span></span></code></pre></div><p>发送</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>MX_USART3_UART_Init();</span></span>
<span class="line"><span>  /* USER CODE BEGIN 2 */</span></span>
<span class="line"><span>  /* USER CODE END 2 */</span></span>
<span class="line"><span>  /* Infinite loop */</span></span>
<span class="line"><span>  /* USER CODE BEGIN WHILE */</span></span>
<span class="line"><span>  char message[]=&quot;Hello World&quot;;//要发送的数据</span></span>
<span class="line"><span>  int numbers[3]={10,20,100};</span></span>
<span class="line"><span>  while (1)</span></span>
<span class="line"><span>  {</span></span>
<span class="line"><span>	  //通过串口发送数据，使用tx对应的线要取地址-&amp;、发送的信息、长度、最长等待时间ms</span></span>
<span class="line"><span>	  //message和指定输入虽然都是8位的，最好可以强转一下message-&gt;(uint8_t*)huart3</span></span>
<span class="line"><span>	  HAL_UART_Transmit(&amp;huart3, (uint8_t*)message, strlen(message), 100);</span></span>
<span class="line"><span>	  //等待，实现每秒发送一次</span></span>
<span class="line"><span>	  HAL_Delay(1000);</span></span>
<span class="line"><span>    /* USER CODE END WHILE */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /* USER CODE BEGIN 3 */</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  /* USER CODE END 3 */</span></span></code></pre></div><p>读取并复制发送</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>	  //串口收发信息</span></span>
<span class="line"><span>	  HAL_UART_Receive(&amp;huart1, (uint8_t*)message, 20, HAL_MAX_DELAY);</span></span>
<span class="line"><span>	  //发</span></span>
<span class="line"><span>	  HAL_UART_Transmit(&amp;huart1, (uint8_t*)message, strlen(message), 100);</span></span></code></pre></div><h4 id="中断中使用串口" tabindex="-1">中断中使用串口 <a class="header-anchor" href="#中断中使用串口" aria-label="Permalink to &quot;中断中使用串口&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#include &quot;usart.h&quot;</span></span></code></pre></div><h4 id="串口接收数据触发中断" tabindex="-1">串口接收数据触发中断 <a class="header-anchor" href="#串口接收数据触发中断" aria-label="Permalink to &quot;串口接收数据触发中断&quot;">​</a></h4><p>在串口中断中接收上位机发来的&quot;setspeed=100.2&quot;,提取出100.2放在一个变量中</p><img src="/XIAOHUANG_BLOG/assets/image-20250204024137078_1.CEicVLQw.png" alt="image-20250204024137078" style="zoom:50%;"><h3 id="uart" tabindex="-1">UART <a class="header-anchor" href="#uart" aria-label="Permalink to &quot;UART&quot;">​</a></h3><p>串口中断回调函数：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>HAL_UART_IRQHandler(UART_HandleTypeDef *huart); //串口中断处理函数</span></span>
<span class="line"><span></span></span>
<span class="line"><span>HAL_UART_TxCpltCallback(UART_HandleTypeDef *huart); //发送中断回调函数</span></span>
<span class="line"><span></span></span>
<span class="line"><span>HAL_UART_RxCpltCallback(UART_HandleTypeDef *huart); //接收中断回调函数</span></span></code></pre></div><h3 id="串口中断和空闲中断进行不定长数据接收" tabindex="-1">串口中断和空闲中断进行不定长数据接收 <a class="header-anchor" href="#串口中断和空闲中断进行不定长数据接收" aria-label="Permalink to &quot;串口中断和空闲中断进行不定长数据接收&quot;">​</a></h3><p><a href="https://blog.csdn.net/weixin_44481398/article/details/134894292?ops_request_misc=%7B%22request%5Fid%22%3A%223ba30b37e8b39c4cdddb218adfc38802%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fall.%22%7D&amp;request_id=3ba30b37e8b39c4cdddb218adfc38802&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-2-134894292-null-null.142%5Ev102%5Epc_search_result_base3&amp;utm_term=cubeide%E4%B8%B2%E5%8F%A3%E4%B8%8D%E5%AE%9A%E9%95%BF%E6%8E%A5%E6%94%B6&amp;spm=1018.2226.3001.4187" target="_blank" rel="noreferrer">STM32CubeIDE串口空闲中断实现不定长数据接收_空闲中断 uart 不定长度-CSDN博客</a></p><ul><li><p>配置串口打开中断有两条指令，可以将这两条指令放在： static void MX_USART1_UART_Init(void)下面</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/* USER CODE BEGIN USART1_Init 2 */</span></span>
<span class="line"><span>  __HAL_UART_ENABLE_IT(&amp;huart1, UART_IT_RXNE);//接收中断</span></span>
<span class="line"><span>  __HAL_UART_ENABLE_IT(&amp;huart1, UART_IT_IDLE);//空闲中断</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  /* USER CODE END USART1_Init 2 */</span></span></code></pre></div></li><li><p>中断程序</p><p>在stm32f0xx_it.c文件下找到void USART1_IRQHandler(void)，在其中的用户代码段中添加：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/* USER CODE BEGIN USART1_IRQn 0 */</span></span>
<span class="line"><span>	//接收中断</span></span>
<span class="line"><span>		uint8_t rxData = 0;</span></span>
<span class="line"><span>		if(__HAL_UART_GET_FLAG(&amp;huart1, UART_FLAG_RXNE) != RESET)</span></span>
<span class="line"><span>		{</span></span>
<span class="line"><span>			HAL_UART_Receive(&amp;huart1, &amp;rxData, 1, 1000);</span></span>
<span class="line"><span>			if(Cnt &lt; 256)</span></span>
<span class="line"><span>			{</span></span>
<span class="line"><span>				rx_buff[Cnt] = rxData;</span></span>
<span class="line"><span>				Cnt++;</span></span>
<span class="line"><span>			}</span></span>
<span class="line"><span>			__HAL_UART_CLEAR_FLAG(&amp;huart1, UART_FLAG_RXNE);</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>		// 空闲中断</span></span>
<span class="line"><span>		if(__HAL_UART_GET_FLAG(&amp;huart1, UART_FLAG_IDLE) != RESET)</span></span>
<span class="line"><span>		{</span></span>
<span class="line"><span>			//一帧数据接收完成</span></span>
<span class="line"><span>			USART1_IdleCallback(rx_buff, Cnt);</span></span>
<span class="line"><span>			Cnt = 0;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>			__HAL_UART_CLEAR_IDLEFLAG(&amp;huart1);</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  /* USER CODE END USART1_IRQn 0 */</span></span>
<span class="line"><span>  // 此处是原来已经有的程序，保留：</span></span>
<span class="line"><span>  HAL_UART_IRQHandler(&amp;huart1);</span></span></code></pre></div></li><li><p>接着在这一部分的程序下面添加回调函数：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/* USER CODE BEGIN 1 */</span></span>
<span class="line"><span>//回调函数</span></span>
<span class="line"><span>void USART1_IdleCallback(uint8_t *pData,uint16_t len)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	while(__HAL_UART_GET_FLAG(&amp;huart1,UART_FLAG_TC) != SET);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>	HAL_UART_Transmit(&amp;huart1, pData, len, 1000);</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>/* USER CODE END 1 */</span></span></code></pre></div></li><li><p>这一部分执行将串口输入的数据回显输出到串口。</p></li></ul><img src="/XIAOHUANG_BLOG/assets/image-20250328232801052_1.CgLEVla3.png" alt="image-20250328232801052" style="zoom:33%;"><ul><li>使用@xxx=xx.xxx$命令时则</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span></span></span></code></pre></div><h3 id="串口重定向" tabindex="-1">串口重定向 <a class="header-anchor" href="#串口重定向" aria-label="Permalink to &quot;串口重定向&quot;">​</a></h3><h2 id="安信可ai-wb2-12f" tabindex="-1">安信可ai-wb2-12f <a class="header-anchor" href="#安信可ai-wb2-12f" aria-label="Permalink to &quot;安信可ai-wb2-12f&quot;">​</a></h2><p>教程：<a href="https://aithinker.blog.csdn.net/article/details/125781602" target="_blank" rel="noreferrer">Ai-WB2系列的固件烧录指导_ai-wb2-12f-CSDN博客</a></p><p>资料下载连接：<a href="https://docs.ai-thinker.com/wb2" target="_blank" rel="noreferrer">https://docs.ai-thinker.com/wb2</a></p><p>AT指令： <a href="./stm32f407zgt6_localdata/WB2AT%E6%8C%87%E4%BB%A4%E9%9B%86_1.pdf">WB2AT指令集.pdf</a></p><h3 id="蓝牙" tabindex="-1">蓝牙 <a class="header-anchor" href="#蓝牙" aria-label="Permalink to &quot;蓝牙&quot;">​</a></h3><p>主机</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>AT+RESTORE //恢复出厂设置</span></span>
<span class="line"><span>AT+RST</span></span>
<span class="line"><span>AT+BLENAME?</span></span>
<span class="line"><span>AT+BLENAME=aiwb2_group1_a</span></span>
<span class="line"><span>AT+BLEMODE=1</span></span>
<span class="line"><span>AT+BLERFPWR=15</span></span>
<span class="line"><span>AT+TRANSENTER=1,1</span></span>
<span class="line"><span>AT+BLECONNECT=b4c2e0e7bdba</span></span>
<span class="line"><span>AT+BLEAUTOCON=b4c2e0e7bdba,49535343884143f4a8d4ecbe34729bb3,1  //</span></span>
<span class="line"><span>+++ //退出传输</span></span></code></pre></div><p>从机</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>AT+RESTORE  //恢复出厂设置</span></span>
<span class="line"><span>AT+RST</span></span>
<span class="line"><span>AT+BLENAME=aiwb2_group1_b</span></span>
<span class="line"><span>AT+BLEMODE?</span></span>
<span class="line"><span>AT+BLEMODE=0</span></span>
<span class="line"><span>AT+BLERFPWR=15</span></span>
<span class="line"><span>AT+BLEMAC?  // +BLEMAC:b4c2e0e7bdba</span></span>
<span class="line"><span>AT+BLETXUUID?   // +BLETXUUID:49535343884143f4a8d4ecbe34729bb3</span></span></code></pre></div><img src="/XIAOHUANG_BLOG/assets/image-20250712140953484_1.CEyjZ2Im.png" alt="image-20250712140953484" style="zoom:50%;"><h2 id="i2c" tabindex="-1">I2C <a class="header-anchor" href="#i2c" aria-label="Permalink to &quot;I2C&quot;">​</a></h2><h3 id="软件i2c" tabindex="-1">软件I2C <a class="header-anchor" href="#软件i2c" aria-label="Permalink to &quot;软件I2C&quot;">​</a></h3><h3 id="硬件i2c" tabindex="-1">硬件I2C <a class="header-anchor" href="#硬件i2c" aria-label="Permalink to &quot;硬件I2C&quot;">​</a></h3><h3 id="i2s" tabindex="-1">I2S <a class="header-anchor" href="#i2s" aria-label="Permalink to &quot;I2S&quot;">​</a></h3><p>SerialPlot：</p><h2 id="磁编码器" tabindex="-1">磁编码器 <a class="header-anchor" href="#磁编码器" aria-label="Permalink to &quot;磁编码器&quot;">​</a></h2><h3 id="as5600" tabindex="-1">AS5600 <a class="header-anchor" href="#as5600" aria-label="Permalink to &quot;AS5600&quot;">​</a></h3><p>使用+3v3电压，DIR</p><img src="/XIAOHUANG_BLOG/assets/image-20250527204417482_1.1ZUav90k.png" alt="image-20250527204417482" style="zoom:50%;"><p>参考：[STM32 HAL库 AS5600编码器程序_stm32hal库读取as5600角度-CSDN博客](<a href="https://blog.csdn.net/qq_42580345/article/details/134359158?ops_request_misc=%7B%22request%5Fid%22%3A%221511ff806024efdccd0b685f20f541b6%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=1511ff806024efdccd0b685f20f541b6&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~ElasticSearch~search_v2-1-134359158-null-null.142%5Ev102%5Epc_search_result_base3&amp;utm_term=as5600" target="_blank" rel="noreferrer">https://blog.csdn.net/qq_42580345/article/details/134359158?ops_request_misc={&quot;request_id&quot;%3A&quot;1511ff806024efdccd0b685f20f541b6&quot;%2C&quot;scm&quot;%3A&quot;20140713.130102334..&quot;}&amp;request_id=1511ff806024efdccd0b685f20f541b6&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~ElasticSearch~search_v2-1-134359158-null-null.142^v102^pc_search_result_base3&amp;utm_term=as5600</a> stm32库程序&amp;spm=1018.2226.3001.4187)</p><h2 id="oled" tabindex="-1">OLED <a class="header-anchor" href="#oled" aria-label="Permalink to &quot;OLED&quot;">​</a></h2><img src="/XIAOHUANG_BLOG/assets/image-20250531224134029_1.CCN8Ks4Q.png" alt="image-20250531224134029" style="zoom:50%;"><p>oled.h</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/*</span></span>
<span class="line"><span> * oled.h</span></span>
<span class="line"><span> *</span></span>
<span class="line"><span> *  Created on: Mar 19, 2025</span></span>
<span class="line"><span> *      Author: 27276</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#ifndef SRC_OLED_OLED_H_</span></span>
<span class="line"><span>#define SRC_OLED_OLED_H_</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#include &quot;main.h&quot;</span></span>
<span class="line"><span>#include &quot;oledfont.h&quot;</span></span>
<span class="line"><span>#define I2C_GROUP_OLED hi2c2</span></span>
<span class="line"><span>extern I2C_HandleTypeDef  hi2c2;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>void OLED_WR_CMD(uint8_t cmd);</span></span>
<span class="line"><span>void OLED_WR_DATA(uint8_t data);</span></span>
<span class="line"><span>void OLED_Init(void);</span></span>
<span class="line"><span>void OLED_Clear(void);</span></span>
<span class="line"><span>void OLED_Display_On(void);</span></span>
<span class="line"><span>void OLED_Display_Off(void);</span></span>
<span class="line"><span>void OLED_Set_Pos(uint8_t x, uint8_t y);</span></span>
<span class="line"><span>void OLED_On(void);</span></span>
<span class="line"><span>void OLED_ShowNum(uint8_t x,uint8_t y,unsigned int num,uint8_t len,uint8_t size2,uint8_t Color_Turn);</span></span>
<span class="line"><span>void OLED_Showdecimal(uint8_t x,uint8_t y,float num,uint8_t z_len,uint8_t f_len,uint8_t size2, uint8_t Color_Turn);</span></span>
<span class="line"><span>void OLED_ShowChar(uint8_t x,uint8_t y,uint8_t chr,uint8_t Char_Size,uint8_t Color_Turn);</span></span>
<span class="line"><span>void OLED_ShowString(uint8_t x,uint8_t y,char*chr,uint8_t Char_Size,uint8_t Color_Turn);</span></span>
<span class="line"><span>void OLED_ShowCHinese(uint8_t x,uint8_t y,uint8_t no,uint8_t Color_Turn);</span></span>
<span class="line"><span>void OLED_DrawBMP(uint8_t x0, uint8_t y0, uint8_t x1, uint8_t y1, uint8_t *  BMP,uint8_t Color_Turn);</span></span>
<span class="line"><span>void OLED_HorizontalShift(uint8_t direction);</span></span>
<span class="line"><span>void OLED_Some_HorizontalShift(uint8_t direction,uint8_t start,uint8_t end);</span></span>
<span class="line"><span>void OLED_VerticalAndHorizontalShift(uint8_t direction);</span></span>
<span class="line"><span>void OLED_DisplayMode(uint8_t mode);</span></span>
<span class="line"><span>void OLED_IntensityControl(uint8_t intensity);</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>#endif /* SRC_OLED_OLED_H_ */</span></span></code></pre></div><p>oled.c</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/*</span></span>
<span class="line"><span> * oled.c</span></span>
<span class="line"><span> *</span></span>
<span class="line"><span> *  Created on: 2022年7月24日</span></span>
<span class="line"><span> *      Author: Unicorn_Li</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>#include &quot;oled.h&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/**********************************************************</span></span>
<span class="line"><span> * 初始化命令,根据芯片手册书写，详细步骤见上图以及注意事项</span></span>
<span class="line"><span> ***********************************************************/</span></span>
<span class="line"><span>uint8_t CMD_Data[]={</span></span>
<span class="line"><span>0xAE, 0xD5, 0x80, 0xA8, 0x3F, 0xD3, 0x00, 0x40,0xA1, 0xC8, 0xDA,</span></span>
<span class="line"><span></span></span>
<span class="line"><span>0x12, 0x81, 0xCF, 0xD9, 0xF1, 0xDB, 0x40, 0xA4, 0xA6,0x8D, 0x14,</span></span>
<span class="line"><span></span></span>
<span class="line"><span>0xAF};</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span> * @function: void OLED_Init(void)</span></span>
<span class="line"><span> * @description: OLED初始化</span></span>
<span class="line"><span> * @return {*}</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>void OLED_Init(void)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	HAL_Delay(200);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>	uint8_t i = 0;</span></span>
<span class="line"><span>	for(i=0; i&lt;23; i++)</span></span>
<span class="line"><span>	{</span></span>
<span class="line"><span>		OLED_WR_CMD(CMD_Data[i]);</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span> * @function: void OLED_WR_CMD(uint8_t cmd)</span></span>
<span class="line"><span> * @description: 向设备写控制命令</span></span>
<span class="line"><span> * @param {uint8_t} cmd 芯片手册规定的命令</span></span>
<span class="line"><span> * @return {*}</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>void OLED_WR_CMD(uint8_t cmd)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	HAL_I2C_Mem_Write(&amp;I2C_GROUP_OLED ,0x78,0x00,I2C_MEMADD_SIZE_8BIT,&amp;cmd,1,0x100);</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span> * @function: void OLED_WR_DATA(uint8_t data)</span></span>
<span class="line"><span> * @description: 向设备写控制数据</span></span>
<span class="line"><span> * @param {uint8_t} data 数据</span></span>
<span class="line"><span> * @return {*}</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>void OLED_WR_DATA(uint8_t data)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	HAL_I2C_Mem_Write(&amp;I2C_GROUP_OLED ,0x78,0x40,I2C_MEMADD_SIZE_8BIT,&amp;data,1,0x100);</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span> * @function: void OLED_On(void)</span></span>
<span class="line"><span> * @description: 更新显示</span></span>
<span class="line"><span></span></span>
<span class="line"><span> * @return {*}</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>void OLED_On(void)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	uint8_t i,n;</span></span>
<span class="line"><span>	for(i=0;i&lt;8;i++)</span></span>
<span class="line"><span>	{</span></span>
<span class="line"><span>		OLED_WR_CMD(0xb0+i);    //设置页地址（0~7）</span></span>
<span class="line"><span>		OLED_WR_CMD(0x00);      //设置显示位置—列低地址</span></span>
<span class="line"><span>		OLED_WR_CMD(0x10);      //设置显示位置—列高地址</span></span>
<span class="line"><span>		for(n=0;n&lt;128;n++)</span></span>
<span class="line"><span>			OLED_WR_DATA(1);</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span> * @function: OLED_Clear(void)</span></span>
<span class="line"><span> * @description: 清屏,整个屏幕是黑色的!和没点亮一样!!!</span></span>
<span class="line"><span> * @return {*}</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>void OLED_Clear(void)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	uint8_t i,n;</span></span>
<span class="line"><span>	for(i=0;i&lt;8;i++)</span></span>
<span class="line"><span>	{</span></span>
<span class="line"><span>		OLED_WR_CMD(0xb0+i);    //设置页地址（0~7）</span></span>
<span class="line"><span>		OLED_WR_CMD(0x00);      //设置显示位置—列低地址</span></span>
<span class="line"><span>		OLED_WR_CMD(0x10);      //设置显示位置—列高地址</span></span>
<span class="line"><span>		for(n=0;n&lt;128;n++)</span></span>
<span class="line"><span>			OLED_WR_DATA(0);</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span> * @function: void OLED_Display_On(void)</span></span>
<span class="line"><span> * @description: 开启OLED显示</span></span>
<span class="line"><span> * @return {*}</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>void OLED_Display_On(void)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	OLED_WR_CMD(0X8D);  //SET DCDC命令</span></span>
<span class="line"><span>	OLED_WR_CMD(0X14);  //DCDC ON</span></span>
<span class="line"><span>	OLED_WR_CMD(0XAF);  //DISPLAY ON,打开显示</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span> * @function: void OLED_Display_Off(void)</span></span>
<span class="line"><span> * @description: 关闭OLED显示</span></span>
<span class="line"><span> * @return {*}</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>void OLED_Display_Off(void)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	OLED_WR_CMD(0X8D);  //SET DCDC命令</span></span>
<span class="line"><span>	OLED_WR_CMD(0X10);  //DCDC OFF</span></span>
<span class="line"><span>	OLED_WR_CMD(0XAE);  //DISPLAY OFF，关闭显示</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span> * @function: void OLED_Set_Pos(uint8_t x, uint8_t y)</span></span>
<span class="line"><span> * @description: 坐标设置</span></span>
<span class="line"><span> * @param {uint8_t} x,y</span></span>
<span class="line"><span> * @return {*}</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>void OLED_Set_Pos(uint8_t x, uint8_t y)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	OLED_WR_CMD(0xb0+y);	//设置页地址（0~7）</span></span>
<span class="line"><span>	OLED_WR_CMD(((x&amp;0xf0)&gt;&gt;4)|0x10); //设置显示位置—列高地址</span></span>
<span class="line"><span>	OLED_WR_CMD(x&amp;0x0f);	//设置显示位置—列低地址</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span> * @function: unsigned int oled_pow(uint8_t m,uint8_t n)</span></span>
<span class="line"><span> * @description: m^n函数</span></span>
<span class="line"><span> * @param {uint8_t} m,n</span></span>
<span class="line"><span> * @return {unsigned int} result</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>unsigned int oled_pow(uint8_t m,uint8_t n)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	unsigned int result=1;</span></span>
<span class="line"><span>	while(n--)result*=m;</span></span>
<span class="line"><span>	return result;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span> * @function: void OLED_ShowChar(uint8_t x, uint8_t y, uint8_t chr, uint8_t Char_Size,uint8_t Color_Turn)</span></span>
<span class="line"><span> * @description: 在OLED12864特定位置开始显示一个字符</span></span>
<span class="line"><span> * @param {uint8_t} x字符开始显示的横坐标</span></span>
<span class="line"><span> * @param {uint8_t} y字符开始显示的纵坐标</span></span>
<span class="line"><span> * @param {uint8_t} chr待显示的字符</span></span>
<span class="line"><span> * @param {uint8_t} Char_Size待显示字符的字体大小,选择字体 16/12</span></span>
<span class="line"><span> * @param {uint8_t} Color_Turn是否反相显示(1反相、0不反相)</span></span>
<span class="line"><span> * @return {*}</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>void OLED_ShowChar(uint8_t x,uint8_t y,uint8_t chr,uint8_t Char_Size,uint8_t Color_Turn)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	unsigned char c=0,i=0;</span></span>
<span class="line"><span>		c=chr-&#39; &#39;;//得到偏移后的值</span></span>
<span class="line"><span>		if(x&gt;128-1){x=0;y=y+2;}</span></span>
<span class="line"><span>		if(Char_Size ==16)</span></span>
<span class="line"><span>		{</span></span>
<span class="line"><span>			OLED_Set_Pos(x,y);</span></span>
<span class="line"><span>			for(i=0;i&lt;8;i++)</span></span>
<span class="line"><span>				{</span></span>
<span class="line"><span>				  if(Color_Turn)</span></span>
<span class="line"><span>					  OLED_WR_DATA(~F8X16[c*16+i]);</span></span>
<span class="line"><span>				  else</span></span>
<span class="line"><span>					  OLED_WR_DATA(F8X16[c*16+i]);</span></span>
<span class="line"><span>				}</span></span>
<span class="line"><span>			OLED_Set_Pos(x,y+1);</span></span>
<span class="line"><span>			for(i=0;i&lt;8;i++)</span></span>
<span class="line"><span>			    {</span></span>
<span class="line"><span>				  if(Color_Turn)</span></span>
<span class="line"><span>					  OLED_WR_DATA(~F8X16[c*16+i+8]);</span></span>
<span class="line"><span>				  else</span></span>
<span class="line"><span>					  OLED_WR_DATA(F8X16[c*16+i+8]);</span></span>
<span class="line"><span>			    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>			}</span></span>
<span class="line"><span>	     else</span></span>
<span class="line"><span>	     {</span></span>
<span class="line"><span>				OLED_Set_Pos(x,y);</span></span>
<span class="line"><span>				for(i=0;i&lt;6;i++)</span></span>
<span class="line"><span>			    {</span></span>
<span class="line"><span>				  if(Color_Turn)</span></span>
<span class="line"><span>					  OLED_WR_DATA(~F6x8[c][i]);</span></span>
<span class="line"><span>				  else</span></span>
<span class="line"><span>					  OLED_WR_DATA(F6x8[c][i]);</span></span>
<span class="line"><span>			    }</span></span>
<span class="line"><span>		  }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span> * @function: void OLED_ShowString(uint8_t x, uint8_t y, uint8_t *chr, uint8_tChar_Size, uint8_t Color_Turn)</span></span>
<span class="line"><span> * @description: 在OLED12864特定位置开始显示字符串</span></span>
<span class="line"><span> * @param {uint8_t} x待显示字符串的开始横坐标x:0~127</span></span>
<span class="line"><span> * @param {uint8_t} y待显示字符串的开始纵坐标 y:0~7，若选择字体大小为16，则两行数字之间需要间隔2，若选择字体大小为12，间隔1</span></span>
<span class="line"><span> * @param {uint8_t} *chr待显示的字符串</span></span>
<span class="line"><span> * @param {uint8_t} Char_Size待显示字符串的字体大小,选择字体 16/12，16为8X16，12为6x8</span></span>
<span class="line"><span> * @param {uint8_t} Color_Turn是否反相显示(1反相、0不反相)</span></span>
<span class="line"><span> * @return {*}</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>void OLED_ShowString(uint8_t x,uint8_t y,char*chr,uint8_t Char_Size, uint8_t Color_Turn)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	uint8_t  j=0;</span></span>
<span class="line"><span>	while (chr[j]!=&#39;\0&#39;)</span></span>
<span class="line"><span>	{		OLED_ShowChar(x,y,chr[j],Char_Size, Color_Turn);</span></span>
<span class="line"><span>			if (Char_Size == 12) //6X8的字体列加6，显示下一个字符</span></span>
<span class="line"><span>				x += 6;</span></span>
<span class="line"><span>			else  //8X16的字体列加8，显示下一个字符</span></span>
<span class="line"><span>				x += 8;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>			if (x &gt; 122 &amp;&amp; Char_Size==12) //TextSize6x8如果一行不够显示了，从下一行继续显示</span></span>
<span class="line"><span>			{</span></span>
<span class="line"><span>				x = 0;</span></span>
<span class="line"><span>				y++;</span></span>
<span class="line"><span>			}</span></span>
<span class="line"><span>			if (x &gt; 120 &amp;&amp; Char_Size== 16) //TextSize8x16如果一行不够显示了，从下一行继续显示</span></span>
<span class="line"><span>			{</span></span>
<span class="line"><span>				x = 0;</span></span>
<span class="line"><span>				y++;</span></span>
<span class="line"><span>			}</span></span>
<span class="line"><span>			j++;</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span> * @function: void OLED_ShowNum(uint8_t x,uint8_t y,unsigned int num,uint8_t len,uint8_t size2, Color_Turn)</span></span>
<span class="line"><span> * @description: 显示数字</span></span>
<span class="line"><span> * @param {uint8_t} x待显示的数字起始横坐标,x:0~126</span></span>
<span class="line"><span> * @param {uint8_t} y待显示的数字起始纵坐标, y:0~7，若选择字体大小为16，则两行数字之间需要间隔2，若选择字体大小为12，间隔1</span></span>
<span class="line"><span> * @param {unsigned int} num:输入的数据</span></span>
<span class="line"><span> * @param {uint8_t } len:输入的数据位数</span></span>
<span class="line"><span> * @param {uint8_t} size2:输入的数据大小，选择 16/12，16为8X16，12为6x8</span></span>
<span class="line"><span> * @param {uint8_t} Color_Turn是否反相显示(1反相、0不反相)</span></span>
<span class="line"><span> * @return {*}</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>void OLED_ShowNum(uint8_t x,uint8_t y,unsigned int num,uint8_t len,uint8_t size2, uint8_t Color_Turn)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	uint8_t t,temp;</span></span>
<span class="line"><span>	uint8_t enshow=0;</span></span>
<span class="line"><span>	for(t=0;t&lt;len;t++)</span></span>
<span class="line"><span>	{</span></span>
<span class="line"><span>		temp=(num/oled_pow(10,len-t-1))%10;</span></span>
<span class="line"><span>		if(enshow==0&amp;&amp;t&lt;(len-1))</span></span>
<span class="line"><span>		{</span></span>
<span class="line"><span>			if(temp==0)</span></span>
<span class="line"><span>			{</span></span>
<span class="line"><span>				OLED_ShowChar(x+(size2/2)*t,y,&#39; &#39;,size2, Color_Turn);</span></span>
<span class="line"><span>				continue;</span></span>
<span class="line"><span>			}else enshow=1;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>	 	OLED_ShowChar(x+(size2/2)*t,y,temp+&#39;0&#39;,size2, Color_Turn);</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span> * @function: void OLED_Showdecimal(uint8_t x,uint8_t y,float num,uint8_t z_len,uint8_t f_len,uint8_t size2, uint8_t Color_Turn)</span></span>
<span class="line"><span> * @description: 显示正负浮点数</span></span>
<span class="line"><span> * @param {uint8_t} x待显示的数字起始横坐标,x:0~126</span></span>
<span class="line"><span> * @param {uint8_t} y待显示的数字起始纵坐标, y:0~7，若选择字体大小为16，则两行数字之间需要间隔2，若选择字体大小为12，间隔1</span></span>
<span class="line"><span> * @param {float} num:输入的浮点型数据</span></span>
<span class="line"><span> * @param {uint8_t } z_ len:整数部分的位数</span></span>
<span class="line"><span> * @param {uint8_t } f_len: 小数部分的位数</span></span>
<span class="line"><span> * @param {uint8_t} size2:输入的数据大小，选择 16/12，16为8X16，12为6x8</span></span>
<span class="line"><span> * @param {uint8_t} Color_Turn是否反相显示(1反相、0不反相)</span></span>
<span class="line"><span> * @return {*}</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>void OLED_Showdecimal(uint8_t x,uint8_t y,float num,uint8_t z_len,uint8_t f_len,uint8_t size2, uint8_t Color_Turn)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	uint8_t t,temp,i=0;//i为负数标志位</span></span>
<span class="line"><span>	uint8_t enshow;</span></span>
<span class="line"><span>	int z_temp,f_temp;</span></span>
<span class="line"><span>	if(num&lt;0)</span></span>
<span class="line"><span>	{</span></span>
<span class="line"><span>		z_len+=1;</span></span>
<span class="line"><span>		i=1;</span></span>
<span class="line"><span>		num=-num;</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>	z_temp=(int)num;</span></span>
<span class="line"><span>	//整数部分</span></span>
<span class="line"><span>	for(t=0;t&lt;z_len;t++)</span></span>
<span class="line"><span>	{</span></span>
<span class="line"><span>		temp=(z_temp/oled_pow(10,z_len-t-1))%10;</span></span>
<span class="line"><span>		if(enshow==0 &amp;&amp; t&lt;(z_len-1))</span></span>
<span class="line"><span>		{</span></span>
<span class="line"><span>			if(temp==0)</span></span>
<span class="line"><span>			{</span></span>
<span class="line"><span>				OLED_ShowChar(x+(size2/2)*t,y,&#39; &#39;,size2, Color_Turn);</span></span>
<span class="line"><span>				continue;</span></span>
<span class="line"><span>			}</span></span>
<span class="line"><span>			else</span></span>
<span class="line"><span>			enshow=1;</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>		OLED_ShowChar(x+(size2/2)*t,y,temp+&#39;0&#39;,size2, Color_Turn);</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>	//小数点</span></span>
<span class="line"><span>	OLED_ShowChar(x+(size2/2)*(z_len),y,&#39;.&#39;,size2, Color_Turn);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>	f_temp=(int)((num-z_temp)*(oled_pow(10,f_len)));</span></span>
<span class="line"><span>  //小数部分</span></span>
<span class="line"><span>	for(t=0;t&lt;f_len;t++)</span></span>
<span class="line"><span>	{</span></span>
<span class="line"><span>		temp=(f_temp/oled_pow(10,f_len-t-1))%10;</span></span>
<span class="line"><span>		OLED_ShowChar(x+(size2/2)*(t+z_len)+5,y,temp+&#39;0&#39;,size2, Color_Turn);</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>	if(i==1)//如果为负，就将最前的一位赋值‘-’</span></span>
<span class="line"><span>	{</span></span>
<span class="line"><span>		OLED_ShowChar(x,y,&#39;-&#39;,size2, Color_Turn);</span></span>
<span class="line"><span>		i=0;</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span> * @function: void OLED_ShowCHinese(uint8_t x,uint8_t y,uint8_t no, uint8_t Color_Turn)</span></span>
<span class="line"><span> * @description: 在OLED特定位置开始显示16X16汉字</span></span>
<span class="line"><span> * @param {uint8_t} x待显示的汉字起始横坐标x: 0~112，两列汉字之间需要间隔16</span></span>
<span class="line"><span> * @param {uint8_t} y待显示的汉字起始纵坐标 y: 0~6 , 两行汉字之间需要间隔2</span></span>
<span class="line"><span> * @param {uint8_t} no待显示的汉字编号</span></span>
<span class="line"><span> * @param {uint8_t} Color_Turn是否反相显示(1反相、0不反相)</span></span>
<span class="line"><span> * @return {*}</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>void OLED_ShowCHinese(uint8_t x,uint8_t y,uint8_t no, uint8_t Color_Turn)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	uint8_t t=0;</span></span>
<span class="line"><span>	OLED_Set_Pos(x,y);</span></span>
<span class="line"><span>    for(t=0;t&lt;16;t++)</span></span>
<span class="line"><span>		{</span></span>
<span class="line"><span>				if (Color_Turn)</span></span>
<span class="line"><span>					OLED_WR_DATA(~Hzk[2*no][t]); //显示汉字的上半部分</span></span>
<span class="line"><span>				else</span></span>
<span class="line"><span>					OLED_WR_DATA(Hzk[2*no][t]); //显示汉字的上半部分</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>		OLED_Set_Pos(x,y+1);</span></span>
<span class="line"><span>    for(t=0;t&lt;16;t++)</span></span>
<span class="line"><span>		{</span></span>
<span class="line"><span>				if (Color_Turn)</span></span>
<span class="line"><span>					OLED_WR_DATA(~Hzk[2*no+1][t]); //显示汉字的上半部分</span></span>
<span class="line"><span>				else</span></span>
<span class="line"><span>					OLED_WR_DATA(Hzk[2*no+1][t]);//显示汉字的上半部分</span></span>
<span class="line"><span></span></span>
<span class="line"><span>         }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span> * @function: void OLED_DrawBMP(uint8_t x0, uint8_t y0, uint8_t x1, uint8_t y1, uint8_t *  BMP,uint8_t Color_Turn)</span></span>
<span class="line"><span> * @description: 在OLED特定区域显示BMP图片</span></span>
<span class="line"><span> * @param {uint8_t} x0图像开始显示横坐标  x0:0~127</span></span>
<span class="line"><span> * @param {uint8_t} y0图像开始显示纵坐标  y0:0~7</span></span>
<span class="line"><span> * @param {uint8_t} x1图像结束显示横坐标  x1:1~128</span></span>
<span class="line"><span> * @param {uint8_t} y1图像结束显示纵坐标  y1:1~8</span></span>
<span class="line"><span> * @param {uint8_t} *BMP待显示的图像数据</span></span>
<span class="line"><span> * @param {uint8_t} Color_Turn是否反相显示(1反相、0不反相)</span></span>
<span class="line"><span> * @return {*}</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>void OLED_DrawBMP(uint8_t x0, uint8_t y0, uint8_t x1, uint8_t y1, uint8_t *  BMP,uint8_t Color_Turn)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>   uint32_t j = 0;</span></span>
<span class="line"><span>   uint8_t x = 0, y = 0;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  if(y1%8==0)</span></span>
<span class="line"><span>		y = y1/8;</span></span>
<span class="line"><span>  else</span></span>
<span class="line"><span>		y = y1/8 + 1;</span></span>
<span class="line"><span>	for(y=y0;y&lt;y1;y++)</span></span>
<span class="line"><span>	{</span></span>
<span class="line"><span>		OLED_Set_Pos(x0,y);</span></span>
<span class="line"><span>    for(x=x0;x&lt;x1;x++)</span></span>
<span class="line"><span>		{</span></span>
<span class="line"><span>			if (Color_Turn)</span></span>
<span class="line"><span>				OLED_WR_DATA(~BMP[j++]);//显示反相图片</span></span>
<span class="line"><span>			else</span></span>
<span class="line"><span>				OLED_WR_DATA(BMP[j++]);//显示图片</span></span>
<span class="line"><span></span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span> * @function: void OLED_HorizontalShift(uint8_t direction)</span></span>
<span class="line"><span> * @description: 屏幕内容水平全屏滚动播放</span></span>
<span class="line"><span> * @param {uint8_t} direction			LEFT	   0x27     	RIGHT  0x26</span></span>
<span class="line"><span> * @return {*}</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>void OLED_HorizontalShift(uint8_t direction)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	OLED_WR_CMD(0x2e);//停止滚动</span></span>
<span class="line"><span>	OLED_WR_CMD(direction);//设置滚动方向</span></span>
<span class="line"><span>	OLED_WR_CMD(0x00);//虚拟字节设置，默认为0x00</span></span>
<span class="line"><span>	OLED_WR_CMD(0x00);//设置开始页地址</span></span>
<span class="line"><span>	OLED_WR_CMD(0x07);//设置每个滚动步骤之间的时间间隔的帧频</span></span>
<span class="line"><span>    //  0x00-5帧， 0x01-64帧， 0x02-128帧， 0x03-256帧， 0x04-3帧， 0x05-4帧， 0x06-25帧， 0x07-2帧，</span></span>
<span class="line"><span>	OLED_WR_CMD(0x07);//设置结束页地址</span></span>
<span class="line"><span>	OLED_WR_CMD(0x00);//虚拟字节设置，默认为0x00</span></span>
<span class="line"><span>	OLED_WR_CMD(0xff);//虚拟字节设置，默认为0xff</span></span>
<span class="line"><span>	OLED_WR_CMD(0x2f);//开启滚动-0x2f，禁用滚动-0x2e，禁用需要重写数据</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span> * @function: void OLED_Some_HorizontalShift(uint8_t direction,uint8_t start,uint8_t end)</span></span>
<span class="line"><span> * @description: 屏幕部分内容水平滚动播放</span></span>
<span class="line"><span> * @param {uint8_t} direction			LEFT	   0x27     	RIGHT  0x26</span></span>
<span class="line"><span> * @param {uint8_t} start 开始页地址  0x00~0x07</span></span>
<span class="line"><span> * @param {uint8_t} end  结束页地址  0x01~0x07</span></span>
<span class="line"><span> * @return {*}</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>void OLED_Some_HorizontalShift(uint8_t direction,uint8_t start,uint8_t end)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	OLED_WR_CMD(0x2e);//停止滚动</span></span>
<span class="line"><span>	OLED_WR_CMD(direction);//设置滚动方向</span></span>
<span class="line"><span>	OLED_WR_CMD(0x00);//虚拟字节设置，默认为0x00</span></span>
<span class="line"><span>	OLED_WR_CMD(start);//设置开始页地址</span></span>
<span class="line"><span>	OLED_WR_CMD(0x07);//设置每个滚动步骤之间的时间间隔的帧频,0x07即滚动速度2帧</span></span>
<span class="line"><span>	OLED_WR_CMD(end);//设置结束页地址</span></span>
<span class="line"><span>	OLED_WR_CMD(0x00);//虚拟字节设置，默认为0x00</span></span>
<span class="line"><span>	OLED_WR_CMD(0xff);//虚拟字节设置，默认为0xff</span></span>
<span class="line"><span>	OLED_WR_CMD(0x2f);//开启滚动-0x2f，禁用滚动-0x2e，禁用需要重写数据</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span> * @function: void OLED_VerticalAndHorizontalShift(uint8_t direction)</span></span>
<span class="line"><span> * @description: 屏幕内容垂直水平全屏滚动播放</span></span>
<span class="line"><span> * @param {uint8_t} direction				右上滚动	 0x29</span></span>
<span class="line"><span> *                                                            左上滚动   0x2A</span></span>
<span class="line"><span> * @return {*}</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>void OLED_VerticalAndHorizontalShift(uint8_t direction)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	OLED_WR_CMD(0x2e);//停止滚动</span></span>
<span class="line"><span>	OLED_WR_CMD(direction);//设置滚动方向</span></span>
<span class="line"><span>	OLED_WR_CMD(0x01);//虚拟字节设置</span></span>
<span class="line"><span>	OLED_WR_CMD(0x00);//设置开始页地址</span></span>
<span class="line"><span>	OLED_WR_CMD(0x07);//设置每个滚动步骤之间的时间间隔的帧频，即滚动速度</span></span>
<span class="line"><span>	OLED_WR_CMD(0x07);//设置结束页地址</span></span>
<span class="line"><span>	OLED_WR_CMD(0x01);//垂直滚动偏移量</span></span>
<span class="line"><span>	OLED_WR_CMD(0x00);//虚拟字节设置，默认为0x00</span></span>
<span class="line"><span>	OLED_WR_CMD(0xff);//虚拟字节设置，默认为0xff</span></span>
<span class="line"><span>	OLED_WR_CMD(0x2f);//开启滚动-0x2f，禁用滚动-0x2e，禁用需要重写数据</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span> * @function: void OLED_DisplayMode(uint8_t mode)</span></span>
<span class="line"><span> * @description: 屏幕内容取反显示</span></span>
<span class="line"><span> * @param {uint8_t} direction			ON	0xA7  ，</span></span>
<span class="line"><span> *                                                          OFF	0xA6	默认此模式，设置像素点亮</span></span>
<span class="line"><span> * @return {*}</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>void OLED_DisplayMode(uint8_t mode)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	OLED_WR_CMD(mode);</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/**</span></span>
<span class="line"><span> * @function: void OLED_IntensityControl(uint8_t intensity)</span></span>
<span class="line"><span> * @description: 屏幕亮度调节</span></span>
<span class="line"><span> * @param  {uint8_t} intensity	0x00~0xFF,RESET=0x7F</span></span>
<span class="line"><span> * @return {*}</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>void OLED_IntensityControl(uint8_t intensity)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	OLED_WR_CMD(0x81);</span></span>
<span class="line"><span>	OLED_WR_CMD(intensity);</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>oledfont.h</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/*</span></span>
<span class="line"><span> * oledfont.h</span></span>
<span class="line"><span> *</span></span>
<span class="line"><span> *  Created on: Mar 19, 2025</span></span>
<span class="line"><span> *      Author: 27276</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#ifndef SRC_OLED_OLEDFONT_H_</span></span>
<span class="line"><span>#define SRC_OLED_OLEDFONT_H_</span></span>
<span class="line"><span></span></span>
<span class="line"><span>extern const unsigned char F6x8[][6];</span></span>
<span class="line"><span>extern const unsigned char F8X16[];</span></span>
<span class="line"><span>extern const unsigned char Hzk[][32];</span></span>
<span class="line"><span>extern unsigned char BMP1[];</span></span>
<span class="line"><span>//extern unsigned char BMP2[].........</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#endif /* SRC_OLED_OLEDFONT_H_ */</span></span></code></pre></div><p>oledfont.c</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/*</span></span>
<span class="line"><span> * oledfont.c</span></span>
<span class="line"><span> *</span></span>
<span class="line"><span> *  Created on: Mar 19, 2025</span></span>
<span class="line"><span> *      Author: 27276</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>/*</span></span>
<span class="line"><span> * oledfont.c</span></span>
<span class="line"><span> *</span></span>
<span class="line"><span> *  Created on: Jul 24, 2022</span></span>
<span class="line"><span> *      Author: Unicorn_Li</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>#include &quot;oledfont.h&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//8*6 ASCII字符集点阵</span></span>
<span class="line"><span>const unsigned char F6x8[][6] =</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	{0x00, 0x00, 0x00, 0x00, 0x00, 0x00}, // sp</span></span>
<span class="line"><span>	{0x00, 0x00, 0x00, 0x2f, 0x00, 0x00}, // !</span></span>
<span class="line"><span>	{0x00, 0x00, 0x07, 0x00, 0x07, 0x00}, // &quot;</span></span>
<span class="line"><span>	{0x00, 0x14, 0x7f, 0x14, 0x7f, 0x14}, // #</span></span>
<span class="line"><span>	{0x00, 0x24, 0x2a, 0x7f, 0x2a, 0x12}, // $</span></span>
<span class="line"><span>	{0x00, 0x62, 0x64, 0x08, 0x13, 0x23}, // %</span></span>
<span class="line"><span>	{0x00, 0x36, 0x49, 0x55, 0x22, 0x50}, // &amp;</span></span>
<span class="line"><span>	{0x00, 0x00, 0x05, 0x03, 0x00, 0x00}, // &#39;</span></span>
<span class="line"><span>	{0x00, 0x00, 0x1c, 0x22, 0x41, 0x00}, // (</span></span>
<span class="line"><span>	{0x00, 0x00, 0x41, 0x22, 0x1c, 0x00}, // )</span></span>
<span class="line"><span>	{0x00, 0x14, 0x08, 0x3E, 0x08, 0x14}, // *</span></span>
<span class="line"><span>	{0x00, 0x08, 0x08, 0x3E, 0x08, 0x08}, // +</span></span>
<span class="line"><span>	{0x00, 0x00, 0x00, 0xA0, 0x60, 0x00}, // ,</span></span>
<span class="line"><span>	{0x00, 0x08, 0x08, 0x08, 0x08, 0x08}, // -</span></span>
<span class="line"><span>	{0x00, 0x00, 0x60, 0x60, 0x00, 0x00}, // .</span></span>
<span class="line"><span>	{0x00, 0x20, 0x10, 0x08, 0x04, 0x02}, // /</span></span>
<span class="line"><span>	{0x00, 0x3E, 0x51, 0x49, 0x45, 0x3E}, // 0</span></span>
<span class="line"><span>	{0x00, 0x00, 0x42, 0x7F, 0x40, 0x00}, // 1</span></span>
<span class="line"><span>	{0x00, 0x42, 0x61, 0x51, 0x49, 0x46}, // 2</span></span>
<span class="line"><span>	{0x00, 0x21, 0x41, 0x45, 0x4B, 0x31}, // 3</span></span>
<span class="line"><span>	{0x00, 0x18, 0x14, 0x12, 0x7F, 0x10}, // 4</span></span>
<span class="line"><span>	{0x00, 0x27, 0x45, 0x45, 0x45, 0x39}, // 5</span></span>
<span class="line"><span>	{0x00, 0x3C, 0x4A, 0x49, 0x49, 0x30}, // 6</span></span>
<span class="line"><span>	{0x00, 0x01, 0x71, 0x09, 0x05, 0x03}, // 7</span></span>
<span class="line"><span>	{0x00, 0x36, 0x49, 0x49, 0x49, 0x36}, // 8</span></span>
<span class="line"><span>	{0x00, 0x06, 0x49, 0x49, 0x29, 0x1E}, // 9</span></span>
<span class="line"><span>	{0x00, 0x00, 0x36, 0x36, 0x00, 0x00}, // :</span></span>
<span class="line"><span>	{0x00, 0x00, 0x56, 0x36, 0x00, 0x00}, // ;</span></span>
<span class="line"><span>	{0x00, 0x08, 0x14, 0x22, 0x41, 0x00}, // &lt;</span></span>
<span class="line"><span>	{0x00, 0x14, 0x14, 0x14, 0x14, 0x14}, // =</span></span>
<span class="line"><span>	{0x00, 0x00, 0x41, 0x22, 0x14, 0x08}, // &gt;</span></span>
<span class="line"><span>	{0x00, 0x02, 0x01, 0x51, 0x09, 0x06}, // ?</span></span>
<span class="line"><span>	{0x00, 0x32, 0x49, 0x59, 0x51, 0x3E}, // @</span></span>
<span class="line"><span>	{0x00, 0x7C, 0x12, 0x11, 0x12, 0x7C}, // A</span></span>
<span class="line"><span>	{0x00, 0x7F, 0x49, 0x49, 0x49, 0x36}, // B</span></span>
<span class="line"><span>	{0x00, 0x3E, 0x41, 0x41, 0x41, 0x22}, // C</span></span>
<span class="line"><span>	{0x00, 0x7F, 0x41, 0x41, 0x22, 0x1C}, // D</span></span>
<span class="line"><span>	{0x00, 0x7F, 0x49, 0x49, 0x49, 0x41}, // E</span></span>
<span class="line"><span>	{0x00, 0x7F, 0x09, 0x09, 0x09, 0x01}, // F</span></span>
<span class="line"><span>	{0x00, 0x3E, 0x41, 0x49, 0x49, 0x7A}, // G</span></span>
<span class="line"><span>	{0x00, 0x7F, 0x08, 0x08, 0x08, 0x7F}, // H</span></span>
<span class="line"><span>	{0x00, 0x00, 0x41, 0x7F, 0x41, 0x00}, // I</span></span>
<span class="line"><span>	{0x00, 0x20, 0x40, 0x41, 0x3F, 0x01}, // J</span></span>
<span class="line"><span>	{0x00, 0x7F, 0x08, 0x14, 0x22, 0x41}, // K</span></span>
<span class="line"><span>	{0x00, 0x7F, 0x40, 0x40, 0x40, 0x40}, // L</span></span>
<span class="line"><span>	{0x00, 0x7F, 0x02, 0x0C, 0x02, 0x7F}, // M</span></span>
<span class="line"><span>	{0x00, 0x7F, 0x04, 0x08, 0x10, 0x7F}, // N</span></span>
<span class="line"><span>	{0x00, 0x3E, 0x41, 0x41, 0x41, 0x3E}, // O</span></span>
<span class="line"><span>	{0x00, 0x7F, 0x09, 0x09, 0x09, 0x06}, // P</span></span>
<span class="line"><span>	{0x00, 0x3E, 0x41, 0x51, 0x21, 0x5E}, // Q</span></span>
<span class="line"><span>	{0x00, 0x7F, 0x09, 0x19, 0x29, 0x46}, // R</span></span>
<span class="line"><span>	{0x00, 0x46, 0x49, 0x49, 0x49, 0x31}, // S</span></span>
<span class="line"><span>	{0x00, 0x01, 0x01, 0x7F, 0x01, 0x01}, // T</span></span>
<span class="line"><span>	{0x00, 0x3F, 0x40, 0x40, 0x40, 0x3F}, // U</span></span>
<span class="line"><span>	{0x00, 0x1F, 0x20, 0x40, 0x20, 0x1F}, // V</span></span>
<span class="line"><span>	{0x00, 0x3F, 0x40, 0x38, 0x40, 0x3F}, // W</span></span>
<span class="line"><span>	{0x00, 0x63, 0x14, 0x08, 0x14, 0x63}, // X</span></span>
<span class="line"><span>	{0x00, 0x07, 0x08, 0x70, 0x08, 0x07}, // Y</span></span>
<span class="line"><span>	{0x00, 0x61, 0x51, 0x49, 0x45, 0x43}, // Z</span></span>
<span class="line"><span>	{0x00, 0x00, 0x7F, 0x41, 0x41, 0x00}, // [</span></span>
<span class="line"><span>	{0x00, 0x55, 0x2A, 0x55, 0x2A, 0x55}, // 55</span></span>
<span class="line"><span>	{0x00, 0x00, 0x41, 0x41, 0x7F, 0x00}, // ]</span></span>
<span class="line"><span>	{0x00, 0x04, 0x02, 0x01, 0x02, 0x04}, // ^</span></span>
<span class="line"><span>	{0x00, 0x40, 0x40, 0x40, 0x40, 0x40}, // _</span></span>
<span class="line"><span>	{0x00, 0x00, 0x01, 0x02, 0x04, 0x00}, // &#39;</span></span>
<span class="line"><span>	{0x00, 0x20, 0x54, 0x54, 0x54, 0x78}, // a</span></span>
<span class="line"><span>	{0x00, 0x7F, 0x48, 0x44, 0x44, 0x38}, // b</span></span>
<span class="line"><span>	{0x00, 0x38, 0x44, 0x44, 0x44, 0x20}, // c</span></span>
<span class="line"><span>	{0x00, 0x38, 0x44, 0x44, 0x48, 0x7F}, // d</span></span>
<span class="line"><span>	{0x00, 0x38, 0x54, 0x54, 0x54, 0x18}, // e</span></span>
<span class="line"><span>	{0x00, 0x08, 0x7E, 0x09, 0x01, 0x02}, // f</span></span>
<span class="line"><span>	{0x00, 0x18, 0xA4, 0xA4, 0xA4, 0x7C}, // g</span></span>
<span class="line"><span>	{0x00, 0x7F, 0x08, 0x04, 0x04, 0x78}, // h</span></span>
<span class="line"><span>	{0x00, 0x00, 0x44, 0x7D, 0x40, 0x00}, // i</span></span>
<span class="line"><span>	{0x00, 0x40, 0x80, 0x84, 0x7D, 0x00}, // j</span></span>
<span class="line"><span>	{0x00, 0x7F, 0x10, 0x28, 0x44, 0x00}, // k</span></span>
<span class="line"><span>	{0x00, 0x00, 0x41, 0x7F, 0x40, 0x00}, // l</span></span>
<span class="line"><span>	{0x00, 0x7C, 0x04, 0x18, 0x04, 0x78}, // m</span></span>
<span class="line"><span>	{0x00, 0x7C, 0x08, 0x04, 0x04, 0x78}, // n</span></span>
<span class="line"><span>	{0x00, 0x38, 0x44, 0x44, 0x44, 0x38}, // o</span></span>
<span class="line"><span>	{0x00, 0xFC, 0x24, 0x24, 0x24, 0x18}, // p</span></span>
<span class="line"><span>	{0x00, 0x18, 0x24, 0x24, 0x18, 0xFC}, // q</span></span>
<span class="line"><span>	{0x00, 0x7C, 0x08, 0x04, 0x04, 0x08}, // r</span></span>
<span class="line"><span>	{0x00, 0x48, 0x54, 0x54, 0x54, 0x20}, // s</span></span>
<span class="line"><span>	{0x00, 0x04, 0x3F, 0x44, 0x40, 0x20}, // t</span></span>
<span class="line"><span>	{0x00, 0x3C, 0x40, 0x40, 0x20, 0x7C}, // u</span></span>
<span class="line"><span>	{0x00, 0x1C, 0x20, 0x40, 0x20, 0x1C}, // v</span></span>
<span class="line"><span>	{0x00, 0x3C, 0x40, 0x30, 0x40, 0x3C}, // w</span></span>
<span class="line"><span>	{0x00, 0x44, 0x28, 0x10, 0x28, 0x44}, // x</span></span>
<span class="line"><span>	{0x00, 0x1C, 0xA0, 0xA0, 0xA0, 0x7C}, // y</span></span>
<span class="line"><span>	{0x00, 0x44, 0x64, 0x54, 0x4C, 0x44}, // z</span></span>
<span class="line"><span>	{0x14, 0x14, 0x14, 0x14, 0x14, 0x14}  // horiz lines</span></span>
<span class="line"><span>};</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//const unsigned char F6x8[][6] =</span></span>
<span class="line"><span>//{</span></span>
<span class="line"><span>//	0x00, 0x00, 0x00, 0x00, 0x00, 0x00,// sp</span></span>
<span class="line"><span>//	0x00, 0x00, 0x00, 0x2f, 0x00, 0x00,// !</span></span>
<span class="line"><span>//	0x00, 0x00, 0x07, 0x00, 0x07, 0x00,// &quot;</span></span>
<span class="line"><span>//	0x00, 0x14, 0x7f, 0x14, 0x7f, 0x14,// #</span></span>
<span class="line"><span>//	0x00, 0x24, 0x2a, 0x7f, 0x2a, 0x12,// $</span></span>
<span class="line"><span>//	0x00, 0x62, 0x64, 0x08, 0x13, 0x23,// %</span></span>
<span class="line"><span>//	0x00, 0x36, 0x49, 0x55, 0x22, 0x50,// &amp;</span></span>
<span class="line"><span>//	0x00, 0x00, 0x05, 0x03, 0x00, 0x00,// &#39;</span></span>
<span class="line"><span>//	0x00, 0x00, 0x1c, 0x22, 0x41, 0x00,// (</span></span>
<span class="line"><span>//	0x00, 0x00, 0x41, 0x22, 0x1c, 0x00,// )</span></span>
<span class="line"><span>//	0x00, 0x14, 0x08, 0x3E, 0x08, 0x14,// *</span></span>
<span class="line"><span>//	0x00, 0x08, 0x08, 0x3E, 0x08, 0x08,// +</span></span>
<span class="line"><span>//	0x00, 0x00, 0x00, 0xA0, 0x60, 0x00,// ,</span></span>
<span class="line"><span>//	0x00, 0x08, 0x08, 0x08, 0x08, 0x08,// -</span></span>
<span class="line"><span>//	0x00, 0x00, 0x60, 0x60, 0x00, 0x00,// .</span></span>
<span class="line"><span>//	0x00, 0x20, 0x10, 0x08, 0x04, 0x02,// /</span></span>
<span class="line"><span>//	0x00, 0x3E, 0x51, 0x49, 0x45, 0x3E,// 0</span></span>
<span class="line"><span>//	0x00, 0x00, 0x42, 0x7F, 0x40, 0x00,// 1</span></span>
<span class="line"><span>//	0x00, 0x42, 0x61, 0x51, 0x49, 0x46,// 2</span></span>
<span class="line"><span>//	0x00, 0x21, 0x41, 0x45, 0x4B, 0x31,// 3</span></span>
<span class="line"><span>//	0x00, 0x18, 0x14, 0x12, 0x7F, 0x10,// 4</span></span>
<span class="line"><span>//	0x00, 0x27, 0x45, 0x45, 0x45, 0x39,// 5</span></span>
<span class="line"><span>//	0x00, 0x3C, 0x4A, 0x49, 0x49, 0x30,// 6</span></span>
<span class="line"><span>//	0x00, 0x01, 0x71, 0x09, 0x05, 0x03,// 7</span></span>
<span class="line"><span>//	0x00, 0x36, 0x49, 0x49, 0x49, 0x36,// 8</span></span>
<span class="line"><span>//	0x00, 0x06, 0x49, 0x49, 0x29, 0x1E,// 9</span></span>
<span class="line"><span>//	0x00, 0x00, 0x36, 0x36, 0x00, 0x00,// :</span></span>
<span class="line"><span>//	0x00, 0x00, 0x56, 0x36, 0x00, 0x00,// ;</span></span>
<span class="line"><span>//	0x00, 0x08, 0x14, 0x22, 0x41, 0x00,// &lt;</span></span>
<span class="line"><span>//	0x00, 0x14, 0x14, 0x14, 0x14, 0x14,// =</span></span>
<span class="line"><span>//	0x00, 0x00, 0x41, 0x22, 0x14, 0x08,// &gt;</span></span>
<span class="line"><span>//	0x00, 0x02, 0x01, 0x51, 0x09, 0x06,// ?</span></span>
<span class="line"><span>//	0x00, 0x32, 0x49, 0x59, 0x51, 0x3E,// @</span></span>
<span class="line"><span>//	0x00, 0x7C, 0x12, 0x11, 0x12, 0x7C,// A</span></span>
<span class="line"><span>//	0x00, 0x7F, 0x49, 0x49, 0x49, 0x36,// B</span></span>
<span class="line"><span>//	0x00, 0x3E, 0x41, 0x41, 0x41, 0x22,// C</span></span>
<span class="line"><span>//	0x00, 0x7F, 0x41, 0x41, 0x22, 0x1C,// D</span></span>
<span class="line"><span>//	0x00, 0x7F, 0x49, 0x49, 0x49, 0x41,// E</span></span>
<span class="line"><span>//	0x00, 0x7F, 0x09, 0x09, 0x09, 0x01,// F</span></span>
<span class="line"><span>//	0x00, 0x3E, 0x41, 0x49, 0x49, 0x7A,// G</span></span>
<span class="line"><span>//	0x00, 0x7F, 0x08, 0x08, 0x08, 0x7F,// H</span></span>
<span class="line"><span>//	0x00, 0x00, 0x41, 0x7F, 0x41, 0x00,// I</span></span>
<span class="line"><span>//	0x00, 0x20, 0x40, 0x41, 0x3F, 0x01,// J</span></span>
<span class="line"><span>//	0x00, 0x7F, 0x08, 0x14, 0x22, 0x41,// K</span></span>
<span class="line"><span>//	0x00, 0x7F, 0x40, 0x40, 0x40, 0x40,// L</span></span>
<span class="line"><span>//	0x00, 0x7F, 0x02, 0x0C, 0x02, 0x7F,// M</span></span>
<span class="line"><span>//	0x00, 0x7F, 0x04, 0x08, 0x10, 0x7F,// N</span></span>
<span class="line"><span>//	0x00, 0x3E, 0x41, 0x41, 0x41, 0x3E,// O</span></span>
<span class="line"><span>//	0x00, 0x7F, 0x09, 0x09, 0x09, 0x06,// P</span></span>
<span class="line"><span>//	0x00, 0x3E, 0x41, 0x51, 0x21, 0x5E,// Q</span></span>
<span class="line"><span>//	0x00, 0x7F, 0x09, 0x19, 0x29, 0x46,// R</span></span>
<span class="line"><span>//	0x00, 0x46, 0x49, 0x49, 0x49, 0x31,// S</span></span>
<span class="line"><span>//	0x00, 0x01, 0x01, 0x7F, 0x01, 0x01,// T</span></span>
<span class="line"><span>//	0x00, 0x3F, 0x40, 0x40, 0x40, 0x3F,// U</span></span>
<span class="line"><span>//	0x00, 0x1F, 0x20, 0x40, 0x20, 0x1F,// V</span></span>
<span class="line"><span>//	0x00, 0x3F, 0x40, 0x38, 0x40, 0x3F,// W</span></span>
<span class="line"><span>//	0x00, 0x63, 0x14, 0x08, 0x14, 0x63,// X</span></span>
<span class="line"><span>//	0x00, 0x07, 0x08, 0x70, 0x08, 0x07,// Y</span></span>
<span class="line"><span>//	0x00, 0x61, 0x51, 0x49, 0x45, 0x43,// Z</span></span>
<span class="line"><span>//	0x00, 0x00, 0x7F, 0x41, 0x41, 0x00,// [</span></span>
<span class="line"><span>//	0x00, 0x55, 0x2A, 0x55, 0x2A, 0x55,// 55</span></span>
<span class="line"><span>//	0x00, 0x00, 0x41, 0x41, 0x7F, 0x00,// ]</span></span>
<span class="line"><span>//	0x00, 0x04, 0x02, 0x01, 0x02, 0x04,// ^</span></span>
<span class="line"><span>//	0x00, 0x40, 0x40, 0x40, 0x40, 0x40,// _</span></span>
<span class="line"><span>//	0x00, 0x00, 0x01, 0x02, 0x04, 0x00,// &#39;</span></span>
<span class="line"><span>//	0x00, 0x20, 0x54, 0x54, 0x54, 0x78,// a</span></span>
<span class="line"><span>//	0x00, 0x7F, 0x48, 0x44, 0x44, 0x38,// b</span></span>
<span class="line"><span>//	0x00, 0x38, 0x44, 0x44, 0x44, 0x20,// c</span></span>
<span class="line"><span>//	0x00, 0x38, 0x44, 0x44, 0x48, 0x7F,// d</span></span>
<span class="line"><span>//	0x00, 0x38, 0x54, 0x54, 0x54, 0x18,// e</span></span>
<span class="line"><span>//	0x00, 0x08, 0x7E, 0x09, 0x01, 0x02,// f</span></span>
<span class="line"><span>//	0x00, 0x18, 0xA4, 0xA4, 0xA4, 0x7C,// g</span></span>
<span class="line"><span>//	0x00, 0x7F, 0x08, 0x04, 0x04, 0x78,// h</span></span>
<span class="line"><span>//	0x00, 0x00, 0x44, 0x7D, 0x40, 0x00,// i</span></span>
<span class="line"><span>//	0x00, 0x40, 0x80, 0x84, 0x7D, 0x00,// j</span></span>
<span class="line"><span>//	0x00, 0x7F, 0x10, 0x28, 0x44, 0x00,// k</span></span>
<span class="line"><span>//	0x00, 0x00, 0x41, 0x7F, 0x40, 0x00,// l</span></span>
<span class="line"><span>//	0x00, 0x7C, 0x04, 0x18, 0x04, 0x78,// m</span></span>
<span class="line"><span>//	0x00, 0x7C, 0x08, 0x04, 0x04, 0x78,// n</span></span>
<span class="line"><span>//	0x00, 0x38, 0x44, 0x44, 0x44, 0x38,// o</span></span>
<span class="line"><span>//	0x00, 0xFC, 0x24, 0x24, 0x24, 0x18,// p</span></span>
<span class="line"><span>//	0x00, 0x18, 0x24, 0x24, 0x18, 0xFC,// q</span></span>
<span class="line"><span>//	0x00, 0x7C, 0x08, 0x04, 0x04, 0x08,// r</span></span>
<span class="line"><span>//	0x00, 0x48, 0x54, 0x54, 0x54, 0x20,// s</span></span>
<span class="line"><span>//	0x00, 0x04, 0x3F, 0x44, 0x40, 0x20,// t</span></span>
<span class="line"><span>//	0x00, 0x3C, 0x40, 0x40, 0x20, 0x7C,// u</span></span>
<span class="line"><span>//	0x00, 0x1C, 0x20, 0x40, 0x20, 0x1C,// v</span></span>
<span class="line"><span>//	0x00, 0x3C, 0x40, 0x30, 0x40, 0x3C,// w</span></span>
<span class="line"><span>//	0x00, 0x44, 0x28, 0x10, 0x28, 0x44,// x</span></span>
<span class="line"><span>//	0x00, 0x1C, 0xA0, 0xA0, 0xA0, 0x7C,// y</span></span>
<span class="line"><span>//	0x00, 0x44, 0x64, 0x54, 0x4C, 0x44,// z</span></span>
<span class="line"><span>//	0x14, 0x14, 0x14, 0x14, 0x14, 0x14,// horiz lines</span></span>
<span class="line"><span>//};</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//16*8 ASCII字符集点阵</span></span>
<span class="line"><span>const unsigned char F8X16[]=</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span> 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,//sp /0</span></span>
<span class="line"><span> 0x00,0x00,0x00,0xF8,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x33,0x30,0x00,0x00,0x00,//!  /1</span></span>
<span class="line"><span> 0x00,0x10,0x0C,0x06,0x10,0x0C,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,//&quot;  /2</span></span>
<span class="line"><span> 0x40,0xC0,0x78,0x40,0xC0,0x78,0x40,0x00,0x04,0x3F,0x04,0x04,0x3F,0x04,0x04,0x00,//#  /3</span></span>
<span class="line"><span> 0x00,0x70,0x88,0xFC,0x08,0x30,0x00,0x00,0x00,0x18,0x20,0xFF,0x21,0x1E,0x00,0x00,//$  /4</span></span>
<span class="line"><span> 0xF0,0x08,0xF0,0x00,0xE0,0x18,0x00,0x00,0x00,0x21,0x1C,0x03,0x1E,0x21,0x1E,0x00,//%  /5</span></span>
<span class="line"><span> 0x00,0xF0,0x08,0x88,0x70,0x00,0x00,0x00,0x1E,0x21,0x23,0x24,0x19,0x27,0x21,0x10,//&amp;  /6</span></span>
<span class="line"><span> 0x10,0x16,0x0E,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,//&#39;  /7</span></span>
<span class="line"><span> 0x00,0x00,0x00,0xE0,0x18,0x04,0x02,0x00,0x00,0x00,0x00,0x07,0x18,0x20,0x40,0x00,//(  /8</span></span>
<span class="line"><span> 0x00,0x02,0x04,0x18,0xE0,0x00,0x00,0x00,0x00,0x40,0x20,0x18,0x07,0x00,0x00,0x00,//)  /9</span></span>
<span class="line"><span> 0x40,0x40,0x80,0xF0,0x80,0x40,0x40,0x00,0x02,0x02,0x01,0x0F,0x01,0x02,0x02,0x00,//*  /10</span></span>
<span class="line"><span> 0x00,0x00,0x00,0xF0,0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x1F,0x01,0x01,0x01,0x00,//+  /11</span></span>
<span class="line"><span> 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0xB0,0x70,0x00,0x00,0x00,0x00,0x00,//,  /12</span></span>
<span class="line"><span> 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x01,0x01,0x01,0x01,//-  /13</span></span>
<span class="line"><span> 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x30,0x30,0x00,0x00,0x00,0x00,0x00,//.  /14</span></span>
<span class="line"><span> 0x00,0x00,0x00,0x00,0x80,0x60,0x18,0x04,0x00,0x60,0x18,0x06,0x01,0x00,0x00,0x00,///  /15</span></span>
<span class="line"><span> 0x00,0xE0,0x10,0x08,0x08,0x10,0xE0,0x00,0x00,0x0F,0x10,0x20,0x20,0x10,0x0F,0x00,//0  /16</span></span>
<span class="line"><span> 0x00,0x10,0x10,0xF8,0x00,0x00,0x00,0x00,0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00,//1  /17</span></span>
<span class="line"><span> 0x00,0x70,0x08,0x08,0x08,0x88,0x70,0x00,0x00,0x30,0x28,0x24,0x22,0x21,0x30,0x00,//2  /18</span></span>
<span class="line"><span> 0x00,0x30,0x08,0x88,0x88,0x48,0x30,0x00,0x00,0x18,0x20,0x20,0x20,0x11,0x0E,0x00,//3  /19</span></span>
<span class="line"><span> 0x00,0x00,0xC0,0x20,0x10,0xF8,0x00,0x00,0x00,0x07,0x04,0x24,0x24,0x3F,0x24,0x00,//4  /20</span></span>
<span class="line"><span> 0x00,0xF8,0x08,0x88,0x88,0x08,0x08,0x00,0x00,0x19,0x21,0x20,0x20,0x11,0x0E,0x00,//5  /21</span></span>
<span class="line"><span> 0x00,0xE0,0x10,0x88,0x88,0x18,0x00,0x00,0x00,0x0F,0x11,0x20,0x20,0x11,0x0E,0x00,//6  /22</span></span>
<span class="line"><span> 0x00,0x38,0x08,0x08,0xC8,0x38,0x08,0x00,0x00,0x00,0x00,0x3F,0x00,0x00,0x00,0x00,//7  /23</span></span>
<span class="line"><span> 0x00,0x70,0x88,0x08,0x08,0x88,0x70,0x00,0x00,0x1C,0x22,0x21,0x21,0x22,0x1C,0x00,//8  /24</span></span>
<span class="line"><span> 0x00,0xE0,0x10,0x08,0x08,0x10,0xE0,0x00,0x00,0x00,0x31,0x22,0x22,0x11,0x0F,0x00,//9  /25</span></span>
<span class="line"><span> 0x00,0x00,0x00,0xC0,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x30,0x30,0x00,0x00,0x00,//:  /26</span></span>
<span class="line"><span> 0x00,0x00,0x00,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x60,0x00,0x00,0x00,0x00,//;  /27</span></span>
<span class="line"><span> 0x00,0x00,0x80,0x40,0x20,0x10,0x08,0x00,0x00,0x01,0x02,0x04,0x08,0x10,0x20,0x00,//&lt;  /28</span></span>
<span class="line"><span> 0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x00,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x00,//=  /29</span></span>
<span class="line"><span> 0x00,0x08,0x10,0x20,0x40,0x80,0x00,0x00,0x00,0x20,0x10,0x08,0x04,0x02,0x01,0x00,//&gt;  /30</span></span>
<span class="line"><span> 0x00,0x70,0x48,0x08,0x08,0x08,0xF0,0x00,0x00,0x00,0x00,0x30,0x36,0x01,0x00,0x00,//?  /31</span></span>
<span class="line"><span> 0xC0,0x30,0xC8,0x28,0xE8,0x10,0xE0,0x00,0x07,0x18,0x27,0x24,0x23,0x14,0x0B,0x00,//@  /32</span></span>
<span class="line"><span> 0x00,0x00,0xC0,0x38,0xE0,0x00,0x00,0x00,0x20,0x3C,0x23,0x02,0x02,0x27,0x38,0x20,//A  /33</span></span>
<span class="line"><span> 0x08,0xF8,0x88,0x88,0x88,0x70,0x00,0x00,0x20,0x3F,0x20,0x20,0x20,0x11,0x0E,0x00,//B  /34</span></span>
<span class="line"><span> 0xC0,0x30,0x08,0x08,0x08,0x08,0x38,0x00,0x07,0x18,0x20,0x20,0x20,0x10,0x08,0x00,//C  /35</span></span>
<span class="line"><span> 0x08,0xF8,0x08,0x08,0x08,0x10,0xE0,0x00,0x20,0x3F,0x20,0x20,0x20,0x10,0x0F,0x00,//D  /36</span></span>
<span class="line"><span> 0x08,0xF8,0x88,0x88,0xE8,0x08,0x10,0x00,0x20,0x3F,0x20,0x20,0x23,0x20,0x18,0x00,//E  /37</span></span>
<span class="line"><span> 0x08,0xF8,0x88,0x88,0xE8,0x08,0x10,0x00,0x20,0x3F,0x20,0x00,0x03,0x00,0x00,0x00,//F  /38</span></span>
<span class="line"><span> 0xC0,0x30,0x08,0x08,0x08,0x38,0x00,0x00,0x07,0x18,0x20,0x20,0x22,0x1E,0x02,0x00,//G  /39</span></span>
<span class="line"><span> 0x08,0xF8,0x08,0x00,0x00,0x08,0xF8,0x08,0x20,0x3F,0x21,0x01,0x01,0x21,0x3F,0x20,//H  /40</span></span>
<span class="line"><span> 0x00,0x08,0x08,0xF8,0x08,0x08,0x00,0x00,0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00,//I  /41</span></span>
<span class="line"><span> 0x00,0x00,0x08,0x08,0xF8,0x08,0x08,0x00,0xC0,0x80,0x80,0x80,0x7F,0x00,0x00,0x00,//J  /42</span></span>
<span class="line"><span> 0x08,0xF8,0x88,0xC0,0x28,0x18,0x08,0x00,0x20,0x3F,0x20,0x01,0x26,0x38,0x20,0x00,//K  /43</span></span>
<span class="line"><span> 0x08,0xF8,0x08,0x00,0x00,0x00,0x00,0x00,0x20,0x3F,0x20,0x20,0x20,0x20,0x30,0x00,//L  /44</span></span>
<span class="line"><span> 0x08,0xF8,0xF8,0x00,0xF8,0xF8,0x08,0x00,0x20,0x3F,0x00,0x3F,0x00,0x3F,0x20,0x00,//M  /45</span></span>
<span class="line"><span> 0x08,0xF8,0x30,0xC0,0x00,0x08,0xF8,0x08,0x20,0x3F,0x20,0x00,0x07,0x18,0x3F,0x00,//N  /46</span></span>
<span class="line"><span> 0xE0,0x10,0x08,0x08,0x08,0x10,0xE0,0x00,0x0F,0x10,0x20,0x20,0x20,0x10,0x0F,0x00,//O  /47</span></span>
<span class="line"><span> 0x08,0xF8,0x08,0x08,0x08,0x08,0xF0,0x00,0x20,0x3F,0x21,0x01,0x01,0x01,0x00,0x00,//P  /48</span></span>
<span class="line"><span> 0xE0,0x10,0x08,0x08,0x08,0x10,0xE0,0x00,0x0F,0x18,0x24,0x24,0x38,0x50,0x4F,0x00,//Q  /49</span></span>
<span class="line"><span> 0x08,0xF8,0x88,0x88,0x88,0x88,0x70,0x00,0x20,0x3F,0x20,0x00,0x03,0x0C,0x30,0x20,//R  /50</span></span>
<span class="line"><span> 0x00,0x70,0x88,0x08,0x08,0x08,0x38,0x00,0x00,0x38,0x20,0x21,0x21,0x22,0x1C,0x00,//S  /51</span></span>
<span class="line"><span> 0x18,0x08,0x08,0xF8,0x08,0x08,0x18,0x00,0x00,0x00,0x20,0x3F,0x20,0x00,0x00,0x00,//T  /52</span></span>
<span class="line"><span> 0x08,0xF8,0x08,0x00,0x00,0x08,0xF8,0x08,0x00,0x1F,0x20,0x20,0x20,0x20,0x1F,0x00,//U  /53</span></span>
<span class="line"><span> 0x08,0x78,0x88,0x00,0x00,0xC8,0x38,0x08,0x00,0x00,0x07,0x38,0x0E,0x01,0x00,0x00,//V  /54</span></span>
<span class="line"><span> 0xF8,0x08,0x00,0xF8,0x00,0x08,0xF8,0x00,0x03,0x3C,0x07,0x00,0x07,0x3C,0x03,0x00,//W  /55</span></span>
<span class="line"><span> 0x08,0x18,0x68,0x80,0x80,0x68,0x18,0x08,0x20,0x30,0x2C,0x03,0x03,0x2C,0x30,0x20,//X  /56</span></span>
<span class="line"><span> 0x08,0x38,0xC8,0x00,0xC8,0x38,0x08,0x00,0x00,0x00,0x20,0x3F,0x20,0x00,0x00,0x00,//Y  /57</span></span>
<span class="line"><span> 0x10,0x08,0x08,0x08,0xC8,0x38,0x08,0x00,0x20,0x38,0x26,0x21,0x20,0x20,0x18,0x00,//Z  /58</span></span>
<span class="line"><span> 0x00,0x00,0x00,0xFE,0x02,0x02,0x02,0x00,0x00,0x00,0x00,0x7F,0x40,0x40,0x40,0x00,//[  /59</span></span>
<span class="line"><span> 0x00,0x0C,0x30,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x06,0x38,0xC0,0x00,//\  /60</span></span>
<span class="line"><span> 0x00,0x02,0x02,0x02,0xFE,0x00,0x00,0x00,0x00,0x40,0x40,0x40,0x7F,0x00,0x00,0x00,//]  /61</span></span>
<span class="line"><span> 0x00,0x00,0x04,0x02,0x02,0x02,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,//^  /62</span></span>
<span class="line"><span> 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,//_  /63</span></span>
<span class="line"><span> 0x00,0x02,0x02,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,//`  /64</span></span>
<span class="line"><span> 0x00,0x00,0x80,0x80,0x80,0x80,0x00,0x00,0x00,0x19,0x24,0x22,0x22,0x22,0x3F,0x20,//a  /65</span></span>
<span class="line"><span> 0x08,0xF8,0x00,0x80,0x80,0x00,0x00,0x00,0x00,0x3F,0x11,0x20,0x20,0x11,0x0E,0x00,//b  /66</span></span>
<span class="line"><span> 0x00,0x00,0x00,0x80,0x80,0x80,0x00,0x00,0x00,0x0E,0x11,0x20,0x20,0x20,0x11,0x00,//c  /67</span></span>
<span class="line"><span> 0x00,0x00,0x00,0x80,0x80,0x88,0xF8,0x00,0x00,0x0E,0x11,0x20,0x20,0x10,0x3F,0x20,//d  /68</span></span>
<span class="line"><span> 0x00,0x00,0x80,0x80,0x80,0x80,0x00,0x00,0x00,0x1F,0x22,0x22,0x22,0x22,0x13,0x00,//e  /69</span></span>
<span class="line"><span> 0x00,0x80,0x80,0xF0,0x88,0x88,0x88,0x18,0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00,//f  /70</span></span>
<span class="line"><span> 0x00,0x00,0x80,0x80,0x80,0x80,0x80,0x00,0x00,0x6B,0x94,0x94,0x94,0x93,0x60,0x00,//g  /71</span></span>
<span class="line"><span> 0x08,0xF8,0x00,0x80,0x80,0x80,0x00,0x00,0x20,0x3F,0x21,0x00,0x00,0x20,0x3F,0x20,//h  /72</span></span>
<span class="line"><span> 0x00,0x80,0x98,0x98,0x00,0x00,0x00,0x00,0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00,//i  /73</span></span>
<span class="line"><span> 0x00,0x00,0x00,0x80,0x98,0x98,0x00,0x00,0x00,0xC0,0x80,0x80,0x80,0x7F,0x00,0x00,//j  /74</span></span>
<span class="line"><span> 0x08,0xF8,0x00,0x00,0x80,0x80,0x80,0x00,0x20,0x3F,0x24,0x02,0x2D,0x30,0x20,0x00,//k  /75</span></span>
<span class="line"><span> 0x00,0x08,0x08,0xF8,0x00,0x00,0x00,0x00,0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00,//l  /76</span></span>
<span class="line"><span> 0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x00,0x20,0x3F,0x20,0x00,0x3F,0x20,0x00,0x3F,//m  /77</span></span>
<span class="line"><span> 0x80,0x80,0x00,0x80,0x80,0x80,0x00,0x00,0x20,0x3F,0x21,0x00,0x00,0x20,0x3F,0x20,//n  /78</span></span>
<span class="line"><span> 0x00,0x00,0x80,0x80,0x80,0x80,0x00,0x00,0x00,0x1F,0x20,0x20,0x20,0x20,0x1F,0x00,//o  /79</span></span>
<span class="line"><span> 0x80,0x80,0x00,0x80,0x80,0x00,0x00,0x00,0x80,0xFF,0xA1,0x20,0x20,0x11,0x0E,0x00,//p  /80</span></span>
<span class="line"><span> 0x00,0x00,0x00,0x80,0x80,0x80,0x80,0x00,0x00,0x0E,0x11,0x20,0x20,0xA0,0xFF,0x80,//q  /81</span></span>
<span class="line"><span> 0x80,0x80,0x80,0x00,0x80,0x80,0x80,0x00,0x20,0x20,0x3F,0x21,0x20,0x00,0x01,0x00,//r  /82</span></span>
<span class="line"><span> 0x00,0x00,0x80,0x80,0x80,0x80,0x80,0x00,0x00,0x33,0x24,0x24,0x24,0x24,0x19,0x00,//s  /83</span></span>
<span class="line"><span> 0x00,0x80,0x80,0xE0,0x80,0x80,0x00,0x00,0x00,0x00,0x00,0x1F,0x20,0x20,0x00,0x00,//t  /84</span></span>
<span class="line"><span> 0x80,0x80,0x00,0x00,0x00,0x80,0x80,0x00,0x00,0x1F,0x20,0x20,0x20,0x10,0x3F,0x20,//u  /85</span></span>
<span class="line"><span> 0x80,0x80,0x80,0x00,0x00,0x80,0x80,0x80,0x00,0x01,0x0E,0x30,0x08,0x06,0x01,0x00,//v  /86</span></span>
<span class="line"><span> 0x80,0x80,0x00,0x80,0x00,0x80,0x80,0x80,0x0F,0x30,0x0C,0x03,0x0C,0x30,0x0F,0x00,//w  /87</span></span>
<span class="line"><span> 0x00,0x80,0x80,0x00,0x80,0x80,0x80,0x00,0x00,0x20,0x31,0x2E,0x0E,0x31,0x20,0x00,//x  /88</span></span>
<span class="line"><span> 0x80,0x80,0x80,0x00,0x00,0x80,0x80,0x80,0x80,0x81,0x8E,0x70,0x18,0x06,0x01,0x00,//y  /89</span></span>
<span class="line"><span> 0x00,0x80,0x80,0x80,0x80,0x80,0x80,0x00,0x00,0x21,0x30,0x2C,0x22,0x21,0x30,0x00,//z  /90</span></span>
<span class="line"><span> 0x00,0x00,0x00,0x00,0x80,0x7C,0x02,0x02,0x00,0x00,0x00,0x00,0x00,0x3F,0x40,0x40,//{  /91</span></span>
<span class="line"><span> 0x00,0x02,0x02,0x7C,0x80,0x00,0x00,0x00,0x00,0x40,0x40,0x3F,0x00,0x00,0x00,0x00,//}  /92</span></span>
<span class="line"><span> 0x00,0x00,0x00,0x00,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0x00,0x00,0x00};//|  /93</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//部分汉字 阴码，列行式，逆向</span></span>
<span class="line"><span>const unsigned char Hzk[][32]=</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>		{0x40,0x22,0x14,0x08,0xF4,0x02,0x00,0xF8,0x08,0x08,0xFF,0x08,0x08,0xF8,0x00,0x00},</span></span>
<span class="line"><span>		{0x08,0x44,0x82,0x41,0x3F,0x00,0x20,0x63,0x21,0x21,0x3F,0x21,0x29,0x33,0x60,0x00},/*&quot;独&quot;,0*/</span></span>
<span class="line"><span>		{0x20,0x10,0xE8,0x24,0x27,0x24,0x24,0xE4,0x24,0x34,0x2C,0x20,0xE0,0x00,0x00,0x00},</span></span>
<span class="line"><span>		{0x80,0x60,0x1F,0x09,0x09,0x09,0x09,0x7F,0x09,0x09,0x49,0x89,0x7F,0x00,0x00,0x00},/*&quot;角&quot;,1*/</span></span>
<span class="line"><span>		{0x00,0x00,0x7C,0x54,0x55,0x56,0x54,0x7C,0x54,0x56,0x55,0x54,0x7C,0x00,0x00,0x00},</span></span>
<span class="line"><span>		{0x01,0x01,0x01,0xFD,0x45,0x45,0x45,0x45,0x45,0x45,0x45,0xFD,0x01,0x01,0x01,0x00},/*&quot;兽&quot;,2*/</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>};</span></span>
<span class="line"><span>//128*64图片</span></span>
<span class="line"><span>unsigned char BMP1[]={</span></span>
<span class="line"><span>		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x80,0x00,0x40,0xE0,0xE0,0x60,</span></span>
<span class="line"><span>		0x00,0x40,0x80,0x00,0x00,0x00,0x80,0x80,0x60,0x60,0x10,0x00,0x00,0x00,0x00,0x00,</span></span>
<span class="line"><span>		0x00,0x00,0x00,0x00,0x00,0x90,0xB2,0x66,0x6E,0xEC,0xC9,0x83,0x02,0x00,0x40,0x80,</span></span>
<span class="line"><span>		0x00,0x0C,0x0C,0x01,0x03,0x07,0x0F,0x11,0x20,0x40,0x80,0x00,0x00,0x00,0x00,0x00,</span></span>
<span class="line"><span>		0x00,0x00,0x00,0x00,0x08,0x18,0x3B,0x37,0x66,0xEE,0xEE,0xCC,0x88,0x80,0x00,0x00,</span></span>
<span class="line"><span>		0x01,0x02,0x04,0x08,0x10,0x10,0x10,0x10,0x10,0x10,0x0F,0x00,0x00,0x00,0x00,0x00,</span></span>
<span class="line"><span>		0x00,0x3E,0x40,0x40,0x40,0x3E,0x00,0x7E,0x04,0x08,0x10,0x7E,0x00,0x7E,0x00,0x3C,</span></span>
<span class="line"><span>		0x42,0x42,0x42,0x42,0x00,0x7E,0x42,0x42,0x42,0x7E,0x00,0x7E,0x04,0x08,0x10,0x7E,/*&quot;C:\Users\HP\Desktop\UNICORN.BMP&quot;,0*/</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>};</span></span></code></pre></div><h2 id="eeprom" tabindex="-1">EEPROM <a class="header-anchor" href="#eeprom" aria-label="Permalink to &quot;EEPROM&quot;">​</a></h2><h3 id="at24c16" tabindex="-1">AT24C16 <a class="header-anchor" href="#at24c16" aria-label="Permalink to &quot;AT24C16&quot;">​</a></h3><p>AT24c16 一共16Kbit，也就是2K Byte；每页大小16byte，一共128页。</p><p>参考：[AT24C16-STM32-HAL库函数读写_stm32 读写at24c16a-CSDN博客](<a href="https://blog.csdn.net/gu2188/article/details/136572334?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=" target="_blank" rel="noreferrer">https://blog.csdn.net/gu2188/article/details/136572334?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=</a> HAL库AT24C16代码&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-136572334.142^v102^pc_search_result_base3&amp;spm=1018.2226.3001.4187)</p><p>头文件 at24c16.h</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#ifndef _AT24C16_H_</span></span>
<span class="line"><span>#define _AT24C16_H_</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>#include &quot;main.h&quot;</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>#define AT24C16_DEVICE_ADDRESS 0xA0</span><span> // AT24C16的IIC地址</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>uint16_t AT24C16_ADDRESS_2(uint16_t page, uint16_t bit);</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>HAL_StatusTypeDef AT24C16_Write(uint16_t address, uint8_t *data, uint16_t size);</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>HAL_StatusTypeDef AT24C16_Read(uint16_t address, uint8_t *rx_buffer, uint16_t size);</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>HAL_StatusTypeDef AT24C16_Write_String(uint16_t address, uint8_t *data);</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>HAL_StatusTypeDef AT24C16_Read_String(uint16_t address, uint8_t *data, uint16_t size);</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>#endif</span></span></code></pre></div><p>at24c16.c</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#include &quot;main.h&quot;</span></span>
<span class="line"><span>#include &quot;i2c.h&quot;</span></span>
<span class="line"><span>#include &quot;gpio.h&quot;</span></span>
<span class="line"><span>#include &quot;at24c16.h&quot;</span></span>
<span class="line"><span>#include &quot;stddef.h&quot;</span></span>
<span class="line"><span>/*</span></span>
<span class="line"><span> *	地址转换，将十进制地址转换成二进制地址</span></span>
<span class="line"><span> *	@page:页数</span></span>
<span class="line"><span> *  @bit:字节位</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>uint16_t AT24C16_ADDRESS_2(uint16_t page, uint16_t bit)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	return ((page &lt;&lt; 4) | bit);</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>/*</span></span>
<span class="line"><span> *	写函数</span></span>
<span class="line"><span> *	@address:二进制地址</span></span>
<span class="line"><span> * 	@data:数据地址</span></span>
<span class="line"><span> *  @size:数量</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>HAL_StatusTypeDef AT24C16_Write(uint16_t address, uint8_t *data, uint16_t size)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	HAL_StatusTypeDef state = HAL_OK;</span></span>
<span class="line"><span>	uint8_t add = ((address &gt;&gt; 7) &amp; 0x000e);</span></span>
<span class="line"><span>	add = AT24C16_DEVICE_ADDRESS | add;</span></span>
<span class="line"><span>	state = HAL_I2C_Mem_Write(&amp;hi2c1, add, (uint8_t)address, I2C_MEMADD_SIZE_8BIT, data, size, 100);</span></span>
<span class="line"><span>	return state;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>/*</span></span>
<span class="line"><span> *	读函数</span></span>
<span class="line"><span> *	@address:二进制地址</span></span>
<span class="line"><span> * 	@data:数据地址</span></span>
<span class="line"><span> *  @size:数量</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>HAL_StatusTypeDef AT24C16_Read(uint16_t address, uint8_t *rx_buffer, uint16_t size)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	HAL_StatusTypeDef state = HAL_OK;</span></span>
<span class="line"><span>	uint8_t add = ((address &gt;&gt; 7) &amp; 0x000e);</span></span>
<span class="line"><span>	add = AT24C16_DEVICE_ADDRESS | add;</span></span>
<span class="line"><span>	state = HAL_I2C_Mem_Read(&amp;hi2c1, add, (uint8_t)address, I2C_MEMADD_SIZE_8BIT, rx_buffer, size, 100);</span></span>
<span class="line"><span>	return state;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>/*</span></span>
<span class="line"><span> *	连续写函数,没有实现任意字节</span></span>
<span class="line"><span> *	@address:地址（简单实现连续页）</span></span>
<span class="line"><span> *	@data:数据地址</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>HAL_StatusTypeDef AT24C16_Write_String(uint16_t address, uint8_t *data)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	HAL_StatusTypeDef state = HAL_OK;</span></span>
<span class="line"><span>	uint16_t i = sizeof(data) / 16;</span></span>
<span class="line"><span>	(sizeof(data) % 16 != 0) ? i++ : 0;</span></span>
<span class="line"><span>	uint16_t j = address &gt;&gt; 4;</span></span>
<span class="line"><span>	for (int k = 0; k &lt; i; k++)</span></span>
<span class="line"><span>	{</span></span>
<span class="line"><span>		state = AT24C16_Write(AT24C16_ADDRESS_2(j + k, 0), (uint8_t *)&amp;data[i * 16], 16);</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>	return state;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>/*</span></span>
<span class="line"><span> *	连续读函数,没有实现任意字节</span></span>
<span class="line"><span> *	@address:地址（简单实现连续页）</span></span>
<span class="line"><span> *	@data:数据地址</span></span>
<span class="line"><span> *  @size:数量</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>HAL_StatusTypeDef AT24C16_Read_String(uint16_t address, uint8_t *data, uint16_t size)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	HAL_StatusTypeDef state = HAL_OK;</span></span>
<span class="line"><span>	uint16_t i = size / 16;</span></span>
<span class="line"><span>	(size % 16 != 0) ? i++ : 0;</span></span>
<span class="line"><span>	uint16_t j = address &gt;&gt; 4;</span></span>
<span class="line"><span>	for (int k = 0; k &lt; i; k++)</span></span>
<span class="line"><span>	{</span></span>
<span class="line"><span>		state = AT24C16_Read(AT24C16_ADDRESS_2(j + k, 0), (uint8_t *)&amp;data[i * 16], 16);</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>	return state;</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>使用</p><img src="/XIAOHUANG_BLOG/assets/image-20250319234001106_1.CfV5eiyt.png" alt="image-20250319234001106" style="zoom:50%;"><p>使用AT24C16_Write、AT24C16_Read</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>  char message[100] = &quot;@nihao=1.2345$111\n&quot;;</span></span>
<span class="line"><span>  char eeprom_readmessage[100]=&quot;&quot;;</span></span>
<span class="line"><span>  /* USER CODE END 2 */</span></span>
<span class="line"><span>  /* Infinite loop */</span></span>
<span class="line"><span>  /* USER CODE BEGIN WHILE */</span></span>
<span class="line"><span>  while (1)</span></span>
<span class="line"><span>  {</span></span>
<span class="line"><span>	  HAL_ADC_Start(&amp;hadc1);</span></span>
<span class="line"><span>	  HAL_ADC_PollForConversion(&amp;hadc1, 20);</span></span>
<span class="line"><span>	  value=HAL_ADC_GetValue(&amp;hadc1);</span></span>
<span class="line"><span>	  voltage=(value/65536.0)*3.3;</span></span>
<span class="line"><span>	  sprintf(message,&quot;voltage=%.4f&quot;,voltage);</span></span>
<span class="line"><span>	  HAL_UART_Transmit(&amp;huart8, (uint8_t*)message, strlen(message),100);</span></span>
<span class="line"><span>	  OLED_ShowString(0, 1,message , strlen(message), 0);</span></span>
<span class="line"><span>	  //将message的内容写入eeprom</span></span>
<span class="line"><span>	  AT24C16_Write(AT24C16_ADDRESS_2(1, 0), (uint8_t*)message,strlen(message));</span></span>
<span class="line"><span>	  HAL_Delay(100);</span></span>
<span class="line"><span>	  //将message从eeprom读出并显示</span></span>
<span class="line"><span>	  AT24C16_Read(AT24C16_ADDRESS_2(1, 0), (uint8_t*)eeprom_readmessage,strlen(message));</span></span>
<span class="line"><span>	  HAL_Delay(100);</span></span>
<span class="line"><span>	  OLED_ShowString(0, 2,eeprom_readmessage , strlen(eeprom_readmessage), 0);</span></span>
<span class="line"><span>	  HAL_Delay(100);</span></span>
<span class="line"><span>    /* USER CODE END WHILE */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    /* USER CODE BEGIN 3 */</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  /* USER CODE END 3 */</span></span></code></pre></div><img src="/XIAOHUANG_BLOG/assets/image-20250319235736910_1.BleIQ1r-.png" alt="image-20250319235736910" style="zoom:67%;"><h2 id="microsd" tabindex="-1">microSD <a class="header-anchor" href="#microsd" aria-label="Permalink to &quot;microSD&quot;">​</a></h2><p>参考：<a href="https://blog.csdn.net/zhuguanlin121/article/details/131146261?ops_request_misc=%7B%22request%5Fid%22%3A%2227246d8d55258df3b6b5727c2419e101%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=27246d8d55258df3b6b5727c2419e101&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-131146261-null-null.142%5Ev102%5Epc_search_result_base3&amp;utm_term=stm32hal%E5%BA%93sd%E5%8D%A1&amp;spm=1018.2226.3001.4187" target="_blank" rel="noreferrer">正点原子STM32(基于HAL库5) —— SRAM、SD卡、FATFS-CSDN博客</a></p><p>主要参考：【STM32+FATFS读写TF卡（SDIO方式）】<a href="https://www.bilibili.com/video/BV1EC4y1c73j?vd_source=b7ec3648f866bae76c4b07907d1dae5e" target="_blank" rel="noreferrer">https://www.bilibili.com/video/BV1EC4y1c73j?vd_source=b7ec3648f866bae76c4b07907d1dae5e</a></p><p>参考：<a href="https://blog.csdn.net/oDuanYanGuHong/article/details/120891487?ops_request_misc=%7B%22request%5Fid%22%3A%22655ee35107ff02d9efb97820598c5592%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=655ee35107ff02d9efb97820598c5592&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-120891487-null-null.142%5Ev102%5Epc_search_result_base3&amp;utm_term=stm32h743cubemx%E9%85%8D%E7%BD%AEsd%E5%8D%A1&amp;spm=1018.2226.3001.4187" target="_blank" rel="noreferrer">1.30 Cubemx_STM32H743 SD_Card纳入文件管理系统_stm32h743 sd卡-CSDN博客</a></p><h3 id="基本配置" tabindex="-1">基本配置 <a class="header-anchor" href="#基本配置" aria-label="Permalink to &quot;基本配置&quot;">​</a></h3><img src="/XIAOHUANG_BLOG/assets/image-20250323232358918_1.DVC3sj5X.png" alt="image-20250323232358918" style="zoom:67%;"><p><img src="/XIAOHUANG_BLOG/assets/image-20250323232423500_1.3n3ZX31X.png" alt="image-20250323232423500" loading="lazy"></p><ul><li>FATFS配置</li></ul><img src="/XIAOHUANG_BLOG/assets/image-20250323232531638_1.LEGLNopV.png" alt="image-20250323232531638" style="zoom:50%;"><p>设置一个引脚作为SD卡的插入信号，默认拉低（输入模式）</p><img src="/XIAOHUANG_BLOG/assets/image-20250323232715654_1.DL0onAZl.png" alt="image-20250323232715654" style="zoom:67%;"><img src="/XIAOHUANG_BLOG/assets/image-20250323232628793_1.BnHgR4fD.png" alt="image-20250323232628793" style="zoom:67%;"><ul><li>sdmmc.c的初始化配置添加代码</li></ul><img src="/XIAOHUANG_BLOG/assets/image-20250323233134996_1.CbtOmXUi.png" alt="image-20250323233134996" style="zoom:67%;"><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>void MX_SDMMC1_SD_Init(void)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  /* USER CODE BEGIN SDMMC1_Init 0 */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  /* USER CODE END SDMMC1_Init 0 */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  /* USER CODE BEGIN SDMMC1_Init 1 */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  /* USER CODE END SDMMC1_Init 1 */</span></span>
<span class="line"><span>  hsd1.Instance = SDMMC1;</span></span>
<span class="line"><span>  hsd1.Init.ClockEdge = SDMMC_CLOCK_EDGE_RISING;</span></span>
<span class="line"><span>  hsd1.Init.ClockPowerSave = SDMMC_CLOCK_POWER_SAVE_DISABLE;</span></span>
<span class="line"><span>  hsd1.Init.BusWide = SDMMC_BUS_WIDE_4B;</span></span>
<span class="line"><span>  hsd1.Init.HardwareFlowControl = SDMMC_HARDWARE_FLOW_CONTROL_DISABLE;</span></span>
<span class="line"><span>  hsd1.Init.ClockDiv = 4;</span></span>
<span class="line"><span>  /* USER CODE BEGIN SDMMC1_Init 2 */</span></span>
<span class="line"><span>//  hsd1.Init.BusWide=SDMMC_BUS_WIDE_1B;</span></span>
<span class="line"><span>  if(HAL_SD_Init(&amp;hsd1) !=HAL_OK){</span></span>
<span class="line"><span>	  Error_Handler();</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  if(HAL_SD_ConfigWideBusOperation(&amp;hsd1, SDMMC_BUS_WIDE_4B)!=HAL_OK){</span></span>
<span class="line"><span>	  Error_Handler();</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  /* USER CODE END SDMMC1_Init 2 */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span></code></pre></div><h3 id="往sd中写入" tabindex="-1">往SD中写入 <a class="header-anchor" href="#往sd中写入" aria-label="Permalink to &quot;往SD中写入&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>  //SD挂载，在外部 SD 卡挂载文件系统，文件系统挂载时会对 SD 卡初始化</span></span>
<span class="line"><span>  f_res = f_mount(&amp;fs, &quot;0:&quot;, 1);</span></span>
<span class="line"><span>  //SD格式化挂载测试</span></span>
<span class="line"><span>  if(f_res == FR_NO_FILESYSTEM)//如果没有文件系统就格式化创建创建文件系统</span></span>
<span class="line"><span>  {</span></span>
<span class="line"><span>	  /* 格式化 */</span></span>
<span class="line"><span>	  f_res = f_mkfs(&quot;0:&quot;, FM_FAT, 0,make_buffer,sizeof(make_buffer));</span></span>
<span class="line"><span>//	  __NOP();</span></span>
<span class="line"><span>	  if(f_res == FR_OK)</span></span>
<span class="line"><span>	  { //成功创建文件系统</span></span>
<span class="line"><span>		  /* 格式化后，先取消挂载 */</span></span>
<span class="line"><span>		  f_res = f_mount(NULL, &quot;0:&quot;, 1);</span></span>
<span class="line"><span>		  /* 重新挂载 */</span></span>
<span class="line"><span>		  f_res = f_mount(&amp;fs, &quot;0:&quot;, 1);</span></span>
<span class="line"><span>	  }</span></span>
<span class="line"><span>	  else</span></span>
<span class="line"><span>	  {//格式化失败</span></span>
<span class="line"><span>		  while(1);</span></span>
<span class="line"><span>	  }</span></span>
<span class="line"><span>  }else if(f_res != FR_OK){ //如果存在文件系统,但不生效</span></span>
<span class="line"><span>	  while(1);</span></span>
<span class="line"><span>  }else{</span></span>
<span class="line"><span>	  //已存在格式化文件系统，并能正常使用</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  //SD文件写入测试，在STM32H7.txt(不存在则默认创建)中写入&quot;Hello STM32H723ZGT6!&quot;</span></span>
<span class="line"><span>  f_res = f_open(&amp;file, &quot;0:STM32H7.txt&quot;, FA_CREATE_ALWAYS | FA_WRITE);</span></span>
<span class="line"><span>  if(f_res == FR_OK)</span></span>
<span class="line"><span>  { //成功打开文件</span></span>
<span class="line"><span>	  /* 将指定存储区内容写入到文件内 */</span></span>
<span class="line"><span>	  sprintf(writesd_buffer,&quot;Hello STM32H723ZGT6!&quot;);</span></span>
<span class="line"><span>	  f_res = f_write(&amp;file, writesd_buffer, strlen(writesd_buffer), &amp;fnum);</span></span>
<span class="line"><span>	  if(f_res == FR_OK)</span></span>
<span class="line"><span>	  {//写入成功</span></span>
<span class="line"><span>	  }</span></span>
<span class="line"><span>	  else</span></span>
<span class="line"><span>	  {//写入不成功</span></span>
<span class="line"><span>		  while(1);</span></span>
<span class="line"><span>	  }</span></span>
<span class="line"><span>	  /* 不再读写，关闭文件 */</span></span>
<span class="line"><span>	  f_close(&amp;file);</span></span>
<span class="line"><span>  }else{</span></span>
<span class="line"><span>	  while(1);</span></span>
<span class="line"><span>  }</span></span></code></pre></div><h3 id="往sd中读出" tabindex="-1">往SD中读出 <a class="header-anchor" href="#往sd中读出" aria-label="Permalink to &quot;往SD中读出&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span></span></span></code></pre></div><h2 id="mpu6050-i2c" tabindex="-1">MPU6050（I2C） <a class="header-anchor" href="#mpu6050-i2c" aria-label="Permalink to &quot;MPU6050（I2C）&quot;">​</a></h2><p>参考：<a href="https://www.cnblogs.com/lc-guo/p/17965519" target="_blank" rel="noreferrer">STM32CubeMX教程19 I2C - MPU6050驱动 - OSnotes - 博客园</a></p><p>参考（更详细）:[STM32CubeMX驱动MPU6050模块_mpu6050 stm32cubemx-CSDN博客](<a href="https://blog.csdn.net/qq_52158753/article/details/130390227?ops_request_misc=%7B%22request%5Fid%22%3A%22a1c9ed7a52f265124361fd2700186761%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fall.%22%7D&amp;request_id=a1c9ed7a52f265124361fd2700186761&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-130390227-null-null.142%5Ev101%5Epc_search_result_base3&amp;utm_term=cubmx" target="_blank" rel="noreferrer">https://blog.csdn.net/qq_52158753/article/details/130390227?ops_request_misc={&quot;request_id&quot;%3A&quot;a1c9ed7a52f265124361fd2700186761&quot;%2C&quot;scm&quot;%3A&quot;20140713.130102334.pc_all.&quot;}&amp;request_id=a1c9ed7a52f265124361fd2700186761&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-130390227-null-null.142^v101^pc_search_result_base3&amp;utm_term=cubmx</a> mpu6050姿态解算&amp;spm=1018.2226.3001.4187)</p><p>MPU6050是由InvenSense公司生产的全球首款整合性六轴运动处理模块，它可以实时获取运动物体的在<a href="https://so.csdn.net/so/search?q=%E4%B8%89%E7%BB%B4%E5%9D%90%E6%A0%87%E7%B3%BB&amp;spm=1001.2101.3001.7020" target="_blank" rel="noreferrer">三维坐标系</a>内的偏转角度，如图所示。</p><img src="https://i-blog.csdnimg.cn/blog_migrate/dbbfc694f8f2eed90851568cb7c50a0a.png" alt="MPU6050偏转角度示意图" style="zoom:50%;"><p>其中roll为绕X轴偏转的角度，<a href="https://so.csdn.net/so/search?q=pitch&amp;spm=1001.2101.3001.7020" target="_blank" rel="noreferrer">pitch</a>为绕Y轴偏转的角度，yaw为绕Z轴偏转的角度。</p><img src="/XIAOHUANG_BLOG/assets/image-20250219190345088_1.uUyGwedt.png" alt="image-20250219190345088" style="zoom:33%;"><p>采样默认8K赫兹</p><img src="/XIAOHUANG_BLOG/assets/image-20250219190624014_1.QZlI3FSx.png" alt="image-20250219190624014" style="zoom:50%;"><h3 id="主要数据" tabindex="-1">主要数据 <a class="header-anchor" href="#主要数据" aria-label="Permalink to &quot;主要数据&quot;">​</a></h3><img src="/XIAOHUANG_BLOG/assets/image-20250219190715196_1.Be5tuDpn.png" alt="image-20250219190715196" style="zoom:67%;"><img src="/XIAOHUANG_BLOG/assets/image-20250219190840359_1.DwD9_UIr.png" alt="image-20250219190840359" style="zoom:80%;"><h3 id="接线" tabindex="-1">接线 <a class="header-anchor" href="#接线" aria-label="Permalink to &quot;接线&quot;">​</a></h3><p>VCC-电源正极，通常接3.3V GND-电源地 SCL-IIC的时钟线 SDA-IIC的数据线 XDA-外接IIC设备的数据线 XCL-外接IIC设备的时钟线 AD0-控制IIC从属地址，接地时地址为0X68，如果接VCC的话，从属地址为0X69 INT-中断数字输出</p><img src="data:image/png;base64,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" alt="image-20250118152017505" style="zoom:33%;"><h3 id="程序" tabindex="-1">程序 <a class="header-anchor" href="#程序" aria-label="Permalink to &quot;程序&quot;">​</a></h3><p>主程序</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>	  int16_t ax,ay,az,gx,gy,gz;</span></span>
<span class="line"><span>      char buffer[100]; //用于显示</span></span>
<span class="line"><span>      while(MPU6050_Init(&amp;hi2c1) != HAL_OK){HAL_Delay(1);} //等待mpu6050接通</span></span>
<span class="line"><span>	  while(1){</span></span>
<span class="line"><span>	  MPU_Get_RAW_Gyroscope(&amp;ax,&amp;ay,&amp;az);  //读取数据</span></span>
<span class="line"><span>	  MPU_Get_RAW_Accelerometer(&amp;gx,&amp;gy,&amp;gz);  //读取</span></span>
<span class="line"><span>	  // 每次调用 sprintf 前先清空缓冲区</span></span>
<span class="line"><span>	  memset(buffer, 0, sizeof(buffer));</span></span>
<span class="line"><span>	  // 使用 snprintf 格式化字符串</span></span>
<span class="line"><span>	  snprintf(buffer, sizeof(buffer), &quot;ax:%d|ay:%d|az:%d&quot;, ax, ay, az);</span></span>
<span class="line"><span>	  // 然后将 buffer 传递给绘制函数</span></span>
<span class="line"><span>	  Gui_DrawFont_GBK16(10, 30, BLUE, GRAY0, buffer);</span></span>
<span class="line"><span>	  memset(buffer, 0, sizeof(buffer));</span></span>
<span class="line"><span>	  // 使用 snprintf 格式化字符串</span></span>
<span class="line"><span>	  snprintf(buffer, sizeof(buffer), &quot;gx:%d|gy:%d|gz:%d&quot;, gx,gy,gz);</span></span>
<span class="line"><span>	  // 然后将 buffer 传递给绘制函数</span></span>
<span class="line"><span>	  Gui_DrawFont_GBK16(10, 30+3*16, BLUE, GRAY0, buffer);</span></span>
<span class="line"><span>	  }</span></span></code></pre></div><h2 id="维特智能陀螺仪" tabindex="-1">维特智能陀螺仪 <a class="header-anchor" href="#维特智能陀螺仪" aria-label="Permalink to &quot;维特智能陀螺仪&quot;">​</a></h2><p>官网：<a href="https://www.wit-motion.cn/file.html" target="_blank" rel="noreferrer">产品资料-维特智能-倾角传感器,姿态传感器,陀螺仪,IMU,加速度计,惯性导航,RTK定位</a></p><img src="/XIAOHUANG_BLOG/assets/image-20250322172456481_1.DeWecboM.png" alt="image-20250322172456481" style="zoom:33%;"><p>数据解析网站：</p><img src="/XIAOHUANG_BLOG/assets/image-20250322172831210_1.CeXBu9_Y.png" alt="image-20250322172831210" style="zoom:50%;"><h3 id="jy61p" tabindex="-1">JY61P <a class="header-anchor" href="#jy61p" aria-label="Permalink to &quot;JY61P&quot;">​</a></h3><p>参考：[stm32通过串口读取JY61 JY62数据（HAL库）-CSDN博客](<a href="https://blog.csdn.net/2301_79779075/article/details/143065030?ops_request_misc=%7B%22request%5Fid%22%3A%22b8dd050ddbcfba1d3966c7d0811aa82a%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=b8dd050ddbcfba1d3966c7d0811aa82a&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-143065030-null-null.142%5Ev102%5Epc_search_result_base3&amp;utm_term=jy61p" target="_blank" rel="noreferrer">https://blog.csdn.net/2301_79779075/article/details/143065030?ops_request_misc={&quot;request_id&quot;%3A&quot;b8dd050ddbcfba1d3966c7d0811aa82a&quot;%2C&quot;scm&quot;%3A&quot;20140713.130102334..&quot;}&amp;request_id=b8dd050ddbcfba1d3966c7d0811aa82a&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-143065030-null-null.142^v102^pc_search_result_base3&amp;utm_term=jy61p</a> 串口 stm32&amp;spm=1018.2226.3001.4187)</p><p>标准库与HAL库实现：<a href="https://gitcode.csdn.net/66c59176101644163365562b.html?dp_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6MzMxODk1NiwiZXhwIjoxNzQzMzU0Mzc5LCJpYXQiOjE3NDI3NDk1NzksInVzZXJuYW1lIjoieGlhb2h1YW5nbW9ua2V5In0.qzo354AhwLJW03mPjOk-5dvfIkkDmxuH-GwxIRADYug&amp;spm=1001.2101.3001.6650.6&amp;utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~activity-6-127771234-blog-133444574.235%5Ev43%5Epc_blog_bottom_relevance_base2&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~activity-6-127771234-blog-133444574.235%5Ev43%5Epc_blog_bottom_relevance_base2&amp;utm_relevant_index=9" target="_blank" rel="noreferrer">STM32实现六轴姿态测量陀螺仪模块JY61P（标准库与HAL库实现）_小材大用-GitCode 开源社区</a></p><h4 id="修改波特率" tabindex="-1">修改波特率 <a class="header-anchor" href="#修改波特率" aria-label="Permalink to &quot;修改波特率&quot;">​</a></h4><p>参考：<a href="https://wit-motion.yuque.com/wumwnr/ltst03/vl3tpy#k4CnY" target="_blank" rel="noreferrer">WIT私有协议</a></p><p>1.解锁：FF AA 69 88 B5</p><p>1.1延时200ms</p><p>2.修改波特率：FF AA 04 06 00</p><p>2.1切换已修改的波特率然后重新发送解锁和保存指令</p><p>2.2解锁：FF AA 69 88 B5</p><p>2.3延时200ms</p><p>4.保存: FF AA 00 00 00</p><h3 id="imu63" tabindex="-1">IMU63 <a class="header-anchor" href="#imu63" aria-label="Permalink to &quot;IMU63&quot;">​</a></h3><p>参考：<a href="https://wit-motion.yuque.com/wumwnr/docs/meggs4ct2gthmtda#" target="_blank" rel="noreferrer">WT-IMU63产品规格书</a></p><p>基本参数：</p><img src="/XIAOHUANG_BLOG/assets/image-20250322173306062_1.DKAqCPYj.png" alt="image-20250322173306062" style="zoom:67%;"><img src="/XIAOHUANG_BLOG/assets/image-20250322173328141_1.C8GFPFOl.png" alt="image-20250322173328141" style="zoom:67%;"><h2 id="spi" tabindex="-1">SPI <a class="header-anchor" href="#spi" aria-label="Permalink to &quot;SPI&quot;">​</a></h2><h2 id="can" tabindex="-1">CAN <a class="header-anchor" href="#can" aria-label="Permalink to &quot;CAN&quot;">​</a></h2><h2 id="usb" tabindex="-1">USB <a class="header-anchor" href="#usb" aria-label="Permalink to &quot;USB&quot;">​</a></h2><h3 id="usb虚拟串口打印" tabindex="-1">USB虚拟串口打印 <a class="header-anchor" href="#usb虚拟串口打印" aria-label="Permalink to &quot;USB虚拟串口打印&quot;">​</a></h3><p>usb模拟串口，使用串口重定向打印（typeC）</p><p>参考：[STM32+USB串口通信+printf函数功能HAL库函数+cubemax配置+部分解释_stm32 usb通信-CSDN博客](<a href="https://blog.csdn.net/m0_66709017/article/details/136891157?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=stm32h7" target="_blank" rel="noreferrer">https://blog.csdn.net/m0_66709017/article/details/136891157?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=stm32h7</a> usb打印数据&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-136891157.142^v102^pc_search_result_base3&amp;spm=1018.2226.3001.4187)</p><h2 id="rs485" tabindex="-1">RS485 <a class="header-anchor" href="#rs485" aria-label="Permalink to &quot;RS485&quot;">​</a></h2><h2 id="lvgl-界面设计" tabindex="-1">lvgl 界面设计 <a class="header-anchor" href="#lvgl-界面设计" aria-label="Permalink to &quot;lvgl 界面设计&quot;">​</a></h2><h2 id="_8针spi显示屏" tabindex="-1">8针SPI显示屏 <a class="header-anchor" href="#_8针spi显示屏" aria-label="Permalink to &quot;8针SPI显示屏&quot;">​</a></h2><p>引脚</p><img src="/XIAOHUANG_BLOG/assets/image-20250118140507928_1.CRzPCvLL.png" alt="image-20250118140507928" style="zoom:50%;"><p>或者</p><img src="/XIAOHUANG_BLOG/assets/image-20250118140852616_1.C_tSvKxm.png" alt="image-20250118140852616" style="zoom:67%;"><h3 id="f1的keil移植到f4中" tabindex="-1">f1的keil移植到f4中 <a class="header-anchor" href="#f1的keil移植到f4中" aria-label="Permalink to &quot;f1的keil移植到f4中&quot;">​</a></h3><h4 id="操作宏修改-bsrr等-转hal库" tabindex="-1">操作宏修改（BSRR等，转HAL库） <a class="header-anchor" href="#操作宏修改-bsrr等-转hal库" aria-label="Permalink to &quot;操作宏修改（BSRR等，转HAL库）&quot;">​</a></h4><p>原始</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>////液晶控制口置1操作语句宏定义</span></span>
<span class="line"><span>//#define	LCD_SCL_SET  	LCD_CTRLA-&gt;BSRR=LCD_SCL</span></span>
<span class="line"><span>//#define	LCD_SDA_SET  	LCD_CTRLA-&gt;BSRR=LCD_SDA</span></span>
<span class="line"><span>//#define	LCD_CS_SET  	LCD_CTRLA-&gt;BSRR=LCD_CS</span></span>
<span class="line"><span>//</span></span>
<span class="line"><span>//#define	LCD_LED_SET  	LCD_CTRLB-&gt;BSRR=LCD_LED</span></span>
<span class="line"><span>//#define	LCD_RS_SET  	LCD_CTRLB-&gt;BSRR=LCD_RS</span></span>
<span class="line"><span>//#define	LCD_RST_SET  	LCD_CTRLB-&gt;BSRR=LCD_RST</span></span>
<span class="line"><span>////液晶控制口置0操作语句宏定义</span></span>
<span class="line"><span>//#define	LCD_SCL_CLR  	LCD_CTRLA-&gt;BRR=LCD_SCL</span></span>
<span class="line"><span>//#define	LCD_SDA_CLR  	LCD_CTRLA-&gt;BRR=LCD_SDA</span></span>
<span class="line"><span>//#define	LCD_CS_CLR  	LCD_CTRLA-&gt;BRR=LCD_CS</span></span>
<span class="line"><span>//</span></span>
<span class="line"><span>//#define	LCD_LED_CLR  	LCD_CTRLB-&gt;BRR=LCD_LED</span></span>
<span class="line"><span>//#define	LCD_RST_CLR  	LCD_CTRLB-&gt;BRR=LCD_RST</span></span>
<span class="line"><span>//#define	LCD_RS_CLR  	LCD_CTRLB-&gt;BRR=LCD_RS</span></span></code></pre></div><p>修改后</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>// 设置液晶控制口为高电平操作宏定义</span></span>
<span class="line"><span>#define LCD_SCL_SET    HAL_GPIO_WritePin(LCD_CTRLA, LCD_SCL, GPIO_PIN_SET)</span></span>
<span class="line"><span>#define LCD_SDA_SET    HAL_GPIO_WritePin(LCD_CTRLA, LCD_SDA, GPIO_PIN_SET)</span></span>
<span class="line"><span>#define LCD_CS_SET     HAL_GPIO_WritePin(LCD_CTRLA, LCD_CS, GPIO_PIN_SET)</span></span>
<span class="line"><span>#define LCD_LED_SET    HAL_GPIO_WritePin(LCD_CTRLB, LCD_LED, GPIO_PIN_SET)</span></span>
<span class="line"><span>#define LCD_RS_SET     HAL_GPIO_WritePin(LCD_CTRLC, LCD_RS, GPIO_PIN_SET)</span></span>
<span class="line"><span>#define LCD_RST_SET    HAL_GPIO_WritePin(LCD_CTRLC, LCD_RST, GPIO_PIN_SET)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 设置液晶控制口为低电平操作宏定义</span></span>
<span class="line"><span>#define LCD_SCL_CLR    HAL_GPIO_WritePin(LCD_CTRLA, LCD_SCL, GPIO_PIN_RESET)</span></span>
<span class="line"><span>#define LCD_SDA_CLR    HAL_GPIO_WritePin(LCD_CTRLA, LCD_SDA, GPIO_PIN_RESET)</span></span>
<span class="line"><span>#define LCD_CS_CLR     HAL_GPIO_WritePin(LCD_CTRLA, LCD_CS, GPIO_PIN_RESET)</span></span>
<span class="line"><span>#define LCD_LED_CLR    HAL_GPIO_WritePin(LCD_CTRLB, LCD_LED, GPIO_PIN_RESET)</span></span>
<span class="line"><span>#define LCD_RST_CLR    HAL_GPIO_WritePin(LCD_CTRLC, LCD_RST, GPIO_PIN_RESET)</span></span>
<span class="line"><span>#define LCD_RS_CLR     HAL_GPIO_WritePin(LCD_CTRLC, LCD_RS, GPIO_PIN_RESET)</span></span></code></pre></div><h4 id="gpio初始化修改" tabindex="-1">GPIO初始化修改 <a class="header-anchor" href="#gpio初始化修改" aria-label="Permalink to &quot;GPIO初始化修改&quot;">​</a></h4><h3 id="字模" tabindex="-1">字模 <a class="header-anchor" href="#字模" aria-label="Permalink to &quot;字模&quot;">​</a></h3><p>软件地址：</p><h4 id="_16-16" tabindex="-1">16*16 <a class="header-anchor" href="#_16-16" aria-label="Permalink to &quot;16*16&quot;">​</a></h4><img src="/XIAOHUANG_BLOG/assets/image-20250118170309298_1.wzS9dNZ5.png" alt="image-20250118170309298" style="zoom:50%;"><p>示例</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>const struct typFNT_GB162 hz16[] = {</span></span>
<span class="line"><span>#if USE_ONCHIP_FLASH_FONT</span></span>
<span class="line"><span>&quot;测&quot;,0x00,0x04,0x27,0xC4,0x14,0x44,0x14,0x54,0x85,0x54,0x45,0x54,0x45,0x54,0x15,0x54,0x15,0x54,0x25,0x54,0xE5,0x54,0x21,0x04,0x22,0x84,0x22,0x44,0x24,0x14,0x08,0x08,</span></span>
<span class="line"><span>&quot;量&quot;,0x00,0x00,0x1F,0xF0,0x10,0x10,0x1F,0xF0,0x10,0x10,0xFF,0xFE,0x00,0x00,0x1F,0xF0,0x11,0x10,0x1F,0xF0,0x11,0x10,0x1F,0xF0,0x01,0x00,0x1F,0xF0,0x01,0x00,0x7F,0xFC,</span></span>
<span class="line"><span>&quot;数&quot;,0x08,0x20,0x49,0x20,0x2A,0x20,0x08,0x3E,0xFF,0x44,0x2A,0x44,0x49,0x44,0x88,0xA4,0x10,0x28,0xFE,0x28,0x22,0x10,0x42,0x10,0x64,0x28,0x18,0x28,0x34,0x44,0xC2,0x82,</span></span>
<span class="line"><span>&quot;据&quot;,0x20,0x00,0x23,0xFC,0x22,0x04,0x22,0x04,0xFB,0xFC,0x22,0x20,0x22,0x20,0x2B,0xFE,0x32,0x20,0xE2,0x20,0x22,0xFC,0x22,0x84,0x22,0x84,0x24,0x84,0xA4,0xFC,0x48,0x84,</span></span>
<span class="line"><span>#endif</span></span>
<span class="line"><span>0x00,</span></span>
<span class="line"><span>};</span></span></code></pre></div><h4 id="字符与数据格式化输出" tabindex="-1">字符与数据格式化输出 <a class="header-anchor" href="#字符与数据格式化输出" aria-label="Permalink to &quot;字符与数据格式化输出&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>char buffer[100];  // 用于存储格式化后的字符串</span></span>
<span class="line"><span>sprintf(buffer, &quot;ax:%d,ay:%d,az:%d,&quot;, ax, ay, az);  // 格式化字符串</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Gui_DrawFont_GBK16(10, 10, BLUE, GRAY0, buffer);  // 传递格式化后的字符串</span></span></code></pre></div><h2 id="蓝牙-1" tabindex="-1">蓝牙 <a class="header-anchor" href="#蓝牙-1" aria-label="Permalink to &quot;蓝牙&quot;">​</a></h2><h3 id="hc-05" tabindex="-1">HC-05 <a class="header-anchor" href="#hc-05" aria-label="Permalink to &quot;HC-05&quot;">​</a></h3><p>HC05是主从一体的模块，也就是既可以作为从机（只能被别的模块请求连接），也可以作为主机（可以主动连接别的蓝牙模块）。配置蓝牙模块要使用AT命令操作。</p><p>指令集：<a href="https://www.cnblogs.com/fengliu-/p/7306306.html" target="_blank" rel="noreferrer">蓝牙HC-05与HC-06对比指令集 - feng..liu - 博客园</a></p><h3 id="hc-06" tabindex="-1">HC-06 <a class="header-anchor" href="#hc-06" aria-label="Permalink to &quot;HC-06&quot;">​</a></h3><p><strong>模块供电：</strong> 规格书写的工作电压为3.6V-6V。如果上电后蓝牙模块灯不亮，检查下电压是否满足要求。</p><img src="/XIAOHUANG_BLOG/assets/image-20250118203911179_1.IPMvdAC8.png" alt="image-20250118203911179" style="zoom:67%;"><h4 id="引脚" tabindex="-1">引脚 <a class="header-anchor" href="#引脚" aria-label="Permalink to &quot;引脚&quot;">​</a></h4><p><img src="data:image/png;base64,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" alt="image-20250118204546670" loading="lazy"></p><p>主程序</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>  uint8_t Data = 0;</span></span>
<span class="line"><span>  while(1){</span></span>
<span class="line"><span>  {</span></span>
<span class="line"><span>		  HAL_UART_Receive(&amp;huart5, &amp;Data, 1, 0xffff);		//阻塞接收，接收超时时间设为0xffff</span></span>
<span class="line"><span>//		  HAL_UART_Transmit(&amp;huart5, (uint8_t *)&amp;Data, 1, 0xffff);//阻塞发送，发送超时时间设为0xffff</span></span>
<span class="line"><span>		  HAL_UART_Transmit(&amp;huart5, &quot;recieved&quot;, 8, 0xffff);//阻塞发送，发送超时时间设为0xffff</span></span>
<span class="line"><span>  }</span></span></code></pre></div><h4 id="hc06指令集" tabindex="-1">HC06指令集 <a class="header-anchor" href="#hc06指令集" aria-label="Permalink to &quot;HC06指令集&quot;">​</a></h4><p>HC06和HC05参考指令链接：<a href="https://www.cnblogs.com/fengliu-/p/7306306.html" target="_blank" rel="noreferrer">蓝牙HC-05与HC-06对比指令集 - feng..liu - 博客园</a></p><ul><li>AT</li></ul><p>首先输入AT（无空格回车），然后串口助手会返回OK</p><ul><li>AT+BAUDx</li></ul><p>修改波特率时输入AT+BAUDx（x为波特率编号），串口助手会返回OKnnnn（nnnn是你设置的波特率）</p><p>注意，在这之后若还做其他命令操作，必须先断开连接，修改串口助手的波特率为刚刚设置的波特率，然后再打开串口继续操作。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>波特率标号对应表：</span></span>
<span class="line"><span>1---------1200</span></span>
<span class="line"><span>2---------2400</span></span>
<span class="line"><span>3---------4800</span></span>
<span class="line"><span>4---------9600(默认)</span></span>
<span class="line"><span>5---------19200</span></span>
<span class="line"><span>6---------38400</span></span>
<span class="line"><span>7---------57600</span></span>
<span class="line"><span>8---------115200</span></span>
<span class="line"><span>9---------230400</span></span>
<span class="line"><span>A---------460800</span></span>
<span class="line"><span>B---------921600</span></span>
<span class="line"><span>C---------1382400</span></span></code></pre></div><p>如</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>AT+BAUD8</span></span></code></pre></div><ul><li>AT+NAMEname （改蓝牙名称）</li></ul><p>如</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>AT+NAMECARHC06</span></span></code></pre></div><p>返回</p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN8AAAAbCAIAAABz4s3ZAAAPaElEQVR4nO2ad3hU1bqH37X3lMxkkkkIaRBM6B0kdCKiUoQQUfBSFQRF4IB0vXKOBThWVATUWFCKHIoiNooSEAgloYkivYTeAyQhyQxT97p/JJBCMsm957nPzX2eeZ/8k7X2/n7ft+a3115rzQgpJX78VEmU/+sE/PgpF787/VRd/O70U3Xxu9NP1UVXXof3NrduI3QEB6MCoDnIsZdxpaInOMiXzR252D0YLFgMRXGMQQTqy9XCS14ubolqwmoCL7m5eCQ6M8EBOPOwue9JI4AQc9G/tkzOX0MEE1sLU7HkytCS2HNxeAEQ6AOwmBDFulwqVkthi+Ykx1ZUi28tTx5nzkMotWuUO9BeJzYPwYF3G6TLcelsbg4BMXHBIXdEvA5n7m1MwcaAwpw1R67rtlSDrXq1/IH//48sh/WjpU5IJVr+cL2w5fISGYrknj9rd3m2vChSSpec0UqC7DhLuqWUUp6bL62KnJLmS0telwMjJMiGk2W+lI49sqlOgnxsiZSa/KK7FPekUXeczJNSSpm5VfZtJFVR2K4Pl+O+lx4fWjY5sV5RHKFIaz054zfpkVLa5IR6slqSvHjn2mvfynAhR64v/NeH1rYZMlJX2B6eIDdeKzEqnmz5zSuyXW1pVGTdF2RuQav7yKIfmgTNhBkwQ7F83D/5Sr6UUnoPvDXfZFkw+6hWeLuW9XGXt4zxW/e7fIx8RVw8+Ex88gMvnsr+N2L871LOI21j/Rbq90Fdzy/76PsogL4Jc78GEA4+moDzaV58EEBYMEsK5hbPMV5+D29n3h/BnZkRzQuwbzl/TaS1ESRaRVqAlOhMXE7jjAdjOhd16D3cPf7SN+a9vxNa7DRMiUKFvB1078kRK+PmMzwB1xFmTmXvbnL6EiZ8aVV7iHefxSjJO8PCeczoR8geJtYCiSyRLlJSIOtDS65hyEz0SWx4E91WnpvKsBfYt5JoAHLS6deXLTeI68i4UbRqVRA4f8eW/qMPXGjWdtG8Nm2VzAUv/TJv8qqIBiM/6WZAFskCOPLPXPEY4yyh5b77KoHw3jxz/WyWVnVXd2VX5zzK5rN0mI7xEFtSsD+KGaq3ZlhrAO04n4LnPoYMK32/0NixnNs1KX6IqigENqbuJZbvpfUDldIqoHYi0XvYeZnAVJo/Tc7iorsktB9AB2PJWF4+epW/jMzZxKQmADTmxy44wwgWFWhJM4lDqQnAgJbE9+P79Yx/vvyR87KofK2lC7hYneXz6R4FLfhwN/1Ws/oco2ORlxk7iB1GPt7L2PhiKyL7hk8PHAmIm7ui5/AGCkR8sNR5OH7tt8knX+nWtJS258z59AtK7UE1ou6sQGxXbvz5R2bG5dsOTQ2sHty0Y2x8DV1h14XLqdsyr3hMDRPiOtULUIHc7D1/5TlteS7Akfvn9vMKIERAzYi2tY32i1f3n9Oim0UGnTu78U9bYN2YBztVCynIU+bvW3fxoqaarIH3NQivH31nXSEdGXsyryqWmrrr248aEp64z3zoxG+nAzr0rl0/iHLTqJCy3XlqMyeDmfYI5l9ZvIVjLuKLLbPuLMr+G6hhPFafVd8y/R53+tIKo1MNNv2G5SCd/86axffELYl2hu9/J3Yww5sUNRqrc9fDFdR1h9D6RBnIu1Vyjq+8Vh5pB7C2IiGysL19T0KXkXaA0bHs/4ofLzN8LS/E4/WgqSgCwH5j++82U/NOPesVGlaJq9evjXHjH2cP5jaNLqHt2r3k4H61xj/7RxgAT/ayEctGLbtplwghBEhj5PT0kfE1AOfON1b0mXnuhiYEUgpj25cGrX83LuTq8am9UnbYAFi+5uEVBWEDEheOXVvbmJe27YlhN3tPCNs89+gFL1Iqkb0Tt//cur4KHtu611dN/9MLINTIhA5LVnXtESmQtp8n/2uGsWGvq6fXnnBEP96y8f6jG844q/Xv/9fKJpHlpFGtgo+z7D27xo5NGO+nfSStu2I6weZTFURxZ7IrnfR09mSgCchmdzrp6ew6hgcAKXioHzk/knqTEl9O+dQSetoncPxn9qp0rltSUnBhH6mppKaydSsHrwLYznDWToO2hJSZZaXrOraek07qNSx8doWXY3vYuZOdOzl0ufAaX1p5nM8hOIbAK7wzhhk/YahJiODSRaTG9k1469M9n0fqEGgiKJpRy3BC3q2zWTI4NrT63Y9EBNSpE8Ct3Au3SkTPTt067uPMqP4PjGimAPnbd76+PCu8X6+tJ6fezJmWmzst+9KwqU1VwJ62beQbF8xJPdMvTcvN/NuykdbD89bP3uVWYluuODTxzB+JiaHEDHvycMaEjIwJGRmjPutjApBIV/bGXZa3/3gp69q4pcOsWSnpyTvcALqwiesnXbowKePwyNXvNwz+PW34xKPX7iRmO6kbmjb2y8cCLp21/nPf05OaKNkZ1695yk2j7MEvTllz51XW/k69ydQSKJ1oCilbmdrY14zpzeCZzpy4O9Uk82AyQJ2x/DW3oGBik+j5KovX8VbxtHxqSZVWD3NjDp6BtAgquklquI8wIKGoiFd20TwKVz5OiaXYlZWvy3mEYV1BknuRgxnoWjM5EUAIslLollI6mA8t6cTuxmDg8EJmfoGWTtePMCjY89HsHD2HOYaVX9JmDI/ZWJ7Ml88T24xhXpsLg8WgLwqkmCw61eu2OSWAwHb50nfLt7/83olrjTuu/aBB9QI1r+aVoNcHWQKswbriRwYH12VkWOt98VG7jtECIga/1nHZyrUbNmfP7BARE2fCaFAAXUDNOqHBpWtQmgxNGNLcLDAnDY6L+tfRU+ccoEforBEWK4C1buNEx55zA3edPpjXJDIQQA0JijQLm0pAZHB1s95iFFJWkEYFy+Yyum/sZu8tnmzBuQwUlc4NWbCBK2OoUX4UYwt+PYEm0c7zVCKOv/HDRFQNNYiio5JQhvXlqZWcf6TSWgrhrXltFlo8ocXeskJB34Q1q6lT0CgIigIwBGEUZGchy1p9+NISeO1kZoLk5mWsiWxcTosgsCMl1R5lzVysXoC8VJJeqEBLGDDpcLtp/BTj9uPuQyNwaQSYURxk2bl9k9Fr6BYKMDyBNr1Yk8LwXmY9brvbUxRIOmwer6oLNAqklPkXpnddgBpQo7r+9pWca47Ci4IeaDet7+mp366O/3atJap6Qp/7x7/YJrGeXuC6eNrm1uTSsStWFVyquTKkpmU6XD5OEgvRR0UZCspS9aqKdLskgCs3ZfZvMxeePnbN7dUbghSX1LvtHt+h/o00yuje9wvXvCQ/TvLd4b7Knps8EVZuFGGhjgXA60IBYSE2jsIVXbGZsv0gQnuzuVkltO5eEc2olwCc+0pKSqwx1C+5K7LUobaZo1u5Po6IytdlAom5DevXURN+eY7HvmHtWVq0uCOlEtuocMN0/VAltIKoFUL6BexxzF4FcGUpOZKOMQgFnUJQI5qGFl4bUocaAdzMwhQcGyo2nM7K9BJasGWQ9owMB1ZrLSsoQgTFTPms67M9akXsXNOm76E3Pjyf9MF9FiAgYsz345+5cm3T6qM//Hh83eINScsOz9j0zPR2wmBQ0BnCIi1Bd56fqP+oFtjMUIlNukDc+3w7UiYvefwrV9th7d5KCLXqvKdWbpn+e8Wh/udp3ONOOxt2EN2XhRMxFjwuh3l2PL/s44keFRflm8DWDKzDV9/hrFAr/p4aKxFfxNKvDRPXMieNdxJK9vnQKrlR6zqBNiv4dBYjl5Vh8UppBdO5JfPT2HaZoTUB0taSHUznlmAmNhz7OS7cJtoEcPMwZ27TKI7Q8IfbB3685tiaY+0aNlUBz6mT3+11hnWNaxHMdUATNVrHNg0X9HpgUsLRKQu3LR0zZEzhFkqYoqOSRkcljX4459fVLXsf/DX11qvtwhq3CwtakWPu03X+44FlWEGnN+mwXc3PlYVHGhVw+/qGjVmWXn1Xftk8GtByPv/aWYkfuAU08p2GD0q703WMTadpOoUeXe4YohFtprNjI/YemMsKURxN5fEX4f5yzGRkwGDeewmXUpHWPe4shSJY9wGbijfdx6ShjHiHJd2Y1Y29z/FsIlEqp/dyrC5vNSxfq6Q7jS2ZmsTAH5m/n1cblJ+BWq7W+4NJHEPcOiYPRHsV3XamrqLmIPrGAST1Yvb7DBzIzFFYLzH7da6E824SwtxjfKuWP25/re8P7jfj26qZi19P3ewMnzyhQRRcL66srz7itRaf9No3a9bpAV/W0+/+48Mt3rjaQaEm7Fevpyw4fgljh9omFVFvQIcn56xcNPirK6M7jOgeHorz6jlP4yHN21oBqBb1YDPjdxs3DRp3e0y3aoFO+7XAmBF9wsut2GiuEa7L/uPI99uie4TZ9yxM+y0spoaSv23pAV2X8t+riPq+0/BBaXee2soZPUMSitkrgkdbk7qN4y5aFbytJYqKWtaJlb4h/3izdKOi5+5ivWE/Or1Nqh3Ft9YUFJXiOwQJiopOBVB0yBPMmlmsV6POOCYOJagjv+1g2gSWz2fzpyDQmbl/BL9f9VWXqkdfbCSSptB8NYvm8Xxy6a6CNAqqKU/rxmDCe/HDPAZNY0QiKNTuzfLkwpm40wySr/LyNzyzBgTWhnzwNU/HAOYOXX5a4Rk6du9rg45oCENEzXFf933nISNoKIpBV/SuDena6T+7Hp7wU9qi8bUHHjuR/Orx6wVfxCL01pCu/0ic0y8QIKLh55sGhD+f8vkn61PmAiihdZIfbdbWKgDUas9/1mvfwJTln29I+wwQMc8MGtgnHEU1BihFn65QDUZFUUAJG/l2pzVDdkzockwKNeKBTh8+nbN31aE5k68c/2rQI6qi1ysAQqiKQKKoQi+UitPwgSj162Op4dHQ6UpMfgWNqu7O+ZPE40UoqJWbp6UXL4XGKvjqyKuh6FCkLy3pRqpFtkbi9qCoqApSw3vPUWSpfLxOcnLwGrAGY1QrqAsvmqD4flfzoAlUFVmqq6B2FVWUq1UU3012NjKQaoGlXyaak5tZaCaqh1DqMZfe/CyHDX1oNYPh7l1SeryoxQyK1NweFFVRFemyOXPz3U4PenNAqLXQJCXVnFnZLpfQBYUEWIylVpTSle/IyvUIgyE4xGDSCaT0eKWiKoq4Ky2FohSOrubNz3bYVWP1EJ3i9dgcUtEper2iaFJDqDqBV/NIodMJ6dE0IXTFBspnGmVR2p1+/FQdqu53rH78+N3pp+rid6efqovfnX6qLn53+qm6+N3pp+rid6efqovfnX6qLv8F+nebtocddl4AAAAASUVORK5CYII=" alt="image-20250313210942546" style="zoom:67%;"><ul><li>AT+PINxxx（改配对密码）</li></ul><p>如</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>AT+PIN1234</span></span></code></pre></div><p>返回</p><img src="data:image/png;base64,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" alt="image-20250313211056084" style="zoom:67%;"><ul><li>设置主从模式</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>AT+ROLE=M</span></span>
<span class="line"><span>OK+ROLE:M</span></span></code></pre></div><img src="/XIAOHUANG_BLOG/assets/image-20250313213514243_1.uzZRU_Qv.png" alt="image-20250313213514243" style="zoom:80%;"><h3 id="jdy-08" tabindex="-1">JDY-08 <a class="header-anchor" href="#jdy-08" aria-label="Permalink to &quot;JDY-08&quot;">​</a></h3><h4 id="at指令集" tabindex="-1">AT指令集 <a class="header-anchor" href="#at指令集" aria-label="Permalink to &quot;AT指令集&quot;">​</a></h4><img src="/XIAOHUANG_BLOG/assets/image-20250313212352777_1.oeKv8yXo.png" alt="image-20250313212352777" style="zoom:67%;"><img src="/XIAOHUANG_BLOG/assets/image-20250313212441183_1.DNJqgv_j.png" alt="image-20250313212441183" style="zoom:67%;"><ul><li><p>查看名称、修改名称和密码</p></li><li><p>更改主从模式</p></li></ul><p>查看</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>AT+HOSTEN</span></span>
<span class="line"><span>+HOSTEN:0</span></span></code></pre></div><p>修改</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>AT+HOSTEN1</span></span>
<span class="line"><span>+OK</span></span></code></pre></div><ul><li>查看连接密码</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>AT+PASS</span></span>
<span class="line"><span>+PSS:123456</span></span></code></pre></div><ul><li>设置连接密码</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>AT+PASS123456</span></span>
<span class="line"><span>+OK</span></span></code></pre></div><ul><li>主动连接他机</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span></span></span></code></pre></div><h3 id="ch9143" tabindex="-1">CH9143 <a class="header-anchor" href="#ch9143" aria-label="Permalink to &quot;CH9143&quot;">​</a></h3><h3 id="配对" tabindex="-1">配对 <a class="header-anchor" href="#配对" aria-label="Permalink to &quot;配对&quot;">​</a></h3><h4 id="hc05—hc05配对" tabindex="-1">HC05—HC05配对 <a class="header-anchor" href="#hc05—hc05配对" aria-label="Permalink to &quot;HC05—HC05配对&quot;">​</a></h4><ul><li>从模式设置</li></ul><p>默认9600，或者38400,改成115200</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>AT+NAME=CarHC05  </span></span>
<span class="line"><span>AT+UART=115200,0,0 //波特率设置</span></span>
<span class="line"><span>AT+ROLE=0</span></span>
<span class="line"><span>AT+ADDR?   //返回地址：+ADDR=16:59:7B:D8:46:10</span></span>
<span class="line"><span>AT+PSWD=999999  //设置密码</span></span></code></pre></div><ul><li>主模式机设置</li></ul><p>默认9600,改成115200</p><div class="language-C vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    //查看名字，返回+NAME:HC-05</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CarHC05</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> //设置名字Car</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">UART</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">115200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> //设置波特率115200</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ROLE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> //查看模式</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ROLE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  //OK,设置为主模式</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//0——从角色（ Slave）、1——主角色（ Master）2——回环角色（ Slave-Loop）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BIND</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">59</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">7B</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,D8,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">46</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span></span></code></pre></div><h4 id="jdy08-jdy08" tabindex="-1">JDY08-JDY08 <a class="header-anchor" href="#jdy08-jdy08" aria-label="Permalink to &quot;JDY08-JDY08&quot;">​</a></h4><p>参考视频：【如何让两个HC-05蓝牙模块分别作为主设备和从设备[How To Mechatronics]】<a href="https://www.bilibili.com/video/BV1RJ411i7Fr?vd_source=b7ec3648f866bae76c4b07907d1dae5e" target="_blank" rel="noreferrer">https://www.bilibili.com/video/BV1RJ411i7Fr?vd_source=b7ec3648f866bae76c4b07907d1dae5e</a></p><ul><li>从模式设置</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>AT+HOSTEN0</span></span>
<span class="line"><span>AT+PASS123456</span></span>
<span class="line"><span>AT+MAC  //返回+MAC:7446B3F8FF2B</span></span></code></pre></div><ul><li>主模式</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>AT+HOSTEN1</span></span>
<span class="line"><span>AT+PASS123456</span></span>
<span class="line"><span>AT+BAND7446B3F8FF2B</span></span></code></pre></div><h2 id="wifi无线转串口" tabindex="-1">WIFI无线转串口 <a class="header-anchor" href="#wifi无线转串口" aria-label="Permalink to &quot;WIFI无线转串口&quot;">​</a></h2><h3 id="esp01" tabindex="-1">esp01 <a class="header-anchor" href="#esp01" aria-label="Permalink to &quot;esp01&quot;">​</a></h3><p>参考：【2.ESP01S连接阿里云——ESP01S固件烧录】<a href="https://www.bilibili.com/video/BV1x14y1S74D?vd_source=b7ec3648f866bae76c4b07907d1dae5e" target="_blank" rel="noreferrer">https://www.bilibili.com/video/BV1x14y1S74D?vd_source=b7ec3648f866bae76c4b07907d1dae5e</a></p><img src="/XIAOHUANG_BLOG/assets/image-20250322153920803_1.CewiHVFE.png" alt="image-20250322153920803" style="zoom:50%;"><h3 id="zigbee" tabindex="-1">zigbee <a class="header-anchor" href="#zigbee" aria-label="Permalink to &quot;zigbee&quot;">​</a></h3><h3 id="安信可ai-wb2-12f-1" tabindex="-1">安信可AI-WB2-12f <a class="header-anchor" href="#安信可ai-wb2-12f-1" aria-label="Permalink to &quot;安信可AI-WB2-12f&quot;">​</a></h3><p>排针2.0，供电3v3</p><p>通过usb串口连接，usb的数据发送给wifi串口</p><h4 id="蓝牙功能" tabindex="-1">蓝牙功能 <a class="header-anchor" href="#蓝牙功能" aria-label="Permalink to &quot;蓝牙功能&quot;">​</a></h4><h4 id="蓝牙互联" tabindex="-1">蓝牙互联 <a class="header-anchor" href="#蓝牙互联" aria-label="Permalink to &quot;蓝牙互联&quot;">​</a></h4><h4 id="wifi互联" tabindex="-1">WIFI互联 <a class="header-anchor" href="#wifi互联" aria-label="Permalink to &quot;WIFI互联&quot;">​</a></h4><h2 id="舵机" tabindex="-1">舵机 <a class="header-anchor" href="#舵机" aria-label="Permalink to &quot;舵机&quot;">​</a></h2><h3 id="pwm舵机" tabindex="-1">PWM舵机 <a class="header-anchor" href="#pwm舵机" aria-label="Permalink to &quot;PWM舵机&quot;">​</a></h3><h2 id="电机" tabindex="-1">电机 <a class="header-anchor" href="#电机" aria-label="Permalink to &quot;电机&quot;">​</a></h2><h3 id="tb6612电机驱动" tabindex="-1">TB6612电机驱动 <a class="header-anchor" href="#tb6612电机驱动" aria-label="Permalink to &quot;TB6612电机驱动&quot;">​</a></h3><img src="/XIAOHUANG_BLOG/assets/image-20250222164116830_1.B9Sm3kIP.png" alt="image-20250222164116830" style="zoom:50%;"><img src="/XIAOHUANG_BLOG/assets/image-20250223115320434_1.CPsH_f1U.png" alt="image-20250223115320434" style="zoom:50%;"><img src="/XIAOHUANG_BLOG/assets/image-20250202091303918_1.CRlxWZbd.png" alt="image-20250202091303918" style="zoom:50%;"><p>接线</p><img src="/XIAOHUANG_BLOG/assets/image-20250202091424864_1.Bk87gJj3.png" alt="image-20250202091424864" style="zoom:50%;"><h3 id="l298n电机驱动" tabindex="-1">L298N电机驱动 <a class="header-anchor" href="#l298n电机驱动" aria-label="Permalink to &quot;L298N电机驱动&quot;">​</a></h3><h3 id="drv8833" tabindex="-1">DRV8833 <a class="header-anchor" href="#drv8833" aria-label="Permalink to &quot;DRV8833&quot;">​</a></h3><img src="/XIAOHUANG_BLOG/assets/image-20250202114735245_1.C70QcwrW.png" alt="image-20250202114735245" style="zoom:50%;"><img src="/XIAOHUANG_BLOG/assets/image-20250202114954907_1.Debx97WM.png" alt="image-20250202114954907" style="zoom:50%;"><img src="/XIAOHUANG_BLOG/assets/image-20250202115054695_1.W_mkx_Y9.png" alt="image-20250202115054695" style="zoom:50%;"><h3 id="直流减速电机" tabindex="-1">直流减速电机 <a class="header-anchor" href="#直流减速电机" aria-label="Permalink to &quot;直流减速电机&quot;">​</a></h3><p>记得与单片机共地！！！</p><p>参考：<a href="https://blog.csdn.net/u011895157/article/details/139609274?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=%E7%9B%B4%E6%B5%81%E5%87%8F%E9%80%9F%E7%94%B5%E6%9C%BAmg310%E6%8E%A7%E5%88%B6&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-139609274.142%5Ev101%5Epc_search_result_base3&amp;spm=1018.2226.3001.4187" target="_blank" rel="noreferrer">STM32驱动带编码器的直流减速电机_mg310电机-CSDN博客</a></p><h4 id="驰海电机" tabindex="-1">驰海电机 <a class="header-anchor" href="#驰海电机" aria-label="Permalink to &quot;驰海电机&quot;">​</a></h4><img src="/XIAOHUANG_BLOG/assets/image-20250201153941495_1.ftceYOvJ.png" alt="image-20250201153941495" style="zoom:50%;"><p>另一个示例</p><img src="/XIAOHUANG_BLOG/assets/image-20250201191436592_1.DC24-u7H.png" alt="image-20250201191436592" style="zoom:50%;"><h4 id="jgb-520电机" tabindex="-1">JGB-520电机 <a class="header-anchor" href="#jgb-520电机" aria-label="Permalink to &quot;JGB-520电机&quot;">​</a></h4><p>参考：<a href="https://blog.csdn.net/m0_74800695/article/details/134586614?ops_request_misc=%7B%22request%5Fid%22%3A%22a7e634a2dc0f7cf9f115bf3629c6c770%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=a7e634a2dc0f7cf9f115bf3629c6c770&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-134586614-null-null.142%5Ev101%5Epc_search_result_base3&amp;utm_term=jgb520%E7%94%B5%E6%9C%BA&amp;spm=1018.2226.3001.4187" target="_blank" rel="noreferrer">stm32平衡小车--（1）JGB-520减速电机+tb6612（附测试代码）_jgb520-CSDN博客</a></p><img src="/XIAOHUANG_BLOG/assets/image-20250301171527157_1.BTmqCYcA.png" alt="image-20250301171527157" style="zoom:50%;"><h4 id="测试连接" tabindex="-1">测试连接 <a class="header-anchor" href="#测试连接" aria-label="Permalink to &quot;测试连接&quot;">​</a></h4><p>输出1</p><img src="/XIAOHUANG_BLOG/assets/image-20250201154450874_1.0U7eVg-x.png" alt="image-20250201154450874" style="zoom:50%;"><p>输出2</p><img src="/XIAOHUANG_BLOG/assets/image-20250201154859132_1.CiyuJAnf.png" alt="image-20250201154859132" style="zoom:50%;"><h4 id="pwm控制电机" tabindex="-1">PWM控制电机 <a class="header-anchor" href="#pwm控制电机" aria-label="Permalink to &quot;PWM控制电机&quot;">​</a></h4><img src="/XIAOHUANG_BLOG/assets/image-20250219144853506_1.BKn_NRdh.png" alt="image-20250219144853506" style="zoom:67%;"><img src="/XIAOHUANG_BLOG/assets/image-20250219144938719_1.BXQDimyV.png" alt="image-20250219144938719" style="zoom:67%;"><img src="/XIAOHUANG_BLOG/assets/image-20250219144045075_1.D92UsHR6.png" alt="image-20250219144045075" style="zoom:67%;"><h5 id="呼吸轮" tabindex="-1">呼吸轮 <a class="header-anchor" href="#呼吸轮" aria-label="Permalink to &quot;呼吸轮&quot;">​</a></h5><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/* USER CODE BEGIN 2 */</span></span>
<span class="line"><span>  	//电机全速转</span></span>
<span class="line"><span>	HAL_GPIO_WritePin(AIN1_GPIO_Port, AIN1_Pin,GPIO_PIN_SET);</span></span>
<span class="line"><span>	HAL_GPIO_WritePin(AIN2_GPIO_Port, AIN2_Pin,GPIO_PIN_RESET);</span></span>
<span class="line"><span>	HAL_GPIO_WritePin(BIN1_GPIO_Port, BIN1_Pin,GPIO_PIN_SET);</span></span>
<span class="line"><span>	HAL_GPIO_WritePin(BIN2_GPIO_Port, BIN2_Pin,GPIO_PIN_RESET);</span></span>
<span class="line"><span>	//开启pwm</span></span>
<span class="line"><span>	HAL_TIM_PWM_Start(&amp;htim1, TIM_CHANNEL_1);</span></span>
<span class="line"><span>	HAL_TIM_PWM_Start(&amp;htim1, TIM_CHANNEL_2);</span></span>
<span class="line"><span>  /* USER CODE END 2 */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  /* Infinite loop */</span></span>
<span class="line"><span>  /* USER CODE BEGIN WHILE */</span></span>
<span class="line"><span>  while (1)</span></span>
<span class="line"><span>  {</span></span>
<span class="line"><span>	  for(int i=0;i&lt;100;i++){</span></span>
<span class="line"><span>		  __HAL_TIM_SET_COMPARE(&amp;htim1,TIM_CHANNEL_1,i);</span></span>
<span class="line"><span>		  HAL_Delay(10);</span></span>
<span class="line"><span>		  __HAL_TIM_SET_COMPARE(&amp;htim1,TIM_CHANNEL_2,i);</span></span>
<span class="line"><span>		  HAL_Delay(10);</span></span>
<span class="line"><span>	  }for(int i=99;i&gt;=0;i--){</span></span>
<span class="line"><span>		  __HAL_TIM_SET_COMPARE(&amp;htim1,TIM_CHANNEL_1,i);</span></span>
<span class="line"><span>		  HAL_Delay(10);</span></span>
<span class="line"><span>		  __HAL_TIM_SET_COMPARE(&amp;htim1,TIM_CHANNEL_2,i);</span></span>
<span class="line"><span>		  HAL_Delay(10);</span></span>
<span class="line"><span>	  }</span></span>
<span class="line"><span>    /* USER CODE END WHILE */</span></span>
<span class="line"><span>    /* USER CODE BEGIN 3 */</span></span>
<span class="line"><span>  }</span></span></code></pre></div><h4 id="编码器测速" tabindex="-1">编码器测速 <a class="header-anchor" href="#编码器测速" aria-label="Permalink to &quot;编码器测速&quot;">​</a></h4><img src="/XIAOHUANG_BLOG/assets/image-20250202095319030_1.0dLVJkIu.png" alt="image-20250202095319030" style="zoom:50%;"><h5 id="判断旋转方向" tabindex="-1">判断旋转方向 <a class="header-anchor" href="#判断旋转方向" aria-label="Permalink to &quot;判断旋转方向&quot;">​</a></h5><p>方法1：（适合低速，高速不行）</p><p>A相上升沿触发，触发时检测B相电压来判断方向，累计数值-1或者+1来记录脉冲数量</p><img src="/XIAOHUANG_BLOG/assets/image-20250202102205542_1.ild6Z6pW.png" alt="image-20250202102205542" style="zoom:50%;"><p>方法2：定时器的编码器通道（高速）</p><ul><li>对上下边沿都敏感</li></ul><p><img src="/XIAOHUANG_BLOG/assets/image-20250202102710752_1.Bz3_zxVm.png" alt="image-20250202102710752" loading="lazy"></p><h5 id="计算案例" tabindex="-1">计算案例 <a class="header-anchor" href="#计算案例" aria-label="Permalink to &quot;计算案例&quot;">​</a></h5><p>设减速比1：20（即20），线数（PPR=线数）13,编码器倍频为4</p><p>轮胎每转一圈的脉冲数</p><!----><p>速度有</p><!----><h5 id="定时器编码器测速" tabindex="-1">定时器编码器测速 <a class="header-anchor" href="#定时器编码器测速" aria-label="Permalink to &quot;定时器编码器测速&quot;">​</a></h5><ul><li>注意需要两个定时器，一个定时器用于定时发送测速结果，另一个用于编码器测速</li><li>编码器测速</li></ul><p>记编码器的脉冲数，不用设置时钟源</p><img src="/XIAOHUANG_BLOG/assets/image-20250203124550738_1.C9IsaKX4.png" alt="image-20250203124550738" style="zoom:67%;"><p>由于上下边沿都会计数，因此如果只想单个边沿就选择预分配为2</p><img src="/XIAOHUANG_BLOG/assets/image-20250203125121625_1.DcMdF0IG.png" alt="image-20250203125121625" style="zoom:67%;"><p>Encoder Mode TI1就是在TI1边沿上计数</p><img src="/XIAOHUANG_BLOG/assets/image-20250203124905116_1.DpSCPK2-.png" alt="image-20250203124905116" style="zoom:67%;"><p>开启编码器</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>HAL_TIM_Encoder_Start(&amp;htim2, TIM_CHANNEL_ALL);//开启TIM2编码器模式（）</span></span>
<span class="line"><span>HAL_TIM_Encoder_Start(&amp;htim4, TIM_CHANNEL_ALL);//开启TIM4编码器模式（）</span></span></code></pre></div><ul><li>定时测速（设置测速10ms），即</li></ul><!----><h4 id="闭环控制轮胎速度" tabindex="-1">闭环控制轮胎速度 <a class="header-anchor" href="#闭环控制轮胎速度" aria-label="Permalink to &quot;闭环控制轮胎速度&quot;">​</a></h4><h4 id="光电编码器配置完整过程" tabindex="-1">光电编码器配置完整过程 <a class="header-anchor" href="#光电编码器配置完整过程" aria-label="Permalink to &quot;光电编码器配置完整过程&quot;">​</a></h4><ul><li><p>以M2为例</p></li><li><p>设置一对编码器 E2A、E2B</p></li></ul><p><img src="/XIAOHUANG_BLOG/assets/image-20250408222020502_1.9eIrK6wE.png" alt="image-20250408222020502" loading="lazy"></p><img src="/XIAOHUANG_BLOG/assets/image-20250408222110777_1.i9eJFkTg.png" alt="image-20250408222110777" style="zoom:50%;"><p>参数配置：</p><img src="/XIAOHUANG_BLOG/assets/image-20250408223755866_1.BzsTL3PS.png" alt="image-20250408223755866" style="zoom:50%;"><ul><li>设置M+\M-（通过两个GPIO和一个PWM，通过呼吸轮测试）</li></ul><p>M+/M-：</p><img src="/XIAOHUANG_BLOG/assets/image-20250408222858255_1.BkxnUm-J.png" alt="image-20250408222858255" style="zoom:80%;"><img src="/XIAOHUANG_BLOG/assets/image-20250408222349423_1.BaWfbLK4.png" alt="image-20250408222349423" style="zoom:25%;"><p>时钟，用于产生PWM：</p><p><img src="/XIAOHUANG_BLOG/assets/image-20250408223946232_1.3a6CuwFI.png" alt="image-20250408223946232" loading="lazy"></p><img src="/XIAOHUANG_BLOG/assets/image-20250409222821522_1.8I_8Pg_U.png" alt="image-20250409222821522" style="zoom:50%;"><ul><li>编码器定时清空定时器</li></ul><p>5ms</p><p><img src="/XIAOHUANG_BLOG/assets/image-20250410215015255_1.y2BbsnVF.png" alt="image-20250410215015255" loading="lazy"></p><img src="/XIAOHUANG_BLOG/assets/image-20250410214945261_1.D-zYJXGu.png" alt="image-20250410214945261" style="zoom:67%;"><p>定时更新函数—（也在motor中）</p><p>.h</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#define FRESH_COUNTER_TIM  htim13</span></span>
<span class="line"><span>void fresh_encoder(void);</span></span></code></pre></div><p>.c</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>short motor2_encoder_count=0;</span></span>
<span class="line"><span>void fresh_encoder(void){</span></span>
<span class="line"><span>	//电机2</span></span>
<span class="line"><span>	motor2_encoder_count=(short)__HAL_TIM_GET_COUNTER(&amp;M2_ENCODER_TIMER);  // 获取定时器(编码器)的计数值</span></span>
<span class="line"><span>	__HAL_TIM_SET_COUNTER(&amp;M2_ENCODER_TIMER,0);//清空编码器</span></span>
<span class="line"><span>}</span></span></code></pre></div><ul><li><p>相关函数</p></li><li><p>motor.h</p></li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/*</span></span>
<span class="line"><span> * motor.h</span></span>
<span class="line"><span> *</span></span>
<span class="line"><span> *  Created on: Mar 30, 2025</span></span>
<span class="line"><span> *      Author: 27276</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#ifndef SRC_MOTOR_MOTOR_H_</span></span>
<span class="line"><span>#define SRC_MOTOR_MOTOR_H_</span></span>
<span class="line"><span>#include &quot;main.h&quot;</span></span>
<span class="line"><span>#include &quot;tim.h&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>/*</span></span>
<span class="line"><span> * 定时测速使用的定时器</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>#define FRESH_COUNTER_TIM  htim13</span></span>
<span class="line"><span>void fresh_encoder(void);</span></span>
<span class="line"><span>/*</span></span>
<span class="line"><span> * 电机与编码器</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>#define FRONT 1</span></span>
<span class="line"><span>#define BACK 0</span></span>
<span class="line"><span>#define STOP -1</span></span>
<span class="line"><span>/*</span></span>
<span class="line"><span> * 电机2</span></span>
<span class="line"><span> * 开启方法</span></span>
<span class="line"><span> * HAL_TIM_PWM_Start(&amp;htim1, TIM_CHANNEL_1);</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>#define M2_PWM_TIMER  htim1</span><span>  //电机2的PWM的定时器</span></span>
<span class="line"><span>#define M2_PWM_TIMER_CHANNEL TIM_CHANNEL_4</span><span>  //电机2的PWM的定时器通道</span></span>
<span class="line"><span>#define M2_PWM_MAX_COUNT  50000</span><span> //电机2的PWM的周期</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#define M2_IN1_PORT  M2_IN1_GPIO_Port</span><span> //电机2方向控制IN1</span></span>
<span class="line"><span>#define M2_IN1_PIN   M2_IN1_Pin</span><span>       //电机2方向控制IN1</span></span>
<span class="line"><span>#define M2_IN2_PORT  M2_IN2_GPIO_Port</span><span> //电机2方向控制IN2</span></span>
<span class="line"><span>#define M2_IN2_PIN   M2_IN2_Pin</span><span>       //电机2方向控制IN2</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#define M2_ENCODER_TIMER htim2//电机2的编码器定时器</span></span>
<span class="line"><span>extern short motor2_encoder_count;         //电机2的PWM的编码器计数值</span></span>
<span class="line"><span>void motor2_init(void);  //电机使能，含对应编码器使能</span></span>
<span class="line"><span>void motor2_diret_set(int i);</span></span>
<span class="line"><span>void motor2_setpwm(int  pwm);</span></span>
<span class="line"><span>void motor2_get_encoder_count(void);</span></span>
<span class="line"><span>//motor2的指令函数</span></span>
<span class="line"><span>void motor2_breath(void);  //呼吸轮测试，编码器的值会改变</span></span>
<span class="line"><span>/*</span></span>
<span class="line"><span> * 电机3</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>#endif /* SRC_MOTOR_MOTOR_H_ */</span></span></code></pre></div><ul><li>motor.c</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/*</span></span>
<span class="line"><span> * motor.c</span></span>
<span class="line"><span> *</span></span>
<span class="line"><span> *  Created on: Mar 30, 2025</span></span>
<span class="line"><span> *      Author: 27276</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>#include &quot;motor.h&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//MOTOR通用函数</span></span>
<span class="line"><span>void pwm_constrait(int16_t *pwm,int pwmmax,int pwmmin,int deathpwm){</span></span>
<span class="line"><span>	if(*pwm&gt;=pwmmax)</span></span>
<span class="line"><span>		*pwm=pwmmax;</span></span>
<span class="line"><span>	else if(*pwm&lt;=pwmmin)</span></span>
<span class="line"><span>		*pwm =pwmmin;</span></span>
<span class="line"><span>   if(*pwm&gt;=0)</span></span>
<span class="line"><span>   {</span></span>
<span class="line"><span>	   *pwm+=deathpwm;</span></span>
<span class="line"><span>   }</span></span>
<span class="line"><span>   else if(*pwm&lt;=0)</span></span>
<span class="line"><span>   {</span></span>
<span class="line"><span>	   *pwm-=deathpwm;</span></span>
<span class="line"><span>   }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//定时测速使用的定时器,更新定时器并存储</span></span>
<span class="line"><span>/*</span></span>
<span class="line"><span> * 在tim_it.c中的使用</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>short motor2_encoder_count=0;</span></span>
<span class="line"><span>void fresh_encoder(void){</span></span>
<span class="line"><span>	//电机2</span></span>
<span class="line"><span>	motor2_encoder_count=(short)__HAL_TIM_GET_COUNTER(&amp;M2_ENCODER_TIMER);  // 获取定时器(编码器)的计数值</span></span>
<span class="line"><span>	__HAL_TIM_SET_COUNTER(&amp;M2_ENCODER_TIMER,0);//清空编码器</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>//MOTOR2</span></span>
<span class="line"><span>void motor2_init(void){</span></span>
<span class="line"><span>	HAL_TIM_PWM_Start(&amp;M2_PWM_TIMER,M2_PWM_TIMER_CHANNEL); //PWM引脚对应定时器</span></span>
<span class="line"><span>	HAL_TIM_Base_Start_IT(&amp;FRESH_COUNTER_TIM);</span></span>
<span class="line"><span>	HAL_TIM_Encoder_Start(&amp;M2_ENCODER_TIMER, TIM_CHANNEL_ALL);//开启编码器</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>void motor2_diret_set(int i){</span></span>
<span class="line"><span>	if(i==FRONT){</span></span>
<span class="line"><span>		HAL_GPIO_WritePin(M2_IN1_PORT, M2_IN1_PIN, GPIO_PIN_SET);</span></span>
<span class="line"><span>		HAL_GPIO_WritePin(M2_IN2_PORT, M2_IN2_PIN, GPIO_PIN_RESET);</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>	else if(i==BACK){</span></span>
<span class="line"><span>		HAL_GPIO_WritePin(M2_IN1_PORT, M2_IN1_PIN, GPIO_PIN_RESET);</span></span>
<span class="line"><span>	    HAL_GPIO_WritePin(M2_IN2_PORT, M2_IN2_PIN, GPIO_PIN_SET);</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>	else if(i==STOP){</span></span>
<span class="line"><span>		HAL_GPIO_WritePin(M2_IN1_PORT, M2_IN1_PIN, GPIO_PIN_RESET);</span></span>
<span class="line"><span>		HAL_GPIO_WritePin(M2_IN2_PORT, M2_IN2_PIN, GPIO_PIN_RESET);</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>void motor2_setpwm(int pwm){ //pwm不是-1~1的而是根据</span></span>
<span class="line"><span>	pwm_constrait(&amp;pwm,46000,-46000,0);</span></span>
<span class="line"><span>	if(pwm&gt;0){</span></span>
<span class="line"><span>		motor2_diret_set(FRONT);</span></span>
<span class="line"><span>		__HAL_TIM_SET_COMPARE(&amp;M2_PWM_TIMER,M2_PWM_TIMER_CHANNEL,pwm);</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>	else if(pwm&lt;0){</span></span>
<span class="line"><span>		motor2_diret_set(BACK);</span></span>
<span class="line"><span>		__HAL_TIM_SET_COMPARE(&amp;M2_PWM_TIMER,M2_PWM_TIMER_CHANNEL,-pwm);</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>	else</span></span>
<span class="line"><span>		motor2_diret_set(STOP);</span></span>
<span class="line"><span>//		__HAL_TIM_SET_COMPARE(&amp;htim5,TIM_CHANNEL_2,0);</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>void motor2_breath(void){</span></span>
<span class="line"><span>	for(int i=-M2_PWM_MAX_COUNT;i&lt;M2_PWM_MAX_COUNT;i+=100){</span></span>
<span class="line"><span>		motor2_setpwm(i);</span></span>
<span class="line"><span>		HAL_Delay(5);</span></span>
<span class="line"><span>	}for(int i=M2_PWM_MAX_COUNT;i&gt;=-M2_PWM_MAX_COUNT;i-=100){</span></span>
<span class="line"><span>		motor2_setpwm(i);</span></span>
<span class="line"><span>		HAL_Delay(5);</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>void motor2_get_encoder_count(void){</span></span>
<span class="line"><span>	motor2_encoder_count=(short)__HAL_TIM_GET_COUNTER(&amp;M2_PWM_TIMER);</span></span>
<span class="line"><span>	__HAL_TIM_SET_COUNTER(&amp;M2_PWM_TIMER,0);//清空编码器</span></span>
<span class="line"><span>}</span></span></code></pre></div><ul><li>tim_it.h</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/*</span></span>
<span class="line"><span> * tim_it.h</span></span>
<span class="line"><span> *</span></span>
<span class="line"><span> *  Created on: Apr 10, 2025</span></span>
<span class="line"><span> *      Author: 27276</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#ifndef SRC_TIM_IT_TIM_IT_H_</span></span>
<span class="line"><span>#define SRC_TIM_IT_TIM_IT_H_</span></span>
<span class="line"><span>#include &quot;main.h&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>#endif /* SRC_TIM_IT_TIM_IT_H_ */</span></span></code></pre></div><ul><li>tim_it.c</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/*</span></span>
<span class="line"><span> * tim_it.c</span></span>
<span class="line"><span> *</span></span>
<span class="line"><span> *  Created on: Apr 10, 2025</span></span>
<span class="line"><span> *      Author: 27276</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#include &quot;tim_it.h&quot;</span></span>
<span class="line"><span>#include &quot;motor.h&quot;</span></span>
<span class="line"><span>//定时器中断重定义</span></span>
<span class="line"><span>void HAL_TIM_PeriodElapsedCallback(TIM_HandleTypeDef *htim){</span></span>
<span class="line"><span> if(htim==&amp;FRESH_COUNTER_TIM){ //htim13,编码器清空定时器</span></span>
<span class="line"><span>	 fresh_encoder();</span></span>
<span class="line"><span> }</span></span>
<span class="line"><span>}</span></span></code></pre></div><h2 id="dds" tabindex="-1">DDS <a class="header-anchor" href="#dds" aria-label="Permalink to &quot;DDS&quot;">​</a></h2><h3 id="ad9833" tabindex="-1">AD9833 <a class="header-anchor" href="#ad9833" aria-label="Permalink to &quot;AD9833&quot;">​</a></h3><p>参考链接：<a href="https://ez.analog.com/cn/other/f/forum/545070/ad9833" target="_blank" rel="noreferrer">AD9833调不通？看这篇文章就够了~ - 讨论 - 中文资源库 - EngineerZone</a></p><p>ad9833.h</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/*</span></span>
<span class="line"><span> * ad9833.h</span></span>
<span class="line"><span> *</span></span>
<span class="line"><span> *  Created on: Apr 27, 2025</span></span>
<span class="line"><span> *      Author: 27276</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#ifndef SRC_AD9833_AD9833_H_</span></span>
<span class="line"><span>#define SRC_AD9833_AD9833_H_</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#include &quot;main.h&quot;</span></span>
<span class="line"><span>//使用GPIO实现SPI通信</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>// I/O口定义</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>#define SD_PORT   	GPIOD</span></span>
<span class="line"><span>#define SD_PIN	  	GPIO_PIN_8</span></span>
<span class="line"><span>#define SCL_PORT	GPIOD</span></span>
<span class="line"><span>#define SCL_PIN		GPIO_PIN_9</span></span>
<span class="line"><span>#define CS_PORT		GPIOD</span></span>
<span class="line"><span>#define CS_PIN		GPIO_PIN_10</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#define  ADI_SD_LOW    (HAL_GPIO_WritePin(SD_PORT,SD_PIN,GPIO_PIN_RESET))</span></span>
<span class="line"><span>#define  ADI_SD_HIGH   (HAL_GPIO_WritePin(SD_PORT,SD_PIN,GPIO_PIN_SET))</span></span>
<span class="line"><span>#define  ADI_SCL_LOW   (HAL_GPIO_WritePin(SCL_PORT,SCL_PIN,GPIO_PIN_RESET))</span></span>
<span class="line"><span>#define  ADI_SCL_HIGH  (HAL_GPIO_WritePin(SCL_PORT,SCL_PIN,GPIO_PIN_SET))</span></span>
<span class="line"><span>#define  ADI_CS_LOW    (HAL_GPIO_WritePin(CS_PORT,CS_PIN,GPIO_PIN_RESET))</span></span>
<span class="line"><span>#define  ADI_CS_HIGH   (HAL_GPIO_WritePin(CS_PORT,CS_PIN,GPIO_PIN_SET))</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>// AD9833宏定义</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>/* Registers 寄存器 */</span></span>
<span class="line"><span>#define AD9833_REG_CMD		(0 &lt;&lt; 14)</span></span>
<span class="line"><span>#define AD9833_REG_FREQ0	(1 &lt;&lt; 14)</span></span>
<span class="line"><span>#define AD9833_REG_FREQ1	(2 &lt;&lt; 14)</span></span>
<span class="line"><span>#define AD9833_REG_PHASE0	(6 &lt;&lt; 13)</span></span>
<span class="line"><span>#define AD9833_REG_PHASE1	(7 &lt;&lt; 13)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/* Command Control Bits 命令控制位 */</span></span>
<span class="line"><span>#define AD9833_B28			(1 &lt;&lt; 13)</span></span>
<span class="line"><span>#define AD9833_HLB			(1 &lt;&lt; 12)</span></span>
<span class="line"><span>#define AD9833_FSEL0		(0 &lt;&lt; 11)</span></span>
<span class="line"><span>#define AD9833_FSEL1		(1 &lt;&lt; 11)</span></span>
<span class="line"><span>#define AD9833_PSEL0		(0 &lt;&lt; 10)</span></span>
<span class="line"><span>#define AD9833_PSEL1		(1 &lt;&lt; 10)</span></span>
<span class="line"><span>#define AD9833_PIN_SW		(1 &lt;&lt; 9)</span></span>
<span class="line"><span>#define AD9833_RESET		(1 &lt;&lt; 8)</span></span>
<span class="line"><span>#define AD9833_SLEEP1		(1 &lt;&lt; 7)</span></span>
<span class="line"><span>#define AD9833_SLEEP12		(1 &lt;&lt; 6)</span></span>
<span class="line"><span>#define AD9833_OPBITEN		(1 &lt;&lt; 5)</span></span>
<span class="line"><span>#define AD9833_SIGN_PIB		(1 &lt;&lt; 4)</span></span>
<span class="line"><span>#define AD9833_DIV2			(1 &lt;&lt; 3)</span></span>
<span class="line"><span>#define AD9833_MODE			(1 &lt;&lt; 1)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#define AD9833_OUT_SINUS	((0 &lt;&lt; 5) | (0 &lt;&lt; 1) | (0 &lt;&lt; 3))</span></span>
<span class="line"><span>#define AD9833_OUT_TRIANGLE	((0 &lt;&lt; 5) | (1 &lt;&lt; 1) | (0 &lt;&lt; 3))</span></span>
<span class="line"><span>#define AD9833_OUT_MSB		((1 &lt;&lt; 5) | (0 &lt;&lt; 1) | (1 &lt;&lt; 3))</span></span>
<span class="line"><span>#define AD9833_OUT_MSB2		((1 &lt;&lt; 5) | (0 &lt;&lt; 1) | (0 &lt;&lt; 3))</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>// 函数声明</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span></span></span>
<span class="line"><span>void SPI_Init (void);				// SPI 初始化</span></span>
<span class="line"><span>void SPI_Write (unsigned short ddara);</span></span>
<span class="line"><span>/* Initializes the SPI communication peripheral and resets the part. */</span></span>
<span class="line"><span>unsigned char AD9833_Init(void);</span></span>
<span class="line"><span>/* Sets the Reset bit of the AD9833. */</span></span>
<span class="line"><span>void AD9833_Reset(void);</span></span>
<span class="line"><span>/* Clears the Reset bit of the AD9833. */</span></span>
<span class="line"><span>void AD9833_ClearReset(void);</span></span>
<span class="line"><span>/* Writes the value to a register. */</span></span>
<span class="line"><span>void AD9833_SetRegisterValue(unsigned short regValue);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>unsigned long freq_trl_word(double freq);</span></span>
<span class="line"><span>/* Writes to the frequency registers. */</span></span>
<span class="line"><span>//void AD9833_SetFrequency(unsigned short reg, unsigned long val);</span></span>
<span class="line"><span>void AD9833_SetFrequency(unsigned short reg, unsigned short wave_type, unsigned long val);</span></span>
<span class="line"><span>/* Writes to the phase registers. */</span></span>
<span class="line"><span>void AD9833_SetPhase(unsigned short reg, unsigned short val);</span></span>
<span class="line"><span>/* Selects the Frequency,Phase and Waveform type. */</span></span>
<span class="line"><span>void AD9833_Setup(unsigned short freq,</span></span>
<span class="line"><span>				  unsigned short phase,</span></span>
<span class="line"><span>			 	  unsigned short type);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>// End Of File</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>#endif /* SRC_AD9833_AD9833_H_ */</span></span></code></pre></div><p>ad9833.c</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/*</span></span>
<span class="line"><span> * ad9833.c</span></span>
<span class="line"><span> *</span></span>
<span class="line"><span> *  Created on: Apr 27, 2025</span></span>
<span class="line"><span> *      Author: 27276</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#include &quot;ad9833.h&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>// void SPI_Init (void)</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>//</span></span>
<span class="line"><span>// 函数功能: SPI通讯线初始化设置</span></span>
<span class="line"><span>// 入口参数: 无</span></span>
<span class="line"><span>// 返回参数: 无</span></span>
<span class="line"><span>// 全局变量: 无</span></span>
<span class="line"><span>// 调用模块: 无</span></span>
<span class="line"><span>// 注意事项:</span></span>
<span class="line"><span>//</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>void SPI_Init (void)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	ADI_CS_HIGH;</span></span>
<span class="line"><span>	ADI_SCL_HIGH;</span></span>
<span class="line"><span>	ADI_SD_LOW;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>// SPI_Write (unsigned short ddara)</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>//</span></span>
<span class="line"><span>// 函数功能: 通过SPI方式写数据</span></span>
<span class="line"><span>// 入口参数: ddara：要写入的16位的参数</span></span>
<span class="line"><span>// 返回参数: 无</span></span>
<span class="line"><span>// 全局变量: 无</span></span>
<span class="line"><span>// 调用模块: 无</span></span>
<span class="line"><span>// 注意事项: 无</span></span>
<span class="line"><span>//</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>void SPI_Write (unsigned short ddara)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	unsigned char i;</span></span>
<span class="line"><span>	for (i = 0; i &lt; 16; i ++)</span></span>
<span class="line"><span>	{</span></span>
<span class="line"><span>		if ((ddara &amp; 0x8000) == 0x8000)</span></span>
<span class="line"><span>		{</span></span>
<span class="line"><span>			ADI_SD_HIGH;</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>		else</span></span>
<span class="line"><span>		{</span></span>
<span class="line"><span>			ADI_SD_LOW;</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>		ADI_SCL_LOW;</span></span>
<span class="line"><span>		ddara &lt;&lt;= 1;</span></span>
<span class="line"><span>		ADI_SCL_HIGH;</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>// unsigned char AD9833_Init(void)</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>//</span></span>
<span class="line"><span>// 函数功能: AD9833初始化函数</span></span>
<span class="line"><span>// 入口参数: 无</span></span>
<span class="line"><span>// 返回参数: 无</span></span>
<span class="line"><span>// 全局变量: 无</span></span>
<span class="line"><span>// 调用模块: SPI_Init(); AD9833_SetRegisterValue(),</span></span>
<span class="line"><span>// 注意事项: 无</span></span>
<span class="line"><span>//</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>unsigned char AD9833_Init(void)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>    SPI_Init();</span></span>
<span class="line"><span>    AD9833_SetRegisterValue(AD9833_REG_CMD | AD9833_RESET);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    return (1);</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>// void AD9833_Reset(void)</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>//</span></span>
<span class="line"><span>// 函数功能: AD9833复位函数</span></span>
<span class="line"><span>// 入口参数: 无</span></span>
<span class="line"><span>// 返回参数: 无</span></span>
<span class="line"><span>// 全局变量: 无</span></span>
<span class="line"><span>// 调用模块: AD9833_SetRegisterValue(),</span></span>
<span class="line"><span>// 注意事项: 无</span></span>
<span class="line"><span>//</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>void AD9833_Reset(void)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>    AD9833_SetRegisterValue(AD9833_REG_CMD | AD9833_RESET);</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>// void AD9833_ClearReset(void)</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>//</span></span>
<span class="line"><span>// 函数功能: AD9833清除复位函数</span></span>
<span class="line"><span>// 入口参数: 无</span></span>
<span class="line"><span>// 返回参数: 无</span></span>
<span class="line"><span>// 全局变量: 无</span></span>
<span class="line"><span>// 调用模块: AD9833_SetRegisterValue(),</span></span>
<span class="line"><span>//</span></span>
<span class="line"><span>// 注意事项: 无</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>void AD9833_ClearReset(void)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	AD9833_SetRegisterValue(AD9833_REG_CMD);</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>// void AD9833_SetRegisterValue(unsigned short regValue)</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>//</span></span>
<span class="line"><span>// 函数功能: 设置AD9833寄存器的值</span></span>
<span class="line"><span>// 入口参数: regValue：要设置寄存器的值</span></span>
<span class="line"><span>// 返回参数: 无</span></span>
<span class="line"><span>// 全局变量: 无</span></span>
<span class="line"><span>// 调用模块: SPI_Write(),</span></span>
<span class="line"><span>//</span></span>
<span class="line"><span>// 注意事项: 无</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>void AD9833_SetRegisterValue(unsigned short regValue)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	ADI_CS_LOW;</span></span>
<span class="line"><span>	SPI_Write(regValue);</span></span>
<span class="line"><span>	ADI_CS_HIGH;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>// unsigned long freq_trl_word(double freq)</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>unsigned long freq_trl_word(double freq) {</span></span>
<span class="line"><span>    // 假设主时钟频率为 25MHz（需根据实际硬件调整）</span></span>
<span class="line"><span>    const double F_MCLK = 25000000.0;  // AD9833 主时钟频率，例如 25MHz</span></span>
<span class="line"><span>    // 计算频率控制字 FCW = (f_out * 2^28) / F_MCLK</span></span>
<span class="line"><span>    unsigned long fcw = (unsigned long)((freq * 268435456.0) / F_MCLK);</span></span>
<span class="line"><span>    return fcw;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>// AD9833_SetFrequency  ()</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>//</span></span>
<span class="line"><span>// 函数功能: AD9833 设置频率寄存器</span></span>
<span class="line"><span>// 入口参数: reg：频率寄存器写入 wave_type：波形类型 val：值</span></span>
<span class="line"><span>// 返回参数: 无</span></span>
<span class="line"><span>// 全局变量: 无</span></span>
<span class="line"><span>// 调用模块: AD9833_SetRegisterValue(),</span></span>
<span class="line"><span>//</span></span>
<span class="line"><span>// 注意事项: 无</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>void AD9833_SetFrequency(unsigned short reg,  unsigned short wave_type,  unsigned long val)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	unsigned short  freqHi = reg;</span></span>
<span class="line"><span>	unsigned short  freqLo = reg;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>	freqHi |= (val &amp; 0xFFFC000) &gt;&gt; 14 ;</span></span>
<span class="line"><span>	freqLo |= (val &amp; 0x3FFF);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>	AD9833_SetRegisterValue(AD9833_B28);</span></span>
<span class="line"><span>	AD9833_SetRegisterValue(freqLo);</span></span>
<span class="line"><span>	AD9833_SetRegisterValue(freqHi);</span></span>
<span class="line"><span>	AD9833_SetRegisterValue(AD9833_REG_CMD | AD9833_B28 | wave_type);</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/* ***********************************************************************</span></span>
<span class="line"><span> * @brief Writes to the frequency registers.</span></span>
<span class="line"><span> *</span></span>
<span class="line"><span> * @param -  reg - Frequence register to be written to.</span></span>
<span class="line"><span> * @param -  val - The value to be written.</span></span>
<span class="line"><span> *</span></span>
<span class="line"><span> * @return  None.</span></span>
<span class="line"><span>*************************************************************************/</span></span>
<span class="line"><span>/*</span></span>
<span class="line"><span>void AD9833_SetFrequency(unsigned short reg, unsigned short wave_type, unsigned long val)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	unsigned short freqHi = reg;</span></span>
<span class="line"><span>	unsigned short freqLo = reg;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>	freqHi |= (val &amp; 0xFFFC000) &gt;&gt; 14 ;</span></span>
<span class="line"><span>	freqLo |= (val &amp; 0x3FFF);</span></span>
<span class="line"><span>	if (wave_type == 0x55)</span></span>
<span class="line"><span>	{</span></span>
<span class="line"><span>		AD9833_SetRegisterValue(AD9833_B28 | AD9833_OUT_SINUS);</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>	else if (wave_type == 0xAA)</span></span>
<span class="line"><span>	{</span></span>
<span class="line"><span>		AD9833_SetRegisterValue(AD9833_B28 | AD9833_OUT_TRIANGLE);</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>	else</span></span>
<span class="line"><span>	{</span></span>
<span class="line"><span>		AD9833_SetRegisterValue(AD9833_B28);</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>	AD9833_SetRegisterValue(freqLo);</span></span>
<span class="line"><span>	AD9833_SetRegisterValue(freqHi);</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>*/</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>// void AD9833_SetPhase(unsigned short reg, unsigned short val)</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>//</span></span>
<span class="line"><span>// 函数功能: 设置AD9833的相位寄存器的值</span></span>
<span class="line"><span>// 入口参数: reg：相位寄存器 val：值</span></span>
<span class="line"><span>// 返回参数: 无</span></span>
<span class="line"><span>// 全局变量: 无</span></span>
<span class="line"><span>// 调用模块: AD9833_SetRegisterValue(),</span></span>
<span class="line"><span>// 注意事项: 无</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>void AD9833_SetPhase(unsigned short reg, unsigned short val)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	unsigned short phase = reg;</span></span>
<span class="line"><span>	phase |= val;</span></span>
<span class="line"><span>	AD9833_SetRegisterValue(phase);</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>// void AD9833_Setup(unsigned short freq,</span></span>
<span class="line"><span>//				  unsigned short phase,</span></span>
<span class="line"><span>//			 	  unsigned short type)</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>//</span></span>
<span class="line"><span>// 函数功能: 设置AD9833的频率，相位，波形类型 的值</span></span>
<span class="line"><span>// 入口参数: freq：频率 phase：相位 type：波形类型</span></span>
<span class="line"><span>// 返回参数: 无</span></span>
<span class="line"><span>// 全局变量: 无</span></span>
<span class="line"><span>// 调用模块: AD9833_SetRegisterValue(),</span></span>
<span class="line"><span>// 注意事项: 无</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>void AD9833_Setup(unsigned short freq,</span></span>
<span class="line"><span>				  unsigned short phase,</span></span>
<span class="line"><span>			 	  unsigned short type)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	unsigned short val = 0;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>	val = freq | phase | type;</span></span>
<span class="line"><span>	AD9833_SetRegisterValue(val);</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>// void AD9833_SetWave(unsigned short type)</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>//</span></span>
<span class="line"><span>// 函数功能: 设置AD9833的波形类型</span></span>
<span class="line"><span>// 入口参数: type：波形类型</span></span>
<span class="line"><span>// 返回参数: 无</span></span>
<span class="line"><span>// 全局变量: 无</span></span>
<span class="line"><span>// 调用模块: AD9833_SetRegisterValue(),</span></span>
<span class="line"><span>// 注意事项: 无</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>void AD9833_SetWave(unsigned short type)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	AD9833_SetRegisterValue(type);</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span>
<span class="line"><span>// End Of File</span></span>
<span class="line"><span>//-----------------------------------------------------------------</span></span></code></pre></div><h2 id="串口屏" tabindex="-1">串口屏 <a class="header-anchor" href="#串口屏" aria-label="Permalink to &quot;串口屏&quot;">​</a></h2><p>资料：淘晶驰智能串口屏开发资料及规格书等下载地址： <a href="http://wiki2.tjc1688.com" target="_blank" rel="noreferrer">http://wiki2.tjc1688.com</a></p><p>figma:<a href="https://www.figma.com/login" target="_blank" rel="noreferrer">Login | Figma</a></p><p>素材网站：<a href="https://www.figma.com/community/design-templates?resource_type=mixed&amp;editor_type=figma&amp;price=free" target="_blank" rel="noreferrer">https://www.figma.com/community/design-templates?resource_type=mixed&amp;editor_type=figma&amp;price=free</a></p><p>272*480</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#页面跳转</span></span></code></pre></div><h3 id="二维码控件" tabindex="-1">二维码控件 <a class="header-anchor" href="#二维码控件" aria-label="Permalink to &quot;二维码控件&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span> //给qr0赋值字符串</span></span>
<span class="line"><span> printf(&quot;qr0.txt=\&quot;https://www.baidu.com&quot;\xff\xff\xff&quot;);</span></span></code></pre></div><h2 id="蜂鸣器beep" tabindex="-1">蜂鸣器BEEP <a class="header-anchor" href="#蜂鸣器beep" aria-label="Permalink to &quot;蜂鸣器BEEP&quot;">​</a></h2><h3 id="定时器设置" tabindex="-1">定时器设置 <a class="header-anchor" href="#定时器设置" aria-label="Permalink to &quot;定时器设置&quot;">​</a></h3><p>htim5</p><p><img src="/XIAOHUANG_BLOG/assets/image-20250702115856836_1.DJOebOQV.png" alt="image-20250702115856836" loading="lazy"></p><p>beep.h</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#ifndef SRC_BEEP_BEEP_H_</span></span>
<span class="line"><span>#define SRC_BEEP_BEEP_H_</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#include &quot;main.h&quot;</span></span>
<span class="line"><span>#include &quot;tim.h&quot;</span></span>
<span class="line"><span>#include &quot;tim_it.h&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#define BEEPPORT  GPIOD</span></span>
<span class="line"><span>#define BEEPPIN GPIO_PIN_0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>void beep_ring(void);</span></span>
<span class="line"><span>void beep_notring(void);</span></span>
<span class="line"><span>void beep_atime(int t_ms);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#endif /* SRC_BEEP_BEEP_H_ */</span></span></code></pre></div><p>beep.c</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#include &quot;beep.h&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>void beep_ring(void){</span></span>
<span class="line"><span>	HAL_GPIO_WritePin(BEEPPORT,BEEPPIN,GPIO_PIN_SET);</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>void beep_notring(void){</span></span>
<span class="line"><span>	HAL_GPIO_WritePin(BEEPPORT,BEEPPIN,GPIO_PIN_RESET);</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>void beep_atime(int t_ms){</span></span>
<span class="line"><span>	count_timeflag=0;</span></span>
<span class="line"><span>	beep_ring();</span></span>
<span class="line"><span>	HAL_TIM_Base_Start_IT(&amp;htim5);</span></span>
<span class="line"><span>}</span></span></code></pre></div><p><img src="/XIAOHUANG_BLOG/assets/image-20250702113845810_1.DUG8KH8O.png" alt="image-20250702113845810" loading="lazy"></p><p>在<strong>void</strong> <strong>HAL_TIM_PeriodElapsedCallback</strong>(TIM_HandleTypeDef *htim){下：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>int count_timeflag=0;</span></span>
<span class="line"><span>int count_time=0;</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>else if(htim==&amp;TIME_BEEP){</span></span>
<span class="line"><span></span></span>
<span class="line"><span>		if(count_timeflag&gt;=0){</span></span>
<span class="line"><span>			count_timeflag++;</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>		else{</span></span>
<span class="line"><span></span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>		if(count_timeflag&gt;500){</span></span>
<span class="line"><span>			count_timeflag=-1;</span></span>
<span class="line"><span>			beep_notring();</span></span>
<span class="line"><span>			HAL_TIM_Base_Stop(&amp;htim5);</span></span>
<span class="line"><span>		}</span></span>
<span class="line"><span>	}</span></span></code></pre></div><h2 id="错误解决" tabindex="-1">错误解决 <a class="header-anchor" href="#错误解决" aria-label="Permalink to &quot;错误解决&quot;">​</a></h2><h3 id="软件型错误" tabindex="-1">软件型错误 <a class="header-anchor" href="#软件型错误" aria-label="Permalink to &quot;软件型错误&quot;">​</a></h3><blockquote><p>设备管理器中无端口：<a href="https://blog.csdn.net/m0_69455439/article/details/138731100?ops_request_misc=%7B%22request%5Fid%22%3A%22c042a6212ad6eaef47c96010bc23fd99%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=c042a6212ad6eaef47c96010bc23fd99&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-138731100-null-null.142%5Ev100%5Epc_search_result_base3&amp;utm_term=%E7%94%B5%E8%84%91%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86%E5%99%A8%E6%B2%A1%E6%9C%89%E7%AB%AF%E5%8F%A3%E9%80%89%E9%A1%B9&amp;spm=1018.2226.3001.4187" target="_blank" rel="noreferrer">【Win10设备管理器中无端口选项】_设备管理器没有端口-CSDN博客</a></p></blockquote><blockquote><p>stlink固件升级</p><p>最新：直接在ide中更新，无法更新则多次插拔识别</p><p>This version ofSTM32CubelDE provides a newer firmware version of theattached ST-LlNK. Proceed with update?</p><p>安装</p><p>参考：<a href="https://blog.csdn.net/qq_52102933/article/details/126830904" target="_blank" rel="noreferrer">ST-Link驱动的下载、安装、配置，以及ST-Link固件的升级_stlink驱动-CSDN博客</a></p><p>官方下载地址：<a href="https://www.st.com/zh/development-tools/stsw-link009.html/" target="_blank" rel="noreferrer">https://www.st.com/zh/development-tools/stsw-link009.html/</a></p><ol><li>右键“<strong>以管理员身份运行</strong>”打开ST-Link驱动安装包。   先将压缩包“<code>en.stsw-link009.zip</code>”解压后，再根据自己的操作系统打开对应的安装包，64位的选择“<code>dpinst_amd64.exe</code>”，32位的选择“<code>dpinst_x86.exe</code>”。</li></ol><p>升级</p><p>进入“ST官网”，找到“STSW-LINK007”。   STSW-LINK007是ST-LINK、ST-LINK/V2、ST-LINK/V2-1和STLINK-V3的固件升级工具包。</p><p>官方下载地址：<a href="https://www.st.com/zh/development-tools/stsw-link007.html/" target="_blank" rel="noreferrer">https://www.st.com/zh/development-tools/stsw-link007.html/</a></p></blockquote><h3 id="移植性错误" tabindex="-1">移植性错误 <a class="header-anchor" href="#移植性错误" aria-label="Permalink to &quot;移植性错误&quot;">​</a></h3><h4 id="时钟" tabindex="-1">时钟 <a class="header-anchor" href="#时钟" aria-label="Permalink to &quot;时钟&quot;">​</a></h4><p>请在移植代码前给时钟一个值</p><h4 id="f1改f4" tabindex="-1">f1改f4 <a class="header-anchor" href="#f1改f4" aria-label="Permalink to &quot;f1改f4&quot;">​</a></h4><blockquote><p>fatal error: stm32f10x.h: No such file or directory</p><p>解决</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#include &quot;stm32f4xx_hal.h&quot;</span></span></code></pre></div></blockquote><h4 id="u8-等定义不存在" tabindex="-1">&#39;u8&#39;等定义不存在 <a class="header-anchor" href="#u8-等定义不存在" aria-label="Permalink to &quot;&#39;u8&#39;等定义不存在&quot;">​</a></h4><blockquote><p>解决：unknown type name &#39;u8&#39;</p><p>重新定义</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>typedef uint8_t u8;</span></span>
<span class="line"><span>typedef uint16_t u16;</span></span></code></pre></div><p>然后导入</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#include &quot;../redefine/redefine_sys.h&quot;</span></span></code></pre></div></blockquote><h4 id="gpio-pin-7-等定义引脚不存在" tabindex="-1">&#39;GPIO_Pin_7&#39;等定义引脚不存在 <a class="header-anchor" href="#gpio-pin-7-等定义引脚不存在" aria-label="Permalink to &quot;&#39;GPIO_Pin_7&#39;等定义引脚不存在&quot;">​</a></h4><blockquote><p>&#39;GPIO_Pin_7&#39; undeclared (first use in this function); did you mean &#39;GPIO_PIN_7&#39;?</p><p>解决：</p><p>先include</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span></span></span></code></pre></div><p>改成大写</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>&#39;GPIO_PIN_7</span></span></code></pre></div></blockquote><h4 id="for循环不规范缺少括号" tabindex="-1">for循环不规范缺少括号 <a class="header-anchor" href="#for循环不规范缺少括号" aria-label="Permalink to &quot;for循环不规范缺少括号&quot;">​</a></h4><blockquote><p>../Core/Src/spi_tft/GUI.c:305:21: warning: this &#39;for&#39; clause does not guard... [-Wmisleading-indentation]</p><p>305 | for(i=0;i&lt;16;i++)</p><p>解决: 添加{}</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>for(i=0;i&lt;16;i++){</span></span>
<span class="line"><span>	XXXX;</span></span>
<span class="line"><span>	XXXX;</span></span>
<span class="line"><span>}</span></span></code></pre></div></blockquote><h4 id="u8-与-unsigned-char-类型不一致" tabindex="-1">u8 * 与 unsigned char * 类型不一致 <a class="header-anchor" href="#u8-与-unsigned-char-类型不一致" aria-label="Permalink to &quot;u8 * 与 unsigned char * 类型不一致&quot;">​</a></h4><blockquote><p>../Core/Src/spi_tft/GUI.h:20:59: note: expected &#39;u8 *&#39; {aka &#39;unsigned char *&#39;} but argument is of type &#39;char *&#39; 20 | void Gui_DrawFont_GBK16(u16 x, u16 y, u16 fc, u16 bc, u8 *s);</p><p>解决： 修改定义，从注释修改成如下</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>//void Gui_DrawFont_GBK24(u16 x, u16 y, u16 fc, u16 bc, u8 *s)</span></span>
<span class="line"><span>void Gui_DrawFont_GBK24(u16 x, u16 y, u16 fc, u16 bc, unsigned char *s)</span></span></code></pre></div></blockquote><h4 id="unsigned-char-与char-不一致" tabindex="-1">unsigned char *与char *不一致 <a class="header-anchor" href="#unsigned-char-与char-不一致" aria-label="Permalink to &quot;unsigned char *与char *不一致&quot;">​</a></h4><blockquote><p>../Core/Src/spi_tft/QDTFT_demo.c:63:45: warning: pointer targets in passing argument 5 of &#39;Gui_DrawFont_GBK16&#39; differ in signedness [-Wpointer-sign] 63 | Gui_DrawFont_GBK16(20,10,BLUE,GRAY0,&quot;Color Test&quot;); | ^~~~~~~~~~~~ | | | char * ../Core/Src/spi_tft/GUI.h:22:70: note: expected &#39;unsigned char *&#39; but argument is of type &#39;char *&#39; 22 | void Gui_DrawFont_GBK16(u16 x, u16 y, u16 fc, u16 bc, unsigned char *s);</p><p>解决：强转(unsigned char *)</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Gui_DrawFont_GBK16(20, 10, BLUE, GRAY0, (unsigned char *)&quot;Color Test&quot;);</span></span></code></pre></div></blockquote><h2 id="其他" tabindex="-1">其他 <a class="header-anchor" href="#其他" aria-label="Permalink to &quot;其他&quot;">​</a></h2><img src="/XIAOHUANG_BLOG/assets/image-20241124215954547_1.CxUuxWk5.png" alt="image-20241124215954547" style="zoom:25%;"><img src="/XIAOHUANG_BLOG/assets/image-20241124215921790_1.hViL6LKS.png" alt="image-20241124215921790" style="zoom:25%;"><h2 id="dsp库" tabindex="-1">DSP库 <a class="header-anchor" href="#dsp库" aria-label="Permalink to &quot;DSP库&quot;">​</a></h2><h2 id="工程" tabindex="-1">工程 <a class="header-anchor" href="#工程" aria-label="Permalink to &quot;工程&quot;">​</a></h2><h3 id="文件新建" tabindex="-1">文件新建 <a class="header-anchor" href="#文件新建" aria-label="Permalink to &quot;文件新建&quot;">​</a></h3><p>自建模板</p><p>新建文件夹Sample，包含</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CORE</span></span>
<span class="line"><span>USER</span></span>
<span class="line"><span>FWLIB</span></span>
<span class="line"><span>OBJ</span></span>
<span class="line"><span>SYSTEM</span></span></code></pre></div><p><img src="data:image/png;base64,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" alt="image-20241206212456010" loading="lazy"></p><p>打开keil，Project中新建工程，放在User中，起名为Sample，确认后选择如下</p><img src="/XIAOHUANG_BLOG/assets/image-20241206212813187_1.DkRydoKk.png" alt="image-20241206212813187" style="zoom:50%;"><p>然后设置</p><img src="/XIAOHUANG_BLOG/assets/image-20241206212903034_1.COanrU7o.png" alt="image-20241206212903034" style="zoom:50%;"><p>除了OJB其他都添加进去</p><img src="/XIAOHUANG_BLOG/assets/image-20241206213022445_1.C65bbhgy.png" alt="image-20241206213022445" style="zoom:50%;"><p>从官方库中复制以下包到对应目录</p><p>官方下载地址：<a href="https://www.st.com/en/embedded-software/stsw-stm32065.html?spm=5176.28103460.0.0.2e6b5d27sCNp7N#st_all-features_sec-nav-tab" target="_blank" rel="noreferrer">STSW-STM32065 - STM32F4 DSP and standard peripherals library - STMicroelectronics</a></p><p>文件： <a href="./stm32f407zgt6_localdata/en.stsw-stm32065_v1-9-0.html">en.stsw-stm32065_v1-9-0</a></p><blockquote><p>FWLIB的增加</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>inc文件夹、src文件夹</span></span>
<span class="line"><span>来自</span></span>
<span class="line"><span>D:\DS_diansai\STM32f407zgt6\淘宝资料\STM32F407ZGT6板（核心板）-144P-资料\en.stsw-stm32065_v1-9-0\STM32F4xx_DSP_StdPeriph_Lib_V1.9.0\Libraries\STM32F4xx_StdPeriph_Driver</span></span>
<span class="line"><span>的inc、src-&gt;FWLIB下</span></span></code></pre></div></blockquote><blockquote><p>CORE的增加</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>startup_stm32f40_41xxx</span></span>
<span class="line"><span>来自</span></span>
<span class="line"><span>D:\DS_diansai\STM32f407zgt6\淘宝资料\STM32F407ZGT6板（核心板）-144P-资料\en.stsw-stm32065_v1-9-0\STM32F4xx_DSP_StdPeriph_Lib_V1.9.0\Libraries\CMSIS\Device\ST\STM32F4xx\Source\Templates\arm\startup_stm32f40_41xxx.s</span></span></code></pre></div><img src="/XIAOHUANG_BLOG/assets/image-20241206215520785_1.CL1TB98Y.png" alt="image-20241206215520785" style="zoom:50%;"><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>core_cmSimd.h</span></span>
<span class="line"><span>core_cmInstr.h</span></span>
<span class="line"><span>core_cmFunc.h</span></span>
<span class="line"><span>core_cm4.h</span></span>
<span class="line"><span>来自</span></span>
<span class="line"><span>D:\DS_diansai\STM32f407zgt6\淘宝资料\STM32F407ZGT6板（核心板）-144P-资料\en.stsw-stm32065_v1-9-0\STM32F4xx_DSP_StdPeriph_Lib_V1.9.0\Libraries\CMSIS\Include</span></span></code></pre></div></blockquote><blockquote><p>USER的增加</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>stm32f4xx.h</span></span>
<span class="line"><span>system_stm32f4xx.h</span></span>
<span class="line"><span>来自</span></span>
<span class="line"><span>D:\DS_diansai\STM32f407zgt6\淘宝资料\STM32F407ZGT6板（核心板）-144P-资料\en.stsw-stm32065_v1-9-0\STM32F4xx_DSP_StdPeriph_Lib_V1.9.0\Libraries\CMSIS\Device\ST\STM32F4xx\Include</span></span></code></pre></div><img src="/XIAOHUANG_BLOG/assets/image-20241206220121410_1.6GrB8kw_.png" alt="image-20241206220121410" style="zoom:50%;"><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>main.c</span></span>
<span class="line"><span>stm32f4xx_conf.h</span></span>
<span class="line"><span>stm32f4xx_it.c</span></span>
<span class="line"><span>stm32f4xx_it.h</span></span>
<span class="line"><span>system_stm32f4xx.c</span></span>
<span class="line"><span>来自：</span></span>
<span class="line"><span>D:\DS_diansai\STM32f407zgt6\淘宝资料\STM32F407ZGT6板（核心板）-144P-资料\en.stsw-stm32065_v1-9-0\STM32F4xx_DSP_StdPeriph_Lib_V1.9.0\Project\STM32F4xx_StdPeriph_Templates</span></span></code></pre></div></blockquote><p>添加文件到工程</p><blockquote><p>USER</p><img src="/XIAOHUANG_BLOG/assets/image-20241206220332575_1.1_ugAlqC.png" alt="image-20241206220332575" style="zoom:50%;"><p>CORE</p><img src="/XIAOHUANG_BLOG/assets/image-20241206220505463_1.ByrFYcBG.png" alt="image-20241206220505463" style="zoom:50%;"><p>FWLIB——添加scr里面的所有文件</p><img src="/XIAOHUANG_BLOG/assets/image-20241206220736887_1.cEdHDgLB.png" alt="image-20241206220736887" style="zoom:50%;"></blockquote><p>添加路径——魔术棒</p><img src="/XIAOHUANG_BLOG/assets/image-20241206221219746_1.DfjiW0Pi.png" alt="image-20241206221219746" style="zoom:50%;"><p>添加宏定义</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>STM32F40_41xxx,USE_STDPERIPH_DRIVER</span></span></code></pre></div><img src="/XIAOHUANG_BLOG/assets/image-20241206221512541_1.D_XrF8dR.png" alt="image-20241206221512541" style="zoom:50%;"><p>魔术棒Output勾选Create HEX File,并把生成路径改在OBJ中</p><img src="/XIAOHUANG_BLOG/assets/image-20241206221610180_1.DZn83iG8.png" alt="image-20241206221610180" style="zoom:50%;"><img src="/XIAOHUANG_BLOG/assets/image-20241206221705944_1.BXpgcU_F.png" alt="image-20241206221705944" style="zoom:50%;"><p>使用如下替换main.c的内容</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#include &quot;stm32f4xx.h&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>int main(void)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  while(1){</span></span>
<span class="line"><span>	}</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>最后删除USER-stm32f4xx_it.c中的</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#include &quot;main.h</span></span>
<span class="line"><span>#TimingDelay_Decrement();</span></span></code></pre></div><h3 id="新建文件" tabindex="-1">新建文件 <a class="header-anchor" href="#新建文件" aria-label="Permalink to &quot;新建文件&quot;">​</a></h3><p>如gpio</p><p>.h</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#ifndef __GPIO_H</span></span>
<span class="line"><span>#define __GPIO_H	 </span></span>
<span class="line"><span>#include &quot;stm32f4xx.h&quot; </span></span>
<span class="line"><span></span></span>
<span class="line"><span>#endif</span></span></code></pre></div><p>.c</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#include &quot;stm32f4xx.h&quot;</span><span>                  // Device header</span></span></code></pre></div></div></div></main><footer class="VPDocFooter" data-v-e6f2a212 data-v-1bcd8184><!--[--><!--]--><!----><!----></footer><!--[--><!--[--><!--[--><div style="margin-top:24px;"><!----></div><!--]--><!--]--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter" data-v-d8b57b2d data-v-566314d4><div class="container" data-v-566314d4><!----><p class="copyright" data-v-566314d4>Copyright © 2025-present 小黄</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api-examples.md\":\"nFZcMRwR\",\"docs_硬件资料_linux笔记_linux常用代码指令_linux中安装miniconda.md\":\"C8EDxlU7\",\"docs_硬件资料_linux笔记_linux常用代码指令_linux常用代码指令.md\":\"BDC46kd8\",\"docs_硬件资料_微控制器mcu_stm32f407zgt6_pcb设计_stm32f407zgt6_pcb.md\":\"BBuIcTz5\",\"docs_硬件资料_微控制器mcu_stm32f407zgt6_基础资料_stm32f407zgt6.md\":\"CZIz3rhy\",\"docs_硬件资料_微控制器mcu_ti_mspm0g3507_基础资料_ti_mspm0.md\":\"CnghvjQo\",\"docs_硬件资料_树莓派_树莓派.md\":\"B5nb-aml\",\"docs_硬件资料_驱动代码_光流计_mtf01光流计_mtf01光流计.md\":\"BMQ940F2\",\"docs_硬件资料_驱动代码_力传感器_s型拉压传感器与hx711驱动_s型拉压传感器与hx711.md\":\"CoqrZDXv\",\"docs_硬件资料_驱动代码_摄像头_openmv_openmv.md\":\"NeKaKlbY\",\"docs_硬件资料_驱动电路_直流转直流_ams1117-3.3的_5v转_3v3线性稳压电路.md\":\"-m0F3Jwv\",\"docs_算法笔记_优化算法_带遗忘因子的递推最小二乘算法.md\":\"D8Ogki5i\",\"docs_算法笔记_优化算法_最小二乘算法ols.md\":\"BktgEd1a\",\"docs_算法笔记_优化算法_递推最小二乘算法rls.md\":\"BE4xsH6x\",\"docs_算法笔记_数学基础_时域频域转换公式.md\":\"DIG4YpKu\",\"docs_算法笔记_数学基础_泰勒展开.md\":\"CiwKw5A1\",\"docs_算法笔记_数据融合算法_mashony算法.md\":\"WBtoH9bB\",\"docs_算法笔记_数据融合算法_卡尔曼滤波算法.md\":\"CCAi49DV\",\"docs_算法笔记_物理基础_加速度合成定理.md\":\"CM7-iq1h\",\"docs_论文阅读_信息融合_分布式最小误差熵卡尔曼滤波zhenyufeng_分布式最小误差熵卡尔曼滤波zhenyufeng.md\":\"B_gzq1jM\",\"docs_软件资料_python小软件_pdf图片压缩工具.md\":\"DqpCzdch\",\"docs_软件资料_常用软件_md笔记_typora使用帮助.md\":\"CS2gpcvG\",\"index.md\":\"BU-go0FB\",\"markdown-examples.md\":\"Bl6dp7wy\",\"xiaohuang_mdwork_个人主页_个人主页.md\":\"CpaVeCvy\",\"xiaohuang_mdwork_前端导航_前端导航目录.md\":\"BKOK5KBz\",\"xiaohuang_mdwork_前端导航_索引_zlibrary镜像.md\":\"CaDew8vf\",\"xiaohuang_mdwork_快速软件_md文档提取工具_markdown文本自动提取软件.md\":\"DFYZbsco\",\"xiaohuang_mdwork_测试_test.md\":\"D1HdOpim\",\"xiaohuang_mdwork_测试_test2.md\":\"DNx6wTdH\",\"xiaohuang_mdwork_测试_test3.md\":\"vK9elGTr\",\"xiaohuang_mdwork_硬件资料_硬件资料主页目录.md\":\"Q0ZKukKS\",\"xiaohuang_mdwork_算法笔记_算法笔记主页目录.md\":\"CWGVp-un\",\"xiaohuang_mdwork_联系我们_联系我们.md\":\"ruEC9t9j\",\"xiaohuang_mdwork_论文阅读_论文阅读主页目录.md\":\"HMYyrDvC\",\"xiaohuang_mdwork_语法笔记_python代码语法.md\":\"UVmdtI8D\",\"xiaohuang_mdwork_软件资料_软件资料目录.md\":\"CIufjWB7\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-CN\",\"dir\":\"ltr\",\"title\":\"小黄同学的在线笔记\",\"description\":\"FOR IDEA\",\"base\":\"/XIAOHUANG_BLOG/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":\"dark\",\"themeConfig\":{\"outlineTitle\":\"目录\",\"outline\":[1,6],\"sidebar\":false,\"aside\":\"left\",\"logo\":\"/icons/网站/笔记本.png\",\"nav\":[{\"text\":\"首页\",\"link\":\"/\"},{\"text\":\"前端导航\",\"link\":\"/xiaohuang_mdwork/前端导航/前端导航目录.md\"},{\"text\":\"功能网站\",\"items\":[{\"text\":\"svg转icon\",\"link\":\"https://cdkm.com/cn/svg-to-ico\"},{\"text\":\"阿里icon库\",\"link\":\"https://www.iconfont.cn/\"},{\"text\":\"Deepseek\",\"link\":\"https://www.deepseek.com/\"},{\"text\":\"通义千问\",\"link\":\"https://www.tongyi.com/\"},{\"text\":\"高保真图\",\"link\":\"https://pixabay.com/zh/\"},{\"text\":\"建站速通\",\"link\":\"https://docs.bugdesigner.cn/README.html#%E9%83%A8%E7%BD%B2%E6%AD%A5%E9%AA%A4\"}]},{\"text\":\"快速软件\",\"items\":[{\"text\":\"Markdown快速导出工具\",\"link\":\"/xiaohuang_mdwork/快速软件/md文档提取工具/Markdown文本自动提取软件.md\"}]},{\"text\":\"语法笔记\",\"items\":[{\"text\":\"Python\",\"link\":\"/xiaohuang_mdwork/语法笔记/Python代码语法.md\"}]},{\"text\":\"算法笔记\",\"link\":\"/xiaohuang_mdwork/算法笔记/算法笔记主页目录.md\"}],\"search\":{\"provider\":\"local\",\"options\":{\"translations\":{\"button\":{\"buttonText\":\"搜索文档\",\"buttonAriaLabel\":\"搜索文档\"},\"modal\":{\"noResultsText\":\"无法找到结果\",\"resetButtonTitle\":\"清除查询条件\",\"footer\":{\"selectText\":\"选择\",\"navigateText\":\"切换\"}}}}},\"socialLinks\":[{\"icon\":{\"svg\":\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"24\\\" height=\\\"24\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"currentColor\\\"><path d=\\\"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z\\\"/></svg>\"},\"link\":\"mailto:2727678986@qq.com\",\"ariaLabel\":\"发送邮件\"},{\"icon\":\"github\",\"link\":\"https://github.com/xiaohuangstudent\"},{\"icon\":{\"svg\":\"<svg t=\\\"1751117659737\\\" class=\\\"icon\\\" viewBox=\\\"0 0 1024 1024\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" p-id=\\\"1503\\\" width=\\\"64\\\" height=\\\"64\\\"><path d=\\\"M729.32864 373.94944c-9.79456-5.94432-19.06176-6.784-19.14368-6.784l-1.06496-0.0512c-57.20064-3.8656-121.1648-5.83168-190.12608-5.83168l-13.98784 0.00512c-68.95616 0-132.92544 1.96096-190.12096 5.83168l-1.06496 0.0512c-0.08192 0-9.34912 0.83968-19.14368 6.784-15.04768 9.12896-24.27392 25.94816-27.4176 49.9712-10.07104 76.91264-4.38272 173.64992 0.18944 251.392 2.93888 49.96608 33.408 62.45888 85.04832 67.1488 10.78272 0.98816 69.08928 5.86752 159.50848 5.89312v-0.00512c90.4192-0.02048 148.72576-4.90496 159.5136-5.888 51.64032-4.68992 82.10944-17.18272 85.0432-67.1488 4.57728-77.74208 10.26048-174.47936 0.18944-251.392-3.1488-24.02816-12.37504-40.84736-27.42272-49.97632z m-390.9888 172.71808a23.64928 23.64928 0 0 1-31.68768-10.84416 23.68 23.68 0 0 1 10.84416-31.68768c2.03776-1.00352 50.69312-24.72448 110.5408-43.06432a23.68 23.68 0 1 1 13.88032 45.29152c-56.2944 17.24928-103.11168 40.07424-103.5776 40.30464z m268.89728 35.88608c-0.44032 2.23232-11.26912 54.64064-50.93888 54.64064-21.44256 0-36.10112-14.04928-44.98432-26.77248-8.69376 12.70784-22.80448 26.77248-42.65472 26.77248-35.5328 0-50.13504-48.26624-51.68128-53.77024a11.3664 11.3664 0 0 1 21.87776-6.1696c2.74944 9.6512 14.1312 37.20192 29.7984 37.20192 16.37376 0 28.89216-23.64416 31.98464-31.92832a11.37152 11.37152 0 0 1 10.6496-7.38816h0.06144c4.76672 0.03072 9.0112 3.02592 10.62912 7.50592 0.10752 0.28672 11.96544 31.81568 34.31424 31.81568 20.864 0 28.56448-35.95264 28.64128-36.32128a11.34592 11.34592 0 0 1 13.35808-8.93952 11.36128 11.36128 0 0 1 8.94464 13.35296z m110.11584-46.73536a23.68 23.68 0 0 1-31.68256 10.84416c-0.47104-0.2304-47.47264-23.1168-103.57248-40.30976a23.69024 23.69024 0 0 1-15.70816-29.58336 23.66976 23.66976 0 0 1 29.57824-15.70304c59.84768 18.33984 108.49792 42.0608 110.55104 43.06432a23.68 23.68 0 0 1 10.83392 31.68768z\\\" fill=\\\"#F16C8D\\\" p-id=\\\"1504\\\"></path><path d=\\\"M849.92 51.2H174.08c-67.8656 0-122.88 55.0144-122.88 122.88v675.84c0 67.87072 55.0144 122.88 122.88 122.88h675.84c67.87072 0 122.88-55.00928 122.88-122.88V174.08c0-67.86048-55.00928-122.88-122.88-122.88z m-36.60288 627.45088c-2.62656 44.57984-21.82144 78.63296-55.51616 98.48832-25.68192 15.13472-54.17472 19.48672-81.13664 21.9392-32.45568 2.94912-92.71808 6.09792-164.66432 6.1184-71.94112-0.02048-132.20864-3.16416-164.66432-6.1184-26.96192-2.45248-55.45472-6.80448-81.13152-21.9392-33.69472-19.85536-52.8896-53.90336-55.51104-98.4832-4.70528-80.13312-10.5728-179.85536 0.19456-262.10816C221.5424 335.16544 280.99072 311.57248 311.5008 310.37952a2482.64192 2482.64192 0 0 1 81.42336-4.08576c-7.53664-8.53504-19.88096-23.3216-28.81536-38.11328-13.73696-22.73792 8.52992-41.68704 8.52992-41.68704s23.68-20.36736 44.52864 5.21216c15.69792 19.26656 38.37952 55.99744 48.61952 72.95488l53.20704-0.21504c13.2608 0 26.33216 0.07168 39.2192 0.21504 10.24-16.95744 32.9216-53.6832 48.61952-72.95488 20.84352-25.57952 44.52864-5.21216 44.52864-5.21216s22.26176 18.94912 8.5248 41.68704c-8.9344 14.79168-21.27872 29.57824-28.81536 38.11328 28.35968 0.97792 55.56224 2.33984 81.42336 4.08064 30.5152 1.19808 89.9584 24.79104 100.61312 106.17344 10.7776 82.24768 4.9152 181.96992 0.20992 262.10304z\\\" fill=\\\"#F16C8D\\\" p-id=\\\"1505\\\"></path></svg>\"},\"link\":\"https://space.bilibili.com/3493126956124793?spm_id_from=333.788.0.0\"}],\"footer\":{\"copyright\":\"Copyright © 2025-present 小黄\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>