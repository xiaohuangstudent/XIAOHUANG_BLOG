import{_ as i,o as a,c as n,a4 as l}from"./chunks/framework.PZCYvDoh.js";const E=JSON.parse('{"title":"OpenMV","description":"","frontmatter":{},"headers":[],"relativePath":"docs/硬件资料/驱动代码/摄像头/Openmv/Openmv.md","filePath":"docs/硬件资料/驱动代码/摄像头/Openmv/Openmv.md"}'),p={name:"docs/硬件资料/驱动代码/摄像头/Openmv/Openmv.md"};function e(t,s,h,k,r,d){return a(),n("div",null,[...s[0]||(s[0]=[l(`<h1 id="openmv" tabindex="-1">OpenMV <a class="header-anchor" href="#openmv" aria-label="Permalink to &quot;OpenMV&quot;">​</a></h1><p>函数参考：<a href="https://book.openmv.cc/python-background.html" target="_blank" rel="noreferrer">Python背景知识 · OpenMV中文入门教程</a></p><p>官方函数参考：<a href="https://docs.openmv.io/search.html?q=lab&amp;check_keywords=yes&amp;area=default#" target="_blank" rel="noreferrer">Search — MicroPython 1.24 documentation</a></p><p><a href="https://docs.singtown.com/micropython/zh/latest/openmvcam/library/omv.image.html" target="_blank" rel="noreferrer">image — 机器视觉 — MicroPython 1.22 文档</a></p><h2 id="色域" tabindex="-1">色域 <a class="header-anchor" href="#色域" aria-label="Permalink to &quot;色域&quot;">​</a></h2><h3 id="lab" tabindex="-1">LAB <a class="header-anchor" href="#lab" aria-label="Permalink to &quot;LAB&quot;">​</a></h3><p><strong>LAB</strong>（又称<strong>CIE LAB</strong>）是一个颜色空间，它基于人类视觉感知的方式来表示颜色，常用于图像分析和处理。LAB颜色空间的三个分量分别为：</p><ol><li><strong>L</strong>：表示亮度（Lightness），从0到100，0代表黑色，100代表白色。</li><li><strong>A</strong>：表示绿色到红色的色差，值范围通常为-128到128，负值表示绿色，正值表示红色。</li><li><strong>B</strong>：表示蓝色到黄色的色差，值范围通常为-128到128，负值表示蓝色，正值表示黄色。</li></ol><h2 id="helloworld" tabindex="-1">helloworld <a class="header-anchor" href="#helloworld" aria-label="Permalink to &quot;helloworld&quot;">​</a></h2><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 本作品采用MIT许可证授权。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 版权所有 (c) 2013-2023 OpenMV LLC。保留所有权利。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># https://github.com/openmv/openmv/blob/master/LICENSE</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 你好世界示例</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 欢迎使用OpenMV IDE！点击下方的绿色运行箭头按钮来运行脚本！</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sensor</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> time</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sensor.reset()  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 重置并初始化传感器。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sensor.set_pixformat(sensor.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RGB565</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 将像素格式设置为RGB565 (or GRAYSCALE)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sensor.set_framesize(sensor.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">QVGA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 将帧大小设置为QVGA (320x240)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sensor.skip_frames(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">time</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 等待设置生效。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">clock </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> time.clock()  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 创建一个时钟对象来跟踪FPS。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">while</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    clock.tick()  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 更新FPS时钟。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    img </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sensor.snapshot()  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 拍照并返回图像。</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(clock.fps())  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 注意：OpenMV摄像头在连接至IDE时运行速度会降低约一半。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 断开连接后，帧率应会提升。</span></span></code></pre></div><h2 id="延时拍照" tabindex="-1">延时拍照 <a class="header-anchor" href="#延时拍照" aria-label="Permalink to &quot;延时拍照&quot;">​</a></h2><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 保存图片例程</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 注意:您需要一张SD卡来运行这个例子</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 你可以使用你的OpenMV摄像头来保存图像文件</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sensor</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> time</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> machine</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sensor.reset()  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 初始化sensor</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sensor.set_pixformat(sensor.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RGB565</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置图像色彩格式，有RGB565色彩图和GRAYSCALE灰度图两种</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sensor.set_framesize(sensor.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">QVGA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置图像像素大小 QVGA (320x240)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sensor.skip_frames(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">time</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 让新的设置生效</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">led </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> machine.LED(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;LED_BLUE&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">start </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> time.ticks_ms()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> time.ticks_diff(time.ticks_ms(), start) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    sensor.snapshot()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    led.toggle()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">led.off()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">img </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sensor.snapshot()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">img.save(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;example.jpg&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># or &quot;example.bmp&quot; (or others)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">raise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Exception</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Please reset the camera to see the new file.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><h2 id="像素操作" tabindex="-1">像素操作 <a class="header-anchor" href="#像素操作" aria-label="Permalink to &quot;像素操作&quot;">​</a></h2><ul><li>获取/设置像素点</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>img = sensor.snapshot()</span></span>
<span class="line"><span>img.get_pixel(10,10)</span></span>
<span class="line"><span>img.set_pixcel(10,10,(255,0,0))#设置坐标(10,10)的像素点为红色(255,0,0)</span></span></code></pre></div><ul><li>获取图像的宽度和高度、灰度还是彩图、图像大小</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>image.width()</span></span>
<span class="line"><span>返回图像的宽度(像素)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>image.height()</span></span>
<span class="line"><span>返回图像的高度(像素)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>image.format()</span></span>
<span class="line"><span>灰度图会返回 sensor.GRAYSCALE，彩色图会返回 sensor.RGB565。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>image.size()</span></span>
<span class="line"><span>返回图像的大小(byte)</span></span></code></pre></div><ul><li>二值化图像反色</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>image.invert()</span></span>
<span class="line"><span>取反，对于二值化的图像，0(黑)变成1(白)，1(白)变成0(黑)。</span></span></code></pre></div><ul><li>两图像与非、或非、异或、异或非</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>image.nand(image)</span></span>
<span class="line"><span>与另一个图片进行与非（NAND）运算。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>image.nor(image)</span></span>
<span class="line"><span>与另一个图片进行或非（NOR）运算。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>image.xor(image)</span></span>
<span class="line"><span>与另一个图片进行异或（XOR）运算。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>image.xnor(image)</span></span>
<span class="line"><span>与另一个图片进行异或非（XNOR）运算。</span></span></code></pre></div><ul><li>两图像相减</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>image.difference(image)</span></span>
<span class="line"><span>从这张图片减去另一个图片。比如，对于每个通道的每个像素点，取相减绝对值操作。这个函数，经常用来做移动检测。</span></span></code></pre></div><h2 id="统计信息与图像算法" tabindex="-1">统计信息与图像算法 <a class="header-anchor" href="#统计信息与图像算法" aria-label="Permalink to &quot;统计信息与图像算法&quot;">​</a></h2><h3 id="roi感兴趣区域" tabindex="-1">ROI感兴趣区域 <a class="header-anchor" href="#roi感兴趣区域" aria-label="Permalink to &quot;ROI感兴趣区域&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>roi的格式是(x, y, w, h)的tupple.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>x:ROI区域中左上角的x坐标</span></span>
<span class="line"><span>y:ROI区域中左上角的y坐标</span></span>
<span class="line"><span>w:ROI的宽度</span></span>
<span class="line"><span>h:ROI的高度</span></span></code></pre></div><h3 id="statistics" tabindex="-1">statistics <a class="header-anchor" href="#statistics" aria-label="Permalink to &quot;statistics&quot;">​</a></h3><p>先试用 **img.get_statistics(roi=ROI)**和ROI获得statistics对象，再点访问获取参数</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ROI</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">img </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sensor.snapshot()         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Take a picture and return the image.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">statistics</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">img.get_statistics(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">roi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ROI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">color_l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">statistics.l_mode()</span></span></code></pre></div><p>灰度</p><ul><li>statistics.mean() 返回灰度的<strong>平均数</strong>(0-255) (int)。你也可以通过statistics[0]获得。</li><li>statistics.median() 返回灰度的<strong>中位数</strong>(0-255) (int)。你也可以通过statistics[1]获得。</li><li>statistics.mode() 返回灰度的<strong>众数</strong>(0-255) (int)。你也可以通过statistics[2]获得。</li><li>statistics.stdev() 返回灰度的<strong>标准差</strong>(0-255) (int)。你也可以通过statistics[3]获得。</li><li>statistics.min() 返回灰度的<strong>最小值</strong>(0-255) (int)。你也可以通过statistics[4]获得。</li><li>statistics.max() 返回灰度的<strong>最大值</strong>(0-255) (int)。你也可以通过statistics[5]获得。</li><li>statistics.lq() 返回灰度的<strong>第一四分数</strong>(0-255) (int)。你也可以通过statistics[6]获得。</li><li>statistics.uq() 返回灰度的<strong>第三四分数</strong>(0-255) (int)。你也可以通过statistics[7]获得。</li></ul><p>LAB通道</p><ul><li>l_mean，l_median，l_mode，l_stdev，l_min，l_max，l_lq，l_uq，</li><li>a_mean，a_median，a_mode，a_stdev，a_min，a_max，a_lq，a_uq，</li><li>b_mean，b_median，b_mode，b_stdev，b_min，b_max，b_lq，b_uq，</li></ul><p>是LAB三个通道的平均数，中位数，众数，标准差，最小值，最大值，第一四分数，第三四分数。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sensor, image, time</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sensor.reset() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 初始化摄像头</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sensor.set_pixformat(sensor.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RGB565</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 格式为 RGB565.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sensor.set_framesize(sensor.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">QVGA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sensor.skip_frames(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 跳过10帧，使新设置生效</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sensor.set_auto_whitebal(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Create a clock object to track the FPS.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ROI</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    img </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sensor.snapshot()         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Take a picture and return the image.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    statistics</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">img.get_statistics(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">roi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ROI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    color_l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">statistics.l_mode()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    color_a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">statistics.a_mode()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    color_b</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">statistics.b_mode()</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(color_l,color_a,color_b)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    img.draw_rectangle(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ROI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="滤波器与图像变换" tabindex="-1">滤波器与图像变换 <a class="header-anchor" href="#滤波器与图像变换" aria-label="Permalink to &quot;滤波器与图像变换&quot;">​</a></h3><h4 id="镜头校正" tabindex="-1">镜头校正 <a class="header-anchor" href="#镜头校正" aria-label="Permalink to &quot;镜头校正&quot;">​</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 本示例展示了如何运用镜头校正方法来修正图像中的镜头</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 畸变。进行二维码/条形码/数据矩阵识别时需此操作。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 逐步增强下方参数直至画面中的线条呈现笔直状态。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 放大（数值调高）或缩小（数值调低）直至获得合适视野。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sensor</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> time</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sensor.reset()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sensor.set_pixformat(sensor.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RGB565</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sensor.set_framesize(sensor.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">QVGA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sensor.skip_frames(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">time</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">clock </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> time.clock()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">while</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    clock.tick()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    img </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sensor.snapshot().lens_corr(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">strength</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">zoom</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(clock.fps())</span></span></code></pre></div><h4 id="自适应直方图均衡化" tabindex="-1">自适应直方图均衡化 <a class="header-anchor" href="#自适应直方图均衡化" aria-label="Permalink to &quot;自适应直方图均衡化&quot;">​</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">img </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sensor.snapshot().histeq(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">adaptive</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">clip_limit</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h4 id="核滤波器" tabindex="-1">核滤波器 <a class="header-anchor" href="#核滤波器" aria-label="Permalink to &quot;核滤波器&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># 在图像的每个像素上运行内核。</span></span>
<span class="line"><span>img.morph(kernel_size, kernel)</span></span></code></pre></div><h4 id="高斯滤波器对图像进行模糊处理" tabindex="-1">高斯滤波器对图像进行模糊处理 <a class="header-anchor" href="#高斯滤波器对图像进行模糊处理" aria-label="Permalink to &quot;高斯滤波器对图像进行模糊处理&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># 在图像的每个像素上运行内核。</span></span>
<span class="line"><span>img.gaussian(1)</span></span></code></pre></div><h4 id="在彩色图像上使用双边滤波器" tabindex="-1">在彩色图像上使用双边滤波器 <a class="header-anchor" href="#在彩色图像上使用双边滤波器" aria-label="Permalink to &quot;在彩色图像上使用双边滤波器&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># color_sigma 控制像素在颜色上必须有多接近才能</span></span>
<span class="line"><span># 一起模糊。较小的值意味着它们必须更接近。</span></span>
<span class="line"><span># 较大的值则不那么严格。</span></span>
<span class="line"><span></span></span>
<span class="line"><span># space_sigma 控制像素在空间上必须有多接近才能</span></span>
<span class="line"><span># 一起模糊。较小的值意味着它们必须更接近。</span></span>
<span class="line"><span># 较大的值则不那么严格。</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 在图像的每个像素上运行内核。</span></span>
<span class="line"><span>img.bilateral(3, color_sigma=0.1, space_sigma=1)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 请注意，如果您将 color_sigma/space_sigma 设置得过于激进，</span></span>
<span class="line"><span># 双边滤波器可能会引入图像缺陷。增加 sigma 值直到</span></span>
<span class="line"><span># 如果你看到了缺陷，它们就会消失。</span></span></code></pre></div><h4 id="灰度图像上应用双边滤波" tabindex="-1">灰度图像上应用双边滤波 <a class="header-anchor" href="#灰度图像上应用双边滤波" aria-label="Permalink to &quot;灰度图像上应用双边滤波&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>img.bilateral(3, color_sigma=0.1, space_sigma=1)</span></span></code></pre></div><h4 id="强光抑制" tabindex="-1">强光抑制 <a class="header-anchor" href="#强光抑制" aria-label="Permalink to &quot;强光抑制&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>img = sensor.snapshot().binary([thresholds], invert=False, zero=True)</span></span></code></pre></div><h4 id="拉普拉斯滤波器检测边缘" tabindex="-1">拉普拉斯滤波器检测边缘 <a class="header-anchor" href="#拉普拉斯滤波器检测边缘" aria-label="Permalink to &quot;拉普拉斯滤波器检测边缘&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span> img.laplacian(1)</span></span></code></pre></div><h4 id="canny边缘检测" tabindex="-1">Canny边缘检测 <a class="header-anchor" href="#canny边缘检测" aria-label="Permalink to &quot;Canny边缘检测&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Use Canny edge detector</span></span>
<span class="line"><span>img.find_edges(image.EDGE_CANNY, threshold=(50, 80))</span></span></code></pre></div><h4 id="腐蚀和膨胀" tabindex="-1">腐蚀和膨胀 <a class="header-anchor" href="#腐蚀和膨胀" aria-label="Permalink to &quot;腐蚀和膨胀&quot;">​</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 腐蚀和膨胀示例</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 此示例展示了腐蚀和膨胀功能的应用，您可以在</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 二值图像上运行这些功能以去除噪声。此示例最初是一个测试，但它</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 对于展示这些功能的工作原理非常有用。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sensor</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sensor.reset()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sensor.set_framesize(sensor.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">QVGA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">grayscale_thres </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">170</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">255</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rgb565_thres </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">70</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">127</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">127</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">while</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    sensor.set_pixformat(sensor.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">GRAYSCALE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        img </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sensor.snapshot()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        img.binary([grayscale_thres])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        img.erode(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        img </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sensor.snapshot()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        img.binary([grayscale_thres])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        img.dilate(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    sensor.set_pixformat(sensor.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RGB565</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        img </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sensor.snapshot()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        img.binary([rgb565_thres])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        img.erode(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        img </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sensor.snapshot()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        img.binary([rgb565_thres])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        img.dilate(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h4 id="伽马校正以使图像更亮" tabindex="-1">伽马校正以使图像更亮 <a class="header-anchor" href="#伽马校正以使图像更亮" aria-label="Permalink to &quot;伽马校正以使图像更亮&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span> img = sensor.snapshot().gamma_corr(gamma=0.5, contrast=1.0, brightness=0.0)</span></span></code></pre></div><h4 id="灰度二值化" tabindex="-1">灰度二值化 <a class="header-anchor" href="#灰度二值化" aria-label="Permalink to &quot;灰度二值化&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>while True:</span></span>
<span class="line"><span>    # 测试低阈值</span></span>
<span class="line"><span>    for i in range(100):</span></span>
<span class="line"><span>        clock.tick()</span></span>
<span class="line"><span>        img = sensor.snapshot()</span></span>
<span class="line"><span>        img.binary([low_threshold])</span></span>
<span class="line"><span>        print(clock.fps())</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # 测试高阈值</span></span>
<span class="line"><span>    for i in range(100):</span></span>
<span class="line"><span>        clock.tick()</span></span>
<span class="line"><span>        img = sensor.snapshot()</span></span>
<span class="line"><span>        img.binary([high_threshold])</span></span>
<span class="line"><span>        print(clock.fps())</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # 测试非低阈值</span></span>
<span class="line"><span>    for i in range(100):</span></span>
<span class="line"><span>        clock.tick()</span></span>
<span class="line"><span>        img = sensor.snapshot()</span></span>
<span class="line"><span>        img.binary([low_threshold], invert=1)</span></span>
<span class="line"><span>        print(clock.fps())</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # 测试非高阈值</span></span>
<span class="line"><span>    for i in range(100):</span></span>
<span class="line"><span>        clock.tick()</span></span>
<span class="line"><span>        img = sensor.snapshot()</span></span>
<span class="line"><span>        img.binary([high_threshold], invert=1)</span></span>
<span class="line"><span>        print(clock.fps())</span></span></code></pre></div><h4 id="极坐标变换" tabindex="-1">极坐标变换 <a class="header-anchor" href="#极坐标变换" aria-label="Permalink to &quot;极坐标变换&quot;">​</a></h4><ul><li>线性极坐标变换</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>img = sensor.snapshot().linpolar(reverse=False)</span></span></code></pre></div><ul><li>对数极坐标变换</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>img = sensor.snapshot().logpolar(reverse=False)</span></span></code></pre></div><h3 id="形状匹配" tabindex="-1">形状匹配 <a class="header-anchor" href="#形状匹配" aria-label="Permalink to &quot;形状匹配&quot;">​</a></h3><h4 id="找圆" tabindex="-1">找圆 <a class="header-anchor" href="#找圆" aria-label="Permalink to &quot;找圆&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span></span></span></code></pre></div><h2 id="画图" tabindex="-1">画图 <a class="header-anchor" href="#画图" aria-label="Permalink to &quot;画图&quot;">​</a></h2><h3 id="画线" tabindex="-1">画线 <a class="header-anchor" href="#画线" aria-label="Permalink to &quot;画线&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>image.draw_line((10,10,20,30), color=(255,0,0))</span></span></code></pre></div><ul><li>image.draw_line(line_tuple, color=White) 在图像中画一条直线。 <ul><li>line_tuple的格式是(x0, y0, x1, y1)，意思是(x0, y0)到(x1, y1)的直线。</li><li>颜色可以是灰度值(0-255)，或者是彩色值(r, g, b)的tupple。默认是白色</li></ul></li></ul><h3 id="画框" tabindex="-1">画框 <a class="header-anchor" href="#画框" aria-label="Permalink to &quot;画框&quot;">​</a></h3><ul><li>image.draw_rectangle(rect_tuple, color=White) 在图像中画一个矩形框。 <ul><li>rect_tuple 的格式是 (x, y, w, h)。</li></ul></li></ul><h3 id="画圆" tabindex="-1">画圆 <a class="header-anchor" href="#画圆" aria-label="Permalink to &quot;画圆&quot;">​</a></h3><ul><li>image.draw_circle(x, y, radius, color=White) 在图像中画一个圆。 <ul><li>x,y是圆心坐标</li><li>radius是圆的半径</li></ul></li></ul><h3 id="画十字" tabindex="-1">画十字 <a class="header-anchor" href="#画十字" aria-label="Permalink to &quot;画十字&quot;">​</a></h3><ul><li>image.draw_cross(x, y, size=5, color=White) 在图像中画一个十字 <ul><li>x,y是坐标</li><li>size是两侧的尺寸</li></ul></li></ul><h3 id="写字" tabindex="-1">写字 <a class="header-anchor" href="#写字" aria-label="Permalink to &quot;写字&quot;">​</a></h3><ul><li>image.draw_string(x, y, text, color=White) 在图像中写字 8x10的像素 <ul><li>x,y是坐标。使用\\n, \\r, and \\r\\n会使光标移动到下一行。</li><li>text是要写的字符串。</li></ul></li></ul><p>例子</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Hello World Example</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Welcome to the OpenMV IDE! Click on the green run arrow button below to run the script!</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sensor, image, time</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sensor.reset() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 初始化摄像头</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sensor.set_pixformat(sensor.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RGB565</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 格式为 RGB565.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sensor.set_framesize(sensor.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">QQVGA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sensor.skip_frames(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 跳过10帧，使新设置生效</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    img </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sensor.snapshot()         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Take a picture and return the image.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    img.draw_line((</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    img.draw_line((</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">color</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">255</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    img.draw_rectangle((</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">41</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">51</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">color</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">255</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    img.draw_circle(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    img.draw_cross(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">90</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">60</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    img.draw_string(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hello world!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="绘制箭头" tabindex="-1">绘制箭头 <a class="header-anchor" href="#绘制箭头" aria-label="Permalink to &quot;绘制箭头&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>r = randint(0, 127) + 128</span></span>
<span class="line"><span>g = randint(0, 127) + 128</span></span>
<span class="line"><span>b = randint(0, 127) + 128</span></span>
<span class="line"><span></span></span>
<span class="line"><span># If the first argument is a scaler then this method expects</span></span>
<span class="line"><span># to see x0, y0, x1, and y1. Otherwise, it expects a (x0,y0,x1,y1) tuple.</span></span>
<span class="line"><span>img.draw_arrow(x0, y0, x1, y1, color=(r, g, b), size=30, thickness=2)</span></span></code></pre></div><h3 id="画圆-1" tabindex="-1">画圆 <a class="header-anchor" href="#画圆-1" aria-label="Permalink to &quot;画圆&quot;">​</a></h3><ul><li>查看x、y和半径。否则，它需要一个(x,y,半径)元组。</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>img.draw_circle(x, y, radius, color=(r, g, b), thickness=2, fill=False)</span></span></code></pre></div><h3 id="画十字-1" tabindex="-1">画十字 <a class="header-anchor" href="#画十字-1" aria-label="Permalink to &quot;画十字&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># If the first argument is a scaler then this method expects</span></span>
<span class="line"><span># to see x and y. Otherwise, it expects a (x,y) tuple.</span></span>
<span class="line"><span>img.draw_cross(x, y, color=(r, g, b), size=10, thickness=2)</span></span></code></pre></div><h3 id="绘制椭圆" tabindex="-1">绘制椭圆 <a class="header-anchor" href="#绘制椭圆" aria-label="Permalink to &quot;绘制椭圆&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># If the first argument is a scaler then this method expects</span></span>
<span class="line"><span># to see x, y, radius x, and radius y.</span></span>
<span class="line"><span># Otherwise, it expects a (x,y,rx,ry) tuple.</span></span>
<span class="line"><span>img.draw_ellipse(</span></span>
<span class="line"><span>    x, y, rx, ry, rot, color=(r, g, b), thickness=2, fill=False</span></span>
<span class="line"><span>)</span></span></code></pre></div><h3 id="绘制正边矩形" tabindex="-1">绘制正边矩形 <a class="header-anchor" href="#绘制正边矩形" aria-label="Permalink to &quot;绘制正边矩形&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>img.draw_rectangle(x, y, w, h, color=(r, g, b), thickness=2, fill=False)</span></span></code></pre></div><h2 id="功能函数" tabindex="-1">功能函数 <a class="header-anchor" href="#功能函数" aria-label="Permalink to &quot;功能函数&quot;">​</a></h2><h3 id="寻找色块-find-blobs" tabindex="-1">寻找色块 find_blobs <a class="header-anchor" href="#寻找色块-find-blobs" aria-label="Permalink to &quot;寻找色块 find_blobs&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>image.find_blobs(thresholds, roi=Auto, x_stride=2, y_stride=1, invert=False, area_threshold=10, pixels_threshold=10, merge=False, margin=0, threshold_cb=None, merge_cb=None)</span></span></code></pre></div><p>色域为LAB</p><ul><li><p><code>minL</code> 和 <code>maxL</code>：分别定义了亮度（L）通道的最小值和最大值。用于限制颜色的亮度范围。</p></li><li><p><code>minA</code> 和 <code>maxA</code>：分别定义了 A 通道（绿色到红色的色差）的最小值和最大值。用于限制颜色在绿色和红色之间的范围。</p></li><li><p><code>minB</code> 和 <code>maxB</code>：分别定义了 B 通道（蓝色到黄色的色差）的最小值和最大值。用于限制颜色在蓝色和黄色之间的范围。</p></li><li><p>thresholds是颜色的阈值，注意：这个参数是一个列表，可以包含多个颜色。如果你只需要一个颜色，那么在这个列表中只需要有一个颜色值，如果你想要多个颜色阈值，那这个列表就需要多个颜色阈值。注意：在返回的色块对象blob可以调用code方法，来判断是什么颜色的色块。，如</p></li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>red = (xxx,xxx,xxx,xxx,xxx,xxx)</span></span>
<span class="line"><span>blue = (xxx,xxx,xxx,xxx,xxx,xxx)</span></span>
<span class="line"><span>yellow = (xxx,xxx,xxx,xxx,xxx,xxx)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>img=sensor.snapshot()</span></span>
<span class="line"><span>red_blobs = img.find_blobs([red])</span></span>
<span class="line"><span></span></span>
<span class="line"><span>color_blobs = img.find_blobs([red,blue, yellow])</span></span></code></pre></div><ul><li><p>roi是“感兴趣区”。在<a href="https://book.openmv.cc/image/statistics.html" target="_blank" rel="noreferrer">使用统计信息</a>中已经介绍过了。</p><p>left_roi = [0,0,160,240] blobs = img.find_blobs([red],roi=left_roi)</p></li><li><p>x_stride 就是查找的色块的x方向上最小宽度的像素，默认为2，如果你只想查找宽度10个像素以上的色块，那么就设置这个参数为10：</p><p>blobs = img.find_blobs([red],x_stride=10)</p></li><li><p>y_stride 就是查找的色块的y方向上最小宽度的像素，默认为1，如果你只想查找宽度5个像素以上的色块，那么就设置这个参数为5：</p><p>blobs = img.find_blobs([red],y_stride=5)</p></li><li><p>invert 反转阈值，把阈值以外的颜色作为阈值进行查找</p></li><li><p>area_threshold 面积阈值，如果色块被框起来的面积小于这个值，会被过滤掉</p></li><li><p>pixels_threshold 像素个数阈值，如果色块像素数量小于这个值，会被过滤掉</p></li><li><p>merge 合并，如果设置为True，那么合并所有重叠的blob为一个。 注意：这会合并所有的blob，无论是什么颜色的。如果你想混淆多种颜色的blob，只需要分别调用不同颜色阈值的find_blobs。</p></li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>all_blobs = img.find_blobs([red,blue,yellow],merge=True)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>red_blobs = img.find_blobs([red],merge=True)</span></span>
<span class="line"><span>blue_blobs = img.find_blobs([blue],merge=True)</span></span>
<span class="line"><span>yellow_blobs = img.find_blobs([yellow],merge=True)</span></span>
<span class="line"><span>Copy</span></span></code></pre></div><ul><li>margin 边界，如果设置为1，那么两个blobs如果间距1一个像素点，也会被合并。</li></ul><h4 id="blob返回对象" tabindex="-1">blob返回对象 <a class="header-anchor" href="#blob返回对象" aria-label="Permalink to &quot;blob返回对象&quot;">​</a></h4><p>find_blobs对象返回的是多个blob的列表</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>blobs = img.find_blobs([red])</span></span></code></pre></div><p>blobs参数</p><ul><li><p>blob.rect() 返回这个色块的外框——矩形元组(x, y, w, h)，可以直接在image.draw_rectangle中使用。</p></li><li><p>blob.x() 返回色块的外框的x坐标（int），也可以通过blob[0]来获取。</p></li><li><p>blob.y() 返回色块的外框的y坐标（int），也可以通过blob[1]来获取。</p></li><li><p>blob.w() 返回色块的外框的宽度w（int），也可以通过blob[2]来获取。</p></li><li><p>blob.h() 返回色块的外框的高度h（int），也可以通过blob[3]来获取。</p></li><li><p>blob.pixels() 返回色块的像素数量（int），也可以通过blob[4]来获取。</p></li><li><p>blob.cx() 返回色块的外框的中心x坐标（int），也可以通过blob[5]来获取。</p></li><li><p>blob.cy() 返回色块的外框的中心y坐标（int），也可以通过blob[6]来获取。</p></li><li><p>blob.rotation() 返回色块的旋转角度（单位为弧度）（float）。如果色块类似一个铅笔，那么这个值为0~180°。如果色块是一个圆，那么这个值是无用的。如果色块完全没有对称性，那么你会得到0~360°，也可以通过blob[7]来获取。</p></li><li><p>blob.code() 返回一个16bit数字，每一个bit会对应每一个阈值。举个例子：</p><p>blobs = img.find_blobs([red, blue, yellow], merge=True)</p></li></ul><p>如果这个色块是红色，那么它的code就是0001，如果是蓝色，那么它的code就是0010。注意：一个blob可能是合并的，如果是红色和蓝色的blob，那么这个blob就是0011。这个功能可以用于查找颜色代码。也可以通过blob[8]来获取。</p><ul><li>blob.count() 如果merge=True，那么就会有多个blob被合并到一个blob，这个函数返回的就是这个的数量。如果merge=False，那么返回值总是1。也可以通过blob[9]来获取。</li><li>blob.area() 返回色块的外框的面积。应该等于(w * h)</li><li>blob.density() 返回色块的密度。这等于色块的像素数除以外框的区域。如果密度较低，那么说明目标锁定的不是很好。 比如，识别一个红色的圆，返回的blob.pixels()是目标圆的像素点数，blob.area()是圆的外接正方形的面积。</li></ul><h4 id="阈值选择工具" tabindex="-1">阈值选择工具 <a class="header-anchor" href="#阈值选择工具" aria-label="Permalink to &quot;阈值选择工具&quot;">​</a></h4><p>工具 → Mechine Vision → Threshold Editor</p><h2 id="多功能图像处理" tabindex="-1">多功能图像处理 <a class="header-anchor" href="#多功能图像处理" aria-label="Permalink to &quot;多功能图像处理&quot;">​</a></h2><h3 id="apriltag标记追踪" tabindex="-1">AprilTag标记追踪 <a class="header-anchor" href="#apriltag标记追踪" aria-label="Permalink to &quot;AprilTag标记追踪&quot;">​</a></h3><h3 id="模板匹配ncc" tabindex="-1">模板匹配NCC <a class="header-anchor" href="#模板匹配ncc" aria-label="Permalink to &quot;模板匹配NCC&quot;">​</a></h3><h3 id="摄像头测距" tabindex="-1">摄像头测距 <a class="header-anchor" href="#摄像头测距" aria-label="Permalink to &quot;摄像头测距&quot;">​</a></h3><h2 id="外设与文件操作" tabindex="-1">外设与文件操作 <a class="header-anchor" href="#外设与文件操作" aria-label="Permalink to &quot;外设与文件操作&quot;">​</a></h2><h3 id="文件操作" tabindex="-1">文件操作 <a class="header-anchor" href="#文件操作" aria-label="Permalink to &quot;文件操作&quot;">​</a></h3><ul><li>显示与加载图像</li></ul><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 将图像复制到帧缓冲区。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 此示例展示了如何加载和显示图像。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> image</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> time</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Load image</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">img </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> image.Image(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/example.bmp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">copy_to_fb</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Add a small delay to allow the IDE to read the loaded image.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">time.sleep_ms(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="闪灯" tabindex="-1">闪灯 <a class="header-anchor" href="#闪灯" aria-label="Permalink to &quot;闪灯&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> time</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> machine </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LED</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">led </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> LED(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;LED_BLUE&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">while</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    led.on()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    time.sleep_ms(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    led.off()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    time.sleep_ms(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div>`,121)])])}const g=i(p,[["render",e]]);export{E as __pageData,g as default};
